import React, { useState } from "react";
import LearnPageLayout from "../components/LearnPageLayout";
import QuizSection, { QuizQuestion } from "../components/QuizSection";
import {
  Box,
  Typography,
  Container,
  Paper,
  alpha,
  useTheme,
  Tabs,
  Tab,
  Accordion,
  AccordionSummary,
  AccordionDetails,
  Chip,
  Grid,
  List,
  ListItem,
  ListItemIcon,
  ListItemText,
  IconButton,
  Divider,
  Alert,
  Card,
  CardContent,
  Tooltip,
  Button,
} from "@mui/material";
import { Link, useNavigate } from "react-router-dom";
import ArrowBackIcon from "@mui/icons-material/ArrowBack";
import ExpandMoreIcon from "@mui/icons-material/ExpandMore";
import SecurityIcon from "@mui/icons-material/Security";
import SearchIcon from "@mui/icons-material/Search";
import LockIcon from "@mui/icons-material/Lock";
import BugReportIcon from "@mui/icons-material/BugReport";
import StorageIcon from "@mui/icons-material/Storage";
import WebIcon from "@mui/icons-material/Web";
import SyncAltIcon from "@mui/icons-material/SyncAlt";
import AssignmentIcon from "@mui/icons-material/Assignment";
import CheckCircleIcon from "@mui/icons-material/CheckCircle";
import WarningIcon from "@mui/icons-material/Warning";
import InfoIcon from "@mui/icons-material/Info";
import GavelIcon from "@mui/icons-material/Gavel";
import MapIcon from "@mui/icons-material/Map";
import AccountTreeIcon from "@mui/icons-material/AccountTree";
import VpnKeyIcon from "@mui/icons-material/VpnKey";
import PersonSearchIcon from "@mui/icons-material/PersonSearch";
import TimerIcon from "@mui/icons-material/Timer";
import TokenIcon from "@mui/icons-material/Token";
import LinkIcon from "@mui/icons-material/Link";
import PhonelinkLockIcon from "@mui/icons-material/PhonelinkLock";
import AdminPanelSettingsIcon from "@mui/icons-material/AdminPanelSettings";
import DataObjectIcon from "@mui/icons-material/DataObject";
import CodeIcon from "@mui/icons-material/Code";
import TerminalIcon from "@mui/icons-material/Terminal";
import CloudIcon from "@mui/icons-material/Cloud";
import FolderIcon from "@mui/icons-material/Folder";
import UploadFileIcon from "@mui/icons-material/UploadFile";
import SpeedIcon from "@mui/icons-material/Speed";
import SettingsIcon from "@mui/icons-material/Settings";
import JavascriptIcon from "@mui/icons-material/Javascript";
import HttpIcon from "@mui/icons-material/Http";
import MouseIcon from "@mui/icons-material/Mouse";
import PolicyIcon from "@mui/icons-material/Policy";
import FactCheckIcon from "@mui/icons-material/FactCheck";
import LinkOffIcon from "@mui/icons-material/LinkOff";
import WifiIcon from "@mui/icons-material/Wifi";
import DescriptionIcon from "@mui/icons-material/Description";
import PriorityHighIcon from "@mui/icons-material/PriorityHigh";
import SchoolIcon from "@mui/icons-material/School";
import BuildIcon from "@mui/icons-material/Build";

interface TabPanelProps {
  children?: React.ReactNode;
  index: number;
  value: number;
}

function TabPanel(props: TabPanelProps) {
  const { children, value, index, ...other } = props;
  return (
    <div role="tabpanel" hidden={value !== index} {...other}>
      {value === index && <Box sx={{ pt: 3 }}>{children}</Box>}
    </div>
  );
}

interface TopicSection {
  title: string;
  icon: React.ReactNode;
  color: string;
  description: string;
  keyPoints: string[];
  techniques?: string[];
  tools?: string[];
  tips?: string[];
  cwe?: string[];
}

// Section 1: Overview and Methodology
const overviewTopics: TopicSection[] = [
  {
    title: "Scope and Rules of Engagement",
    icon: <GavelIcon />,
    color: "#6366f1",
    description: "Before any testing begins, establish clear boundaries and legal authorization to protect both tester and client.",
    keyPoints: [
      "Obtain written authorization (Get Out of Jail Free letter)",
      "Define in-scope and out-of-scope systems, IPs, and domains",
      "Clarify testing windows and blackout periods",
      "Establish emergency contact procedures",
      "Agree on acceptable testing techniques (DoS, social engineering, etc.)",
      "Define data handling and confidentiality requirements",
      "Set up secure communication channels for findings",
    ],
    tips: [
      "Always keep authorization documents accessible during testing",
      "Document everything with timestamps for legal protection",
      "Clarify third-party hosted services (AWS, Cloudflare) - they may need separate authorization",
      "Understand local laws regarding penetration testing",
    ],
  },
  {
    title: "Reconnaissance and Application Mapping",
    icon: <MapIcon />,
    color: "#8b5cf6",
    description: "Systematically discover and document all application components, endpoints, and technologies.",
    keyPoints: [
      "Passive recon: OSINT, DNS records, certificate transparency logs",
      "Active scanning: port scanning, service enumeration",
      "Technology fingerprinting: server, frameworks, libraries",
      "Endpoint discovery: spidering, directory brute-forcing",
      "API documentation discovery (Swagger, GraphQL introspection)",
      "JavaScript analysis for hidden endpoints and secrets",
      "Subdomain enumeration and virtual host discovery",
    ],
    tools: ["Burp Suite", "OWASP ZAP", "Nmap", "Gobuster", "ffuf", "Amass", "Subfinder", "Nuclei", "httpx", "waybackurls"],
    techniques: [
      "robots.txt and sitemap.xml analysis",
      "Google dorking for sensitive files",
      "GitHub/GitLab secret scanning",
      "Shodan/Censys for exposed services",
      "WHOIS and reverse IP lookups",
    ],
  },
  {
    title: "Threat Modelling and Attack Surface",
    icon: <AccountTreeIcon />,
    color: "#ec4899",
    description: "Identify and prioritize potential attack vectors based on application architecture and business logic.",
    keyPoints: [
      "Map data flows between components",
      "Identify trust boundaries and authentication points",
      "Document entry points (forms, APIs, file uploads)",
      "Assess business-critical functionality",
      "Consider insider threat scenarios",
      "Map third-party integrations and dependencies",
      "Prioritize testing based on risk and impact",
    ],
    techniques: [
      "STRIDE threat modelling (Spoofing, Tampering, Repudiation, Information Disclosure, DoS, Elevation)",
      "Attack trees for complex scenarios",
      "Data flow diagrams (DFDs)",
      "PASTA (Process for Attack Simulation and Threat Analysis)",
    ],
  },
];

// Section 2: Authentication and Authorization
const authTopics: TopicSection[] = [
  {
    title: "Authentication Models",
    icon: <VpnKeyIcon />,
    color: "#3b82f6",
    description: "Understanding different authentication mechanisms and their common weaknesses.",
    keyPoints: [
      "Form-based authentication: username/password flows",
      "HTTP Basic and Digest authentication",
      "Certificate-based (mutual TLS) authentication",
      "API key authentication patterns",
      "Token-based authentication (Bearer tokens)",
      "Passwordless authentication (magic links, WebAuthn)",
      "Risk-based and adaptive authentication",
    ],
    techniques: [
      "Test for default credentials",
      "Check password policy enforcement",
      "Verify account lockout mechanisms",
      "Test remember-me functionality security",
      "Assess password reset flows",
    ],
  },
  {
    title: "Enumeration and Brute Force",
    icon: <PersonSearchIcon />,
    color: "#ef4444",
    description: "Techniques to discover valid accounts and bypass authentication through credential attacks.",
    keyPoints: [
      "Username enumeration via error messages",
      "Timing-based user enumeration",
      "Password spraying vs credential stuffing",
      "Rate limiting bypass techniques",
      "CAPTCHA bypass methods",
      "Account lockout policy testing",
      "Response analysis for enumeration",
    ],
    tools: ["Hydra", "Burp Intruder", "ffuf", "Patator", "CeWL", "Turbo Intruder"],
    tips: [
      "Check registration, login, and password reset for enumeration",
      "Compare response times, sizes, and content",
      "Try IP rotation and header manipulation for rate limit bypass",
      "Test with common password lists (rockyou, SecLists)",
    ],
    cwe: ["CWE-307: Improper Restriction of Excessive Authentication Attempts"],
  },
  {
    title: "Session Management",
    icon: <TimerIcon />,
    color: "#f59e0b",
    description: "Testing session token generation, handling, and termination for security flaws.",
    keyPoints: [
      "Session token entropy and predictability",
      "Secure cookie attributes (HttpOnly, Secure, SameSite)",
      "Session fixation vulnerabilities",
      "Session timeout and idle timeout",
      "Concurrent session handling",
      "Session termination on logout",
      "Session regeneration after privilege changes",
    ],
    techniques: [
      "Analyze token randomness with Burp Sequencer",
      "Test session persistence across authentication events",
      "Check for session tokens in URLs (session ID exposure)",
      "Verify logout actually invalidates server-side session",
      "Test cross-device/cross-browser session handling",
    ],
    cwe: ["CWE-384: Session Fixation", "CWE-613: Insufficient Session Expiration"],
  },
  {
    title: "JWT Security",
    icon: <TokenIcon />,
    color: "#10b981",
    description: "Common vulnerabilities in JSON Web Token implementations and how to exploit them.",
    keyPoints: [
      "Algorithm confusion attacks (none, HS256 vs RS256)",
      "Weak secret keys vulnerable to brute force",
      "Missing signature verification",
      "JWT header injection (jku, jwk, kid)",
      "Expired token acceptance",
      "Sensitive data in JWT payload",
      "Token replay and revocation issues",
    ],
    tools: ["jwt.io", "jwt_tool", "Burp JWT extensions", "hashcat (for cracking)"],
    techniques: [
      "Change alg to 'none' and remove signature",
      "Switch RS256 to HS256 and sign with public key",
      "Brute force weak HMAC secrets",
      "Inject malicious JWKS URL via jku header",
      "SQL injection via kid parameter",
    ],
    cwe: ["CWE-347: Improper Verification of Cryptographic Signature"],
  },
  {
    title: "OAuth and SSO Vulnerabilities",
    icon: <LinkIcon />,
    color: "#8b5cf6",
    description: "Security testing for OAuth 2.0, OpenID Connect, and Single Sign-On implementations.",
    keyPoints: [
      "Open redirect in redirect_uri parameter",
      "Authorization code interception",
      "CSRF in OAuth flows (missing state parameter)",
      "Token leakage via Referer header",
      "Scope escalation and privilege manipulation",
      "Client secret exposure",
      "PKCE bypass attempts",
      "IdP confusion and account linking issues",
    ],
    techniques: [
      "Test redirect_uri validation (subdomain, path traversal, parameter pollution)",
      "Attempt to reuse authorization codes",
      "Check for token in URL fragments vs query params",
      "Test implicit flow token exposure",
      "Verify state parameter uniqueness and binding",
    ],
    cwe: ["CWE-601: URL Redirection to Untrusted Site"],
  },
  {
    title: "Multi-Factor Authentication",
    icon: <PhonelinkLockIcon />,
    color: "#06b6d4",
    description: "Bypass techniques and weaknesses in MFA implementations.",
    keyPoints: [
      "MFA bypass via direct endpoint access",
      "Brute forcing OTP codes",
      "Response manipulation to skip MFA",
      "Backup code weaknesses",
      "MFA fatigue attacks (push notification spam)",
      "SIM swapping and SS7 attacks on SMS MFA",
      "Recovery flow bypasses",
    ],
    techniques: [
      "Check if MFA can be disabled without re-authentication",
      "Test rate limiting on OTP submission",
      "Attempt to access authenticated endpoints without completing MFA",
      "Manipulate response to indicate MFA success",
      "Test backup codes for reuse and entropy",
    ],
  },
  {
    title: "Access Control, IDOR, and BOLA",
    icon: <AdminPanelSettingsIcon />,
    color: "#dc2626",
    description: "Broken Object Level Authorization and Insecure Direct Object References testing.",
    keyPoints: [
      "Horizontal privilege escalation (accessing other users' data)",
      "Vertical privilege escalation (accessing admin functions)",
      "IDOR in API endpoints with numeric/UUID identifiers",
      "Mass assignment vulnerabilities",
      "Function-level access control bypass",
      "Path-based access control issues",
      "GraphQL authorization flaws",
    ],
    techniques: [
      "Swap user IDs, GUIDs, or other identifiers in requests",
      "Test with low-privilege and high-privilege accounts",
      "Check API endpoints for missing authorization checks",
      "Test batch operations and bulk endpoints",
      "Enumerate object IDs (sequential, predictable patterns)",
    ],
    cwe: ["CWE-639: Authorization Bypass Through User-Controlled Key", "CWE-284: Improper Access Control"],
  },
];

// Section 3: Injection Attacks
const injectionTopics: TopicSection[] = [
  {
    title: "Advanced SQL Injection",
    icon: <StorageIcon />,
    color: "#ef4444",
    description: "Beyond basic SQLi: blind techniques, filter bypass, and database-specific exploitation.",
    keyPoints: [
      "Union-based extraction techniques",
      "Boolean-based blind SQLi",
      "Time-based blind SQLi",
      "Error-based extraction",
      "Out-of-band (OOB) data exfiltration",
      "Second-order SQL injection",
      "WAF bypass techniques",
    ],
    tools: ["SQLMap", "Burp Suite", "Havij", "jSQL Injection"],
    techniques: [
      "Filter bypass: case variation, comments, encoding",
      "Stacked queries for command execution",
      "Database fingerprinting via errors",
      "Reading/writing files via SQL (LOAD_FILE, INTO OUTFILE)",
      "Privilege escalation via database features",
    ],
    cwe: ["CWE-89: SQL Injection"],
  },
  {
    title: "NoSQL Injection",
    icon: <DataObjectIcon />,
    color: "#f59e0b",
    description: "Injection attacks against MongoDB, CouchDB, and other NoSQL databases.",
    keyPoints: [
      "MongoDB operator injection ($gt, $ne, $regex)",
      "JSON/BSON injection in queries",
      "JavaScript injection in MongoDB",
      "CouchDB view injection",
      "Redis command injection",
      "GraphQL query manipulation",
    ],
    techniques: [
      "Replace values with objects: {\"$gt\": \"\"}",
      "Array injection for operator bypass",
      "Regex-based data extraction",
      "Server-side JavaScript injection via $where",
      "Blind NoSQL injection via timing",
    ],
    cwe: ["CWE-943: Improper Neutralization of Special Elements in Data Query Logic"],
  },
  {
    title: "Server-Side Template Injection (SSTI)",
    icon: <CodeIcon />,
    color: "#8b5cf6",
    description: "Exploiting template engines to achieve remote code execution.",
    keyPoints: [
      "Template engine identification",
      "Jinja2/Twig/Freemarker exploitation",
      "Sandbox escape techniques",
      "Blind SSTI detection",
      "Polyglot payloads for detection",
    ],
    tools: ["Tplmap", "SSTImap", "Burp Suite"],
    techniques: [
      "Detection: {{7*7}}, ${7*7}, <%= 7*7 %>",
      "Jinja2 RCE: {{config.__class__.__init__.__globals__['os'].popen('id').read()}}",
      "Identify template engine via error messages",
      "Chain object traversal for RCE",
    ],
    cwe: ["CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine"],
  },
  {
    title: "XXE Injection",
    icon: <DescriptionIcon />,
    color: "#10b981",
    description: "XML External Entity attacks for file disclosure, SSRF, and denial of service.",
    keyPoints: [
      "Classic XXE for file reading",
      "Blind XXE with out-of-band exfiltration",
      "XXE via file upload (SVG, DOCX, XLSX)",
      "XXE in SOAP web services",
      "Parameter entity attacks",
      "XXE to SSRF escalation",
    ],
    techniques: [
      "Basic payload: <!ENTITY xxe SYSTEM \"file:///etc/passwd\">",
      "Blind exfil via external DTD",
      "Error-based XXE for data extraction",
      "XXE DoS via billion laughs attack",
      "Test in Content-Type: application/xml requests",
    ],
    cwe: ["CWE-611: Improper Restriction of XML External Entity Reference"],
  },
  {
    title: "LDAP Injection",
    icon: <AccountTreeIcon />,
    color: "#6366f1",
    description: "Manipulating LDAP queries to bypass authentication or extract directory data.",
    keyPoints: [
      "Authentication bypass via filter manipulation",
      "Data extraction from directory services",
      "Blind LDAP injection techniques",
      "AND/OR filter exploitation",
    ],
    techniques: [
      "Bypass: *)(&, *)(|, admin)(&)",
      "Wildcard extraction: a*, b*, c*...",
      "Boolean-based blind extraction",
      "Test in login forms using LDAP backends",
    ],
    cwe: ["CWE-90: LDAP Injection"],
  },
  {
    title: "ORM and Query Builder Issues",
    icon: <DataObjectIcon />,
    color: "#ec4899",
    description: "Vulnerabilities in Object-Relational Mappers and query construction libraries.",
    keyPoints: [
      "Raw query usage in ORMs",
      "Unsafe interpolation in query builders",
      "Mass assignment leading to injection",
      "Order by and column name injection",
      "JSON field query injection",
    ],
    techniques: [
      "Identify ORM (Sequelize, Prisma, SQLAlchemy, ActiveRecord)",
      "Test dynamic column/table names",
      "Check for raw() or literal() query methods",
      "Test JSON operators for injection",
    ],
  },
  {
    title: "Command and Header Injection",
    icon: <TerminalIcon />,
    color: "#dc2626",
    description: "OS command injection and HTTP header injection attacks.",
    keyPoints: [
      "Command chaining: ;, &&, ||, |, newlines",
      "Command substitution: $(cmd), `cmd`",
      "Argument injection: --flag injection",
      "HTTP header injection (CRLF)",
      "Host header attacks",
      "Email header injection",
    ],
    techniques: [
      "Test: ; whoami, | id, `sleep 5`",
      "CRLF: %0d%0a for header injection",
      "Host header: internal hostname access",
      "Email: recipient%0aBcc:attacker@evil.com",
    ],
    cwe: ["CWE-78: OS Command Injection", "CWE-113: HTTP Response Splitting"],
  },
];

// Section 4: Server-Side Attacks
const serverSideTopics: TopicSection[] = [
  {
    title: "Insecure Deserialization",
    icon: <DataObjectIcon />,
    color: "#ef4444",
    description: "Exploiting unsafe deserialization for RCE and other attacks.",
    keyPoints: [
      "Java serialization (ObjectInputStream)",
      "PHP unserialize() vulnerabilities",
      "Python pickle exploitation",
      ".NET BinaryFormatter/ViewState",
      "Ruby Marshal vulnerabilities",
      "JSON deserialization gadgets",
    ],
    tools: ["ysoserial", "PHPGGC", "marshalsec", "Burp Deserialization Scanner"],
    techniques: [
      "Identify serialized data (magic bytes, base64 patterns)",
      "Java: rO0AB, .NET: AAEAAAD, PHP: O:4:",
      "Test with gadget chains for target framework",
      "Check ViewState MAC validation",
    ],
    cwe: ["CWE-502: Deserialization of Untrusted Data"],
  },
  {
    title: "Server-Side Request Forgery (SSRF)",
    icon: <CloudIcon />,
    color: "#8b5cf6",
    description: "Forcing servers to make requests to unintended destinations.",
    keyPoints: [
      "Basic SSRF to internal services",
      "Cloud metadata endpoint access (169.254.169.254)",
      "Protocol smuggling (file://, gopher://, dict://)",
      "Blind SSRF detection",
      "SSRF filter bypass techniques",
      "SSRF to RCE escalation",
    ],
    techniques: [
      "Target: http://127.0.0.1, http://localhost, http://[::1]",
      "Cloud: http://169.254.169.254/latest/meta-data/",
      "Bypass: decimal IP, IPv6, DNS rebinding",
      "Redirect-based SSRF bypass",
    ],
    cwe: ["CWE-918: Server-Side Request Forgery"],
  },
  {
    title: "File Inclusion and Path Traversal",
    icon: <FolderIcon />,
    color: "#f59e0b",
    description: "Local and Remote File Inclusion, directory traversal attacks.",
    keyPoints: [
      "Local File Inclusion (LFI)",
      "Remote File Inclusion (RFI)",
      "Path traversal (../ sequences)",
      "Null byte injection (%00)",
      "Filter bypass techniques",
      "Log poisoning for LFI to RCE",
    ],
    techniques: [
      "Traversal: ../../../etc/passwd",
      "Encoding: ..%2f, ..%252f, ....//",
      "Wrappers: php://filter, php://input",
      "Windows: ..\\..\\..\\windows\\win.ini",
    ],
    cwe: ["CWE-22: Path Traversal", "CWE-98: Improper Control of Filename for Include"],
  },
  {
    title: "File Upload Vulnerabilities",
    icon: <UploadFileIcon />,
    color: "#10b981",
    description: "Bypassing upload restrictions to achieve code execution.",
    keyPoints: [
      "Extension bypass (.php5, .phtml, .phar)",
      "Content-Type manipulation",
      "Magic byte injection",
      "Double extension attacks",
      "Null byte in filename",
      "SVG/XML upload for XSS/XXE",
      "Polyglot files (valid image + code)",
    ],
    techniques: [
      "Test: shell.php.jpg, shell.php%00.jpg",
      "Bypass: change Content-Type to image/jpeg",
      "Add valid image header before PHP code",
      "Case variation: .PhP, .PHP5",
      "Check for path traversal in filename",
    ],
    cwe: ["CWE-434: Unrestricted Upload of File with Dangerous Type"],
  },
  {
    title: "Race Conditions",
    icon: <SpeedIcon />,
    color: "#06b6d4",
    description: "Time-of-check to time-of-use (TOCTOU) and other race condition attacks.",
    keyPoints: [
      "TOCTOU vulnerabilities",
      "Limit overrun (coupon reuse, balance manipulation)",
      "File operation races",
      "Session race conditions",
      "Database race conditions",
    ],
    tools: ["Turbo Intruder", "Race The Web", "Burp Repeater (parallel)"],
    techniques: [
      "Send many parallel requests simultaneously",
      "Target: coupon redemption, account balance, voting",
      "Use HTTP/2 single-packet attack",
      "Test file upload + access race",
    ],
    cwe: ["CWE-362: Race Condition"],
  },
  {
    title: "Server-Side Prototype Pollution",
    icon: <DataObjectIcon />,
    color: "#ec4899",
    description: "Polluting JavaScript object prototypes on the server for various attacks.",
    keyPoints: [
      "Polluting Object.prototype via __proto__",
      "Constructor prototype pollution",
      "Gadget chains for RCE",
      "DoS via prototype pollution",
      "Bypassing security checks",
    ],
    techniques: [
      "Payload: {\"__proto__\": {\"admin\": true}}",
      "Target: JSON merge operations, lodash.merge",
      "Look for RCE gadgets (child_process spawn options)",
      "Test: {\"constructor\": {\"prototype\": {\"polluted\": true}}}",
    ],
    cwe: ["CWE-1321: Improperly Controlled Modification of Object Prototype Attributes"],
  },
  {
    title: "Misconfiguration and Debug Endpoints",
    icon: <SettingsIcon />,
    color: "#6366f1",
    description: "Exploiting exposed debug features, default configs, and sensitive endpoints.",
    keyPoints: [
      "Debug mode enabled in production",
      "Stack traces and verbose errors",
      "Default credentials",
      "Exposed admin panels",
      "Actuator/health endpoints (Spring Boot)",
      "GraphQL introspection enabled",
      "Exposed .git, .env, backup files",
    ],
    techniques: [
      "Check: /debug, /console, /actuator, /graphql",
      "Test for Spring Boot Actuator endpoints",
      "Look for phpinfo(), Django debug mode",
      "Enumerate /.git/config, /.env, /backup.sql",
    ],
  },
];

// Section 5: Client-Side Attacks
const clientSideTopics: TopicSection[] = [
  {
    title: "Cross-Site Scripting (XSS)",
    icon: <JavascriptIcon />,
    color: "#ef4444",
    description: "Reflected, Stored, and DOM-based XSS attacks and filter bypasses.",
    keyPoints: [
      "Reflected XSS in URL parameters",
      "Stored XSS in user content",
      "DOM-based XSS via client-side code",
      "Mutation XSS (mXSS)",
      "Context-aware payload crafting",
      "CSP bypass techniques",
      "XSS filter evasion",
    ],
    tools: ["XSS Hunter", "Burp Suite", "DOMPurify (for testing)", "BeEF"],
    techniques: [
      "Basic: <script>alert(1)</script>",
      "Event handlers: <img onerror=alert(1) src=x>",
      "SVG: <svg onload=alert(1)>",
      "Template literals: ${alert(1)}",
      "Encoding bypass: &#x3c;script&#x3e;",
    ],
    cwe: ["CWE-79: Cross-site Scripting"],
  },
  {
    title: "Cross-Site Request Forgery (CSRF)",
    icon: <SyncAltIcon />,
    color: "#f59e0b",
    description: "Forcing authenticated users to perform unintended actions.",
    keyPoints: [
      "Classic CSRF with form submission",
      "CSRF token bypass techniques",
      "JSON-based CSRF attacks",
      "Login CSRF for session fixation",
      "Logout CSRF for denial of service",
      "SameSite cookie bypass",
    ],
    techniques: [
      "Check for missing CSRF tokens",
      "Test token validation (remove, reuse, predictable)",
      "Try changing Content-Type for JSON endpoints",
      "Test GET-based state-changing operations",
      "Check SameSite cookie attribute",
    ],
    cwe: ["CWE-352: Cross-Site Request Forgery"],
  },
  {
    title: "DOM-Based Attacks",
    icon: <WebIcon />,
    color: "#8b5cf6",
    description: "Client-side vulnerabilities exploiting DOM manipulation.",
    keyPoints: [
      "DOM XSS via innerHTML, document.write",
      "DOM-based open redirect",
      "DOM clobbering",
      "Client-side template injection",
      "Prototype pollution in browser",
      "PostMessage vulnerabilities",
    ],
    techniques: [
      "Trace data flow from sources to sinks",
      "Sources: location.hash, location.search, document.referrer",
      "Sinks: innerHTML, eval, setTimeout, location",
      "Test postMessage origin validation",
    ],
    cwe: ["CWE-79: Cross-site Scripting"],
  },
  {
    title: "CORS and Same-Origin Policy",
    icon: <PolicyIcon />,
    color: "#10b981",
    description: "Misconfigured Cross-Origin Resource Sharing and SOP bypass.",
    keyPoints: [
      "Overly permissive Access-Control-Allow-Origin",
      "Null origin exploitation",
      "Credential leakage via CORS",
      "Pre-flight request bypass",
      "CORS header injection",
    ],
    techniques: [
      "Test: Origin: https://evil.com",
      "Check for wildcard (*) with credentials",
      "Test null origin from sandboxed iframes",
      "Check for origin reflection without validation",
      "Verify Access-Control-Allow-Credentials",
    ],
    cwe: ["CWE-942: Permissive CORS Policy"],
  },
  {
    title: "Client-Side Validation and Business Logic",
    icon: <FactCheckIcon />,
    color: "#06b6d4",
    description: "Bypassing client-side controls and exploiting business logic flaws.",
    keyPoints: [
      "Hidden form field manipulation",
      "Client-side price/quantity modification",
      "Step skipping in multi-step processes",
      "Parameter tampering",
      "Business logic race conditions",
      "Negative quantity/price attacks",
    ],
    techniques: [
      "Intercept and modify all client-side validated data",
      "Test purchase flows with negative values",
      "Skip steps by directly accessing URLs",
      "Modify hidden fields (user ID, prices, roles)",
      "Test limits and boundaries",
    ],
  },
  {
    title: "Clickjacking and UI Redressing",
    icon: <MouseIcon />,
    color: "#ec4899",
    description: "Tricking users into clicking hidden elements via iframe overlay.",
    keyPoints: [
      "Classic clickjacking with transparent iframe",
      "Likejacking on social platforms",
      "Cursorjacking attacks",
      "Drag-and-drop data theft",
      "X-Frame-Options bypass",
      "CSP frame-ancestors bypass",
    ],
    techniques: [
      "Check for X-Frame-Options header",
      "Check CSP frame-ancestors directive",
      "Test iframe embedding from different origins",
      "Create PoC with opacity: 0 iframe",
    ],
    cwe: ["CWE-1021: Improper Restriction of Rendered UI Layers"],
  },
];

// Section 6: HTTP Smuggling
const smugglingTopics: TopicSection[] = [
  {
    title: "Classic HTTP Request Smuggling",
    icon: <HttpIcon />,
    color: "#ef4444",
    description: "CL.TE and TE.CL desynchronization attacks between front-end and back-end servers.",
    keyPoints: [
      "Content-Length vs Transfer-Encoding disagreement",
      "CL.TE: Front-end uses CL, back-end uses TE",
      "TE.CL: Front-end uses TE, back-end uses CL",
      "TE.TE: Obfuscating Transfer-Encoding header",
      "Request poisoning and response queue poisoning",
    ],
    techniques: [
      "CL.TE: Send request where CL is shorter than body + chunked",
      "TE.CL: Send chunked request with CL covering only first chunk",
      "Obfuscation: Transfer-Encoding: chunked, Transfer-Encoding: x",
      "Use timing to detect vulnerabilities",
    ],
    tools: ["Burp Suite HTTP Request Smuggler", "smuggler.py"],
    cwe: ["CWE-444: HTTP Request/Response Smuggling"],
  },
  {
    title: "HTTP/2 Request Smuggling",
    icon: <SpeedIcon />,
    color: "#8b5cf6",
    description: "Exploiting HTTP/2 to HTTP/1.1 downgrade for smuggling attacks.",
    keyPoints: [
      "H2.CL and H2.TE smuggling",
      "HTTP/2 header injection via CRLF",
      "Pseudo-header manipulation",
      "HTTP/2 exclusive headers exploitation",
      "Request tunneling via CONNECT",
    ],
    techniques: [
      "Inject headers via HTTP/2 binary framing",
      "Exploit Content-Length handling differences",
      "Use HTTP/2 CONNECT for request tunneling",
      "Test with HTTP/2-specific tools",
    ],
  },
  {
    title: "WebSocket Smuggling",
    icon: <WifiIcon />,
    color: "#10b981",
    description: "Exploiting WebSocket upgrade handling for cross-site attacks.",
    keyPoints: [
      "WebSocket hijacking via smuggling",
      "Cross-Site WebSocket Hijacking (CSWSH)",
      "WebSocket to HTTP downgrade",
      "Origin validation bypass",
    ],
    techniques: [
      "Smuggle requests via WebSocket upgrade",
      "Test Origin header validation",
      "Check for CSRF in WebSocket handshake",
      "Exploit reverse proxy WebSocket handling",
    ],
  },
  {
    title: "Browser Desync Attacks",
    icon: <LinkOffIcon />,
    color: "#f59e0b",
    description: "Client-side desynchronization for connection hijacking.",
    keyPoints: [
      "Client-side desync via CL.0",
      "Pause-based desync",
      "Browser connection pool poisoning",
      "Stealing other users' responses",
    ],
    techniques: [
      "CL.0: Server ignores Content-Length completely",
      "Poison browser's connection pool",
      "Exploit keep-alive connection reuse",
      "Target same-site credential theft",
    ],
  },
];

// Section 7: Testing Workflow
const workflowTopics: TopicSection[] = [
  {
    title: "Building Test Cases from Findings",
    icon: <AssignmentIcon />,
    color: "#3b82f6",
    description: "Structuring your testing approach based on initial reconnaissance.",
    keyPoints: [
      "Create test cases for each endpoint",
      "Map test cases to OWASP Testing Guide",
      "Prioritize based on functionality risk",
      "Document authentication requirements per test",
      "Track coverage and completion",
      "Use checklists for consistency",
    ],
    tips: [
      "Start with authentication and authorization tests",
      "Test input validation on all parameters",
      "Document expected vs actual behavior",
      "Retest after developers claim fixes",
    ],
  },
  {
    title: "Chaining Vulnerabilities",
    icon: <LinkIcon />,
    color: "#8b5cf6",
    description: "Combining multiple findings to demonstrate maximum business impact.",
    keyPoints: [
      "Self-XSS + CSRF = Reflected XSS impact",
      "IDOR + sensitive data = full account takeover",
      "SSRF + cloud metadata = credential theft",
      "Low-severity chain to critical impact",
      "Document attack paths clearly",
    ],
    techniques: [
      "Map relationships between vulnerabilities",
      "Consider multi-step attack scenarios",
      "Think like an attacker: what's the end goal?",
      "Demo chains in controlled PoC environments",
    ],
  },
  {
    title: "Safe Proof of Concept Guidelines",
    icon: <WarningIcon />,
    color: "#f59e0b",
    description: "Demonstrating impact without causing harm to production systems.",
    keyPoints: [
      "Use benign payloads (alert, console.log)",
      "Avoid data destruction or modification",
      "Don't access more data than needed to prove the issue",
      "Use your own test accounts where possible",
      "Document with screenshots and video",
      "Never exfiltrate real user data",
    ],
    tips: [
      "For RCE: whoami, hostname (not rm -rf)",
      "For SQLi: SELECT version(), not DROP TABLE",
      "For XSS: alert(document.domain), not cookie theft",
      "Always coordinate with client before exploitation",
    ],
  },
  {
    title: "Documenting and Prioritizing Issues",
    icon: <DescriptionIcon />,
    color: "#10b981",
    description: "Writing clear, actionable reports with proper severity ratings.",
    keyPoints: [
      "Use CVSS for consistent severity scoring",
      "Include clear reproduction steps",
      "Provide remediation recommendations",
      "Include business impact assessment",
      "Attach supporting evidence",
      "Executive summary for non-technical stakeholders",
    ],
    techniques: [
      "Title: Clear, specific vulnerability name",
      "Severity: Critical/High/Medium/Low/Info",
      "Description: What, where, why it matters",
      "Steps: Numbered, reproducible instructions",
      "Impact: What an attacker could achieve",
      "Remediation: How to fix it",
    ],
  },
];

const tabSections = [
  { label: "Overview", icon: <SearchIcon />, color: "#6366f1" },
  { label: "Auth & Access", icon: <LockIcon />, color: "#3b82f6" },
  { label: "Injection", icon: <BugReportIcon />, color: "#ef4444" },
  { label: "Server-Side", icon: <StorageIcon />, color: "#8b5cf6" },
  { label: "Client-Side", icon: <WebIcon />, color: "#f59e0b" },
  { label: "Smuggling", icon: <SyncAltIcon />, color: "#10b981" },
  { label: "Workflow", icon: <AssignmentIcon />, color: "#ec4899" },
];

const modernTargets = [
  {
    title: "Single Page Apps (SPA)",
    icon: <WebIcon />,
    color: "#f59e0b",
    description: "Client-side routing, heavy API usage, and token storage choices introduce unique risks.",
    checks: [
      "DOM-based XSS sinks and unsafe templating",
      "JWT storage in localStorage or sessionStorage",
      "CORS configuration for API endpoints",
      "Client-side role checks without server enforcement",
    ],
  },
  {
    title: "GraphQL APIs",
    icon: <DataObjectIcon />,
    color: "#8b5cf6",
    description: "GraphQL can expose deep data graphs and requires strict field-level authorization.",
    checks: [
      "Introspection exposure in production",
      "AuthZ for nested fields and resolvers",
      "Query depth and complexity limits",
      "Batching and rate limit bypass",
    ],
  },
  {
    title: "WebSockets and Real-Time",
    icon: <SyncAltIcon />,
    color: "#10b981",
    description: "Persistent connections can bypass traditional HTTP controls and logging.",
    checks: [
      "Auth enforcement on upgrade and reconnect",
      "Message validation and schema checks",
      "Origin and CSRF-style protections",
      "Rate limiting for message floods",
    ],
  },
  {
    title: "Serverless and Cloud Services",
    icon: <CloudIcon />,
    color: "#ef4444",
    description: "Cloud-native apps often integrate storage, queues, and metadata endpoints.",
    checks: [
      "SSRF to cloud metadata services",
      "Public object storage and bucket policies",
      "Overly broad IAM roles and permissions",
      "Secrets exposure in logs and environment variables",
    ],
  },
  {
    title: "Third-Party and Supply Chain",
    icon: <LinkIcon />,
    color: "#3b82f6",
    description: "External scripts, analytics, and SDKs expand the attack surface.",
    checks: [
      "Subresource Integrity (SRI) for CDN assets",
      "CSP coverage for third-party domains",
      "Dependency versions and known CVEs",
      "Exposed API keys in client bundles",
    ],
  },
  {
    title: "CI/CD and Staging Environments",
    icon: <SettingsIcon />,
    color: "#6366f1",
    description: "Build pipelines and non-prod systems often expose debug endpoints and data.",
    checks: [
      "Staging endpoints without auth",
      "Debug flags and verbose error messages",
      "Public artifacts and build logs",
      "Test credentials reused in production",
    ],
  },
];

const ACCENT_COLOR = "#ef4444";
const QUIZ_QUESTION_COUNT = 10;

const selectRandomQuestions = (questions: QuizQuestion[], count: number) =>
  [...questions].sort(() => Math.random() - 0.5).slice(0, count);

const quizQuestions: QuizQuestion[] = [
  {
    id: 1,
    topic: "Recon",
    question: "The primary goal of reconnaissance is to:",
    options: [
      "Map the attack surface and identify entry points",
      "Exploit vulnerabilities immediately",
      "Disable security controls",
      "Generate the final report",
    ],
    correctAnswer: 0,
    explanation: "Recon identifies assets, endpoints, and technologies to guide testing.",
  },
  {
    id: 2,
    topic: "Recon",
    question: "Which file often reveals disallowed paths and admin areas?",
    options: ["robots.txt", "sitemap.xml", "favicon.ico", "humans.txt"],
    correctAnswer: 0,
    explanation: "robots.txt commonly lists paths the site wants crawlers to avoid.",
  },
  {
    id: 3,
    topic: "Tools",
    question: "Which tool is most commonly used as an intercepting proxy?",
    options: ["Burp Suite", "Wireshark", "Nmap", "Metasploit"],
    correctAnswer: 0,
    explanation: "Burp Suite is the standard web proxy for pentesting.",
  },
  {
    id: 4,
    topic: "CORS",
    question: "Which response header controls allowed origins for CORS?",
    options: ["Access-Control-Allow-Origin", "Content-Security-Policy", "X-Frame-Options", "Strict-Transport-Security"],
    correctAnswer: 0,
    explanation: "Access-Control-Allow-Origin specifies which origins can access resources.",
  },
  {
    id: 5,
    topic: "Authorization",
    question: "IDOR is best described as:",
    options: [
      "Accessing objects by manipulating identifiers",
      "Bypassing multi-factor authentication",
      "Injecting SQL statements",
      "Breaking TLS encryption",
    ],
    correctAnswer: 0,
    explanation: "IDOR occurs when object references are not properly authorized.",
  },
  {
    id: 6,
    topic: "CSRF",
    question: "CSRF attacks rely on:",
    options: [
      "A victim's authenticated session",
      "A malformed TLS handshake",
      "Server-side code execution",
      "Bypassing input validation",
    ],
    correctAnswer: 0,
    explanation: "CSRF uses a victim's existing session to perform actions.",
  },
  {
    id: 7,
    topic: "CSRF",
    question: "A common CSRF mitigation is:",
    options: ["Per-request anti-CSRF tokens", "Client-side validation only", "Removing all cookies", "Disabling HTTPS"],
    correctAnswer: 0,
    explanation: "CSRF tokens bind requests to the user session.",
  },
  {
    id: 8,
    topic: "JWT",
    question: "Setting JWT alg to none can lead to:",
    options: ["Signature bypass", "Token encryption", "Token expiration", "CORS errors"],
    correctAnswer: 0,
    explanation: "Using alg=none can allow unsigned tokens.",
  },
  {
    id: 9,
    topic: "Sessions",
    question: "Session fixation occurs when:",
    options: [
      "An attacker sets or predicts a session ID",
      "A user logs out",
      "Sessions expire too quickly",
      "Cookies are encrypted",
    ],
    correctAnswer: 0,
    explanation: "Fixation lets attackers force a known session ID.",
  },
  {
    id: 10,
    topic: "Sessions",
    question: "Which cookie attribute prevents JavaScript access?",
    options: ["HttpOnly", "Secure", "SameSite", "Path"],
    correctAnswer: 0,
    explanation: "HttpOnly blocks client-side scripts from reading cookies.",
  },
  {
    id: 11,
    topic: "Sessions",
    question: "The Secure cookie attribute ensures cookies are sent:",
    options: ["Only over HTTPS", "Only with GET requests", "Only with POST requests", "Only to localhost"],
    correctAnswer: 0,
    explanation: "Secure restricts cookies to encrypted transport.",
  },
  {
    id: 12,
    topic: "Sessions",
    question: "SameSite cookies help reduce:",
    options: ["CSRF", "SQL injection", "XSS", "SSRF"],
    correctAnswer: 0,
    explanation: "SameSite limits cross-site cookie sending.",
  },
  {
    id: 13,
    topic: "SQL Injection",
    question: "Union-based SQLi is commonly used to:",
    options: ["Extract data from other tables", "Encrypt traffic", "Patch databases", "Generate tokens"],
    correctAnswer: 0,
    explanation: "UNION lets attackers combine query results to extract data.",
  },
  {
    id: 14,
    topic: "SQL Injection",
    question: "Time-based blind SQLi relies on:",
    options: ["Response delays to infer data", "Verbose error messages", "Direct database access", "Static analysis"],
    correctAnswer: 0,
    explanation: "Delays indicate true/false conditions in blind SQLi.",
  },
  {
    id: 15,
    topic: "NoSQL",
    question: "A common NoSQL injection pattern is:",
    options: ['{"$ne": null}', "UNION SELECT", "<script>", "../etc/passwd"],
    correctAnswer: 0,
    explanation: "Mongo-style operators like $ne can bypass filters.",
  },
  {
    id: 16,
    topic: "XSS",
    question: "DOM-based XSS occurs primarily in:",
    options: ["Client-side JavaScript", "Database queries", "Web servers", "TLS termination"],
    correctAnswer: 0,
    explanation: "DOM XSS happens in the browser due to unsafe JS.",
  },
  {
    id: 17,
    topic: "XSS",
    question: "Stored XSS means the payload is:",
    options: ["Persisted on the server and served to users", "Reflected immediately only", "Executed only in the tester browser", "Blocked by default"],
    correctAnswer: 0,
    explanation: "Stored XSS persists and affects multiple users.",
  },
  {
    id: 18,
    topic: "XSS",
    question: "A Content Security Policy (CSP) primarily:",
    options: ["Restricts allowed script sources", "Encrypts cookies", "Blocks SQLi", "Enables HTTP/2"],
    correctAnswer: 0,
    explanation: "CSP limits which sources can execute scripts.",
  },
  {
    id: 19,
    topic: "XXE",
    question: "XXE can be used to:",
    options: ["Read local files", "Reset passwords", "Bypass TLS", "Disable logging"],
    correctAnswer: 0,
    explanation: "XXE often exposes local files or internal resources.",
  },
  {
    id: 20,
    topic: "SSRF",
    question: "SSRF commonly targets:",
    options: ["Internal services and metadata endpoints", "User browsers", "Database backups", "DNS servers only"],
    correctAnswer: 0,
    explanation: "SSRF makes servers call internal services or metadata APIs.",
  },
  {
    id: 21,
    topic: "File Inclusion",
    question: "LFI stands for:",
    options: ["Local File Inclusion", "Live Function Injection", "Local Form Injection", "Log File Import"],
    correctAnswer: 0,
    explanation: "LFI allows attackers to read local files via path manipulation.",
  },
  {
    id: 22,
    topic: "File Inclusion",
    question: "A common path traversal payload uses:",
    options: ["../", "<script>", "--", "${}"],
    correctAnswer: 0,
    explanation: "../ sequences traverse directories.",
  },
  {
    id: 23,
    topic: "File Upload",
    question: "Safe file upload handling includes:",
    options: ["Validating extension, MIME type, and magic bytes", "Trusting the filename", "Allowing executable files", "Storing in web root"],
    correctAnswer: 0,
    explanation: "Multiple checks help prevent file upload abuse.",
  },
  {
    id: 24,
    topic: "Command Injection",
    question: "Command injection often uses which separators?",
    options: ["; and &&", "? and &", "+ and -", "% and #"],
    correctAnswer: 0,
    explanation: "Separators chain commands in shell contexts.",
  },
  {
    id: 25,
    topic: "SSTI",
    question: "A common SSTI test payload is:",
    options: ["{{7*7}}", "SELECT *", "<img>", "../../"],
    correctAnswer: 0,
    explanation: "Template expressions like {{7*7}} reveal SSTI.",
  },
  {
    id: 26,
    topic: "Deserialization",
    question: "Insecure deserialization can lead to:",
    options: ["Remote code execution", "Improved performance", "Stronger encryption", "Shorter sessions"],
    correctAnswer: 0,
    explanation: "Gadget chains can execute code when deserialized.",
  },
  {
    id: 27,
    topic: "Brute Force",
    question: "A key mitigation for brute force is:",
    options: ["Rate limiting and account lockout", "Allowing unlimited attempts", "Storing passwords in plaintext", "Disabling logs"],
    correctAnswer: 0,
    explanation: "Rate limits and lockouts slow credential attacks.",
  },
  {
    id: 28,
    topic: "Credentials",
    question: "Credential stuffing is:",
    options: ["Using leaked passwords across sites", "Guessing random passwords", "Phishing only", "Brute forcing OTPs"],
    correctAnswer: 0,
    explanation: "Stuffing reuses known leaked credentials.",
  },
  {
    id: 29,
    topic: "Passwords",
    question: "Best practice for password storage is:",
    options: ["Salted hashing with bcrypt or Argon2", "Plaintext storage", "MD5 without salt", "Encrypting with a hardcoded key"],
    correctAnswer: 0,
    explanation: "Modern hashing with salts resists cracking.",
  },
  {
    id: 30,
    topic: "MFA",
    question: "A common MFA bypass is:",
    options: ["Accessing endpoints that skip MFA", "Using HTTPS", "Disabling cookies", "Changing user agents"],
    correctAnswer: 0,
    explanation: "Some flows allow access without completing MFA.",
  },
  {
    id: 31,
    topic: "OAuth",
    question: "The OAuth state parameter protects against:",
    options: ["CSRF", "SQL injection", "XSS", "Brute force"],
    correctAnswer: 0,
    explanation: "State binds the OAuth flow to the user session.",
  },
  {
    id: 32,
    topic: "OAuth",
    question: "Open redirect issues can lead to:",
    options: ["Token leakage and phishing", "Stronger encryption", "Improved caching", "Better UX"],
    correctAnswer: 0,
    explanation: "Redirect flaws can steal tokens or trick users.",
  },
  {
    id: 33,
    topic: "Authorization",
    question: "BOLA is commonly associated with:",
    options: ["APIs with object-level authorization", "TLS misconfiguration", "Client-side validation", "Log rotation"],
    correctAnswer: 0,
    explanation: "BOLA refers to broken object-level authorization in APIs.",
  },
  {
    id: 34,
    topic: "GraphQL",
    question: "A key risk with GraphQL is:",
    options: ["Missing auth checks on nested fields", "Too many cookies", "TLS downgrade", "DNS rebinding"],
    correctAnswer: 0,
    explanation: "GraphQL needs field-level authorization.",
  },
  {
    id: 35,
    topic: "WebSockets",
    question: "WebSocket security should include:",
    options: ["Auth checks during upgrade and reconnect", "Disabling TLS", "Using only HTTP", "Removing origin checks"],
    correctAnswer: 0,
    explanation: "Authentication must be enforced for persistent connections.",
  },
  {
    id: 36,
    topic: "TLS",
    question: "A modern TLS version to enforce is:",
    options: ["TLS 1.3", "SSL 2.0", "SSL 3.0", "TLS 1.0"],
    correctAnswer: 0,
    explanation: "TLS 1.3 is the current best practice.",
  },
  {
    id: 37,
    topic: "Headers",
    question: "HSTS ensures:",
    options: ["Browsers use HTTPS only", "Cookies are encrypted", "SQLi is blocked", "Sessions never expire"],
    correctAnswer: 0,
    explanation: "HSTS forces HTTPS for a domain.",
  },
  {
    id: 38,
    topic: "Headers",
    question: "Which header helps prevent clickjacking?",
    options: ["X-Frame-Options", "X-Powered-By", "ETag", "Last-Modified"],
    correctAnswer: 0,
    explanation: "X-Frame-Options restricts framing.",
  },
  {
    id: 39,
    topic: "Exploitation",
    question: "A safe RCE proof-of-concept is:",
    options: ["whoami or hostname", "rm -rf /", "exfiltrate user data", "install backdoors"],
    correctAnswer: 0,
    explanation: "Use harmless commands to prove execution.",
  },
  {
    id: 40,
    topic: "Authorization",
    question: "Mass assignment vulnerabilities allow:",
    options: ["Setting unintended fields via APIs", "SQL injection", "XSS", "SSRF"],
    correctAnswer: 0,
    explanation: "Mass assignment lets clients set sensitive fields.",
  },
  {
    id: 41,
    topic: "Rate Limiting",
    question: "A common rate-limit bypass technique is:",
    options: ["IP rotation and header manipulation", "Using HTTPS", "Clearing cookies", "Changing tabs"],
    correctAnswer: 0,
    explanation: "Attackers rotate IPs or spoof headers to evade limits.",
  },
  {
    id: 42,
    topic: "Client-Side",
    question: "Exposed API keys in client code are risky because:",
    options: ["Anyone can reuse them", "They enable faster downloads", "They reduce logging", "They enforce MFA"],
    correctAnswer: 0,
    explanation: "Client-side keys can be harvested and abused.",
  },
  {
    id: 43,
    topic: "Cloud",
    question: "A common cloud storage issue is:",
    options: ["Public buckets with sensitive data", "Too much encryption", "Short filenames", "Using HTTPS"],
    correctAnswer: 0,
    explanation: "Misconfigured buckets often expose data publicly.",
  },
  {
    id: 44,
    topic: "Recon",
    question: "JavaScript analysis is useful for:",
    options: ["Finding hidden endpoints and secrets", "Increasing TLS strength", "Fixing DNS", "Generating CSRF tokens"],
    correctAnswer: 0,
    explanation: "Client bundles often reveal API routes or keys.",
  },
  {
    id: 45,
    topic: "HTTP",
    question: "Parameter pollution occurs when:",
    options: ["Multiple parameters with same name change behavior", "Passwords are reused", "Headers are missing", "TLS is weak"],
    correctAnswer: 0,
    explanation: "Duplicate params can confuse backend parsing.",
  },
  {
    id: 46,
    topic: "HTTP",
    question: "Host header attacks can be used to:",
    options: ["Poison password reset links", "Fix cookies", "Prevent XSS", "Improve caching"],
    correctAnswer: 0,
    explanation: "Host header tampering can alter generated links.",
  },
  {
    id: 47,
    topic: "CORS",
    question: "A risky CORS configuration is:",
    options: ["Reflecting any Origin with credentials", "Restricting to a single origin", "Using preflight", "Disabling credentials"],
    correctAnswer: 0,
    explanation: "Reflecting origin and allowing credentials enables cross-site access.",
  },
  {
    id: 48,
    topic: "Testing",
    question: "Timing or size differences can indicate:",
    options: ["User enumeration or blind injection", "Stronger encryption", "Reduced attack surface", "No vulnerability"],
    correctAnswer: 0,
    explanation: "Differences often reveal true/false conditions.",
  },
  {
    id: 49,
    topic: "HTTP",
    question: "HTTP request smuggling relies on:",
    options: ["Discrepancies in request parsing", "Weak passwords", "Expired cookies", "Exposed logs"],
    correctAnswer: 0,
    explanation: "CL/TE mismatches can desync proxies and servers.",
  },
  {
    id: 50,
    topic: "HTTP",
    question: "A likely impact of request smuggling is:",
    options: ["Cache poisoning or auth bypass", "Better TLS", "Faster responses", "Lower CPU"],
    correctAnswer: 0,
    explanation: "Smuggling can poison caches or bypass controls.",
  },
  {
    id: 51,
    topic: "Authorization",
    question: "Broken access control can lead to:",
    options: ["Unauthorized data access", "Improved uptime", "Fewer errors", "Smaller logs"],
    correctAnswer: 0,
    explanation: "Access control failures expose sensitive data and functions.",
  },
  {
    id: 52,
    topic: "Credentials",
    question: "Default credentials are dangerous because:",
    options: ["They are widely known and reused", "They are too long", "They require MFA", "They are encrypted"],
    correctAnswer: 0,
    explanation: "Default passwords are commonly guessed.",
  },
  {
    id: 53,
    topic: "Recon",
    question: "Which tool is commonly used for directory brute forcing?",
    options: ["ffuf", "tcpdump", "john", "aircrack-ng"],
    correctAnswer: 0,
    explanation: "ffuf is a popular directory and content discovery tool.",
  },
  {
    id: 54,
    topic: "Recon",
    question: "Which tools are used for subdomain enumeration?",
    options: ["Amass or Subfinder", "Hashcat", "Wireshark", "Netcat"],
    correctAnswer: 0,
    explanation: "Amass and Subfinder enumerate subdomains.",
  },
  {
    id: 55,
    topic: "MFA",
    question: "MFA fatigue attacks target:",
    options: ["Push notification prompts", "Password hashes", "TLS ciphers", "DNS records"],
    correctAnswer: 0,
    explanation: "Fatigue attacks spam push approvals.",
  },
  {
    id: 56,
    topic: "Tokens",
    question: "Tokens in URLs are risky due to:",
    options: ["Referer logs and browser history leakage", "Lower entropy", "Better caching", "Automatic rotation"],
    correctAnswer: 0,
    explanation: "URLs leak via logs and referrers.",
  },
  {
    id: 57,
    topic: "Sessions",
    question: "Good session management includes:",
    options: ["Idle and absolute timeouts", "No expiration", "Same session after logout", "URL tokens"],
    correctAnswer: 0,
    explanation: "Sessions should expire and be invalidated properly.",
  },
  {
    id: 58,
    topic: "APIs",
    question: "Rate limiting should ideally be enforced:",
    options: ["Per user or token, not just IP", "Only for admins", "Only for GET requests", "Only in the client"],
    correctAnswer: 0,
    explanation: "Per-user limits prevent abuse across shared IPs.",
  },
  {
    id: 59,
    topic: "Authorization",
    question: "A common IDOR test is to:",
    options: ["Change an object ID in the request", "Change the User-Agent", "Clear cookies", "Switch HTTPS to HTTP"],
    correctAnswer: 0,
    explanation: "Swapping IDs reveals missing access checks.",
  },
  {
    id: 60,
    topic: "Client-Side",
    question: "Storing JWTs in localStorage increases risk of:",
    options: ["XSS token theft", "SQL injection", "CSRF", "SSRF"],
    correctAnswer: 0,
    explanation: "XSS can read localStorage tokens.",
  },
  {
    id: 61,
    topic: "WAF",
    question: "Common WAF bypass techniques include:",
    options: ["Encoding and case variations", "Using HTTPS", "Shorter URLs", "Static content"],
    correctAnswer: 0,
    explanation: "WAFs can be bypassed with encoding and obfuscation.",
  },
  {
    id: 62,
    topic: "SSRF",
    question: "The AWS metadata IP is:",
    options: ["169.254.169.254", "127.0.0.1", "10.0.0.1", "8.8.8.8"],
    correctAnswer: 0,
    explanation: "Cloud metadata endpoints are commonly at 169.254.169.254.",
  },
  {
    id: 63,
    topic: "SQL Injection",
    question: "The best defense against SQL injection is:",
    options: ["Parameterized queries", "Client-side validation", "String concatenation", "Hiding errors"],
    correctAnswer: 0,
    explanation: "Prepared statements prevent injection.",
  },
  {
    id: 64,
    topic: "XSS",
    question: "The primary defense against XSS is:",
    options: ["Context-aware output encoding", "Disabling JavaScript", "Using GET only", "Blocking images"],
    correctAnswer: 0,
    explanation: "Output encoding neutralizes injected scripts.",
  },
  {
    id: 65,
    topic: "CSRF",
    question: "CSRF risk is higher when:",
    options: ["Apps rely on cookies without CSRF tokens", "Apps use tokens in headers", "Apps are read-only", "Apps use OAuth"],
    correctAnswer: 0,
    explanation: "Cookie-based auth needs CSRF protections.",
  },
  {
    id: 66,
    topic: "Business Logic",
    question: "A business logic flaw example is:",
    options: ["Manipulating price or quantity fields", "TLS downgrade", "SQLi", "Buffer overflow"],
    correctAnswer: 0,
    explanation: "Logic bugs often involve workflow or pricing abuse.",
  },
  {
    id: 67,
    topic: "JWT",
    question: "JWT validation should always check:",
    options: ["Signature and expiration", "Only the header", "Only the payload", "Only the issuer name"],
    correctAnswer: 0,
    explanation: "Signature and exp are critical for JWT security.",
  },
  {
    id: 68,
    topic: "Sessions",
    question: "Session IDs should be:",
    options: ["Random and high entropy", "Sequential", "Usernames", "Timestamps"],
    correctAnswer: 0,
    explanation: "High-entropy IDs resist guessing.",
  },
  {
    id: 69,
    topic: "Scope",
    question: "Pentesting should only be performed on:",
    options: ["Authorized, in-scope targets", "Any public IP", "Competitor sites", "Unpatched systems"],
    correctAnswer: 0,
    explanation: "Testing must follow scope and authorization.",
  },
  {
    id: 70,
    topic: "Reporting",
    question: "A good report should include:",
    options: ["Impact, steps to reproduce, and remediation", "Only raw logs", "Only CVSS scores", "Only screenshots"],
    correctAnswer: 0,
    explanation: "Clear impact and remediation make reports actionable.",
  },
  {
    id: 71,
    topic: "Headers",
    question: "Which header helps control allowed framing sources in CSP?",
    options: ["frame-ancestors", "script-src", "img-src", "connect-src"],
    correctAnswer: 0,
    explanation: "frame-ancestors governs which sites can frame content.",
  },
  {
    id: 72,
    topic: "OAuth",
    question: "PKCE primarily protects against:",
    options: ["Authorization code interception", "SQL injection", "XSS", "DNS poisoning"],
    correctAnswer: 0,
    explanation: "PKCE prevents stolen auth codes from being used.",
  },
  {
    id: 73,
    topic: "CORS",
    question: "A secure CORS setup should:",
    options: ["Allow only trusted origins", "Allow all origins with credentials", "Disable preflight", "Ignore Origin header"],
    correctAnswer: 0,
    explanation: "Restricting origins reduces cross-site risk.",
  },
  {
    id: 74,
    topic: "Testing",
    question: "Why is staging often risky?",
    options: ["It may have weaker auth or debug endpoints", "It always uses TLS 1.3", "It blocks all traffic", "It mirrors production security"],
    correctAnswer: 0,
    explanation: "Staging is frequently less hardened than production.",
  },
  {
    id: 75,
    topic: "Reporting",
    question: "An executive summary should focus on:",
    options: ["Business impact and risk", "Payload syntax", "Raw HTTP requests", "Stack traces"],
    correctAnswer: 0,
    explanation: "Executives need risk and impact, not technical details.",
  },
];


function TopicAccordion({ topics, defaultExpanded = false }: { topics: TopicSection[]; defaultExpanded?: boolean }) {
  const theme = useTheme();

  return (
    <>
      {topics.map((topic, index) => (
        <Accordion
          key={topic.title}
          defaultExpanded={defaultExpanded && index === 0}
          sx={{
            mb: 2,
            border: `1px solid ${alpha(topic.color, 0.2)}`,
            borderRadius: "12px !important",
            "&:before": { display: "none" },
            overflow: "hidden",
          }}
        >
          <AccordionSummary
            expandIcon={<ExpandMoreIcon />}
            sx={{
              borderLeft: `4px solid ${topic.color}`,
              "&:hover": { bgcolor: alpha(topic.color, 0.02) },
            }}
          >
            <Box sx={{ display: "flex", alignItems: "center", gap: 2 }}>
              <Box
                sx={{
                  width: 40,
                  height: 40,
                  borderRadius: 2,
                  bgcolor: alpha(topic.color, 0.1),
                  display: "flex",
                  alignItems: "center",
                  justifyContent: "center",
                  color: topic.color,
                }}
              >
                {topic.icon}
              </Box>
              <Box>
                <Typography variant="h6" sx={{ fontWeight: 700 }}>
                  {topic.title}
                </Typography>
                <Typography variant="body2" color="text.secondary" sx={{ display: { xs: "none", sm: "block" } }}>
                  {topic.description}
                </Typography>
              </Box>
            </Box>
          </AccordionSummary>
          <AccordionDetails sx={{ pt: 0 }}>
            <Typography variant="body1" color="text.secondary" sx={{ mb: 3, display: { xs: "block", sm: "none" } }}>
              {topic.description}
            </Typography>

            <Grid container spacing={3}>
              {/* Key Points */}
              <Grid item xs={12} md={topic.techniques || topic.tools ? 6 : 12}>
                <Typography variant="subtitle2" sx={{ fontWeight: 700, mb: 2, color: topic.color }}>
                   Key Points
                </Typography>
                <List dense disablePadding>
                  {topic.keyPoints.map((point, i) => (
                    <ListItem key={i} disableGutters sx={{ py: 0.5 }}>
                      <ListItemIcon sx={{ minWidth: 28 }}>
                        <CheckCircleIcon sx={{ fontSize: 16, color: topic.color }} />
                      </ListItemIcon>
                      <ListItemText
                        primary={point}
                        primaryTypographyProps={{ variant: "body2" }}
                      />
                    </ListItem>
                  ))}
                </List>
              </Grid>

              {/* Techniques and Tools */}
              {(topic.techniques || topic.tools) && (
                <Grid item xs={12} md={6}>
                  {topic.techniques && (
                    <Box sx={{ mb: 3 }}>
                      <Typography variant="subtitle2" sx={{ fontWeight: 700, mb: 2, color: "warning.main" }}>
                         Techniques
                      </Typography>
                      <Paper
                        sx={{
                          p: 2,
                          bgcolor: alpha(theme.palette.warning.main, 0.03),
                          border: `1px solid ${alpha(theme.palette.warning.main, 0.15)}`,
                          borderRadius: 2,
                        }}
                      >
                        {topic.techniques.map((technique, i) => (
                          <Typography
                            key={i}
                            variant="body2"
                            sx={{
                              fontFamily: "monospace",
                              fontSize: "0.8rem",
                              mb: i < topic.techniques!.length - 1 ? 1 : 0,
                            }}
                          >
                             {technique}
                          </Typography>
                        ))}
                      </Paper>
                    </Box>
                  )}

                  {topic.tools && (
                    <Box sx={{ mb: 2 }}>
                      <Typography variant="subtitle2" sx={{ fontWeight: 700, mb: 1.5 }}>
                         Tools
                      </Typography>
                      <Box sx={{ display: "flex", flexWrap: "wrap", gap: 0.5 }}>
                        {topic.tools.map((tool) => (
                          <Chip
                            key={tool}
                            label={tool}
                            size="small"
                            sx={{
                              bgcolor: alpha(topic.color, 0.1),
                              color: topic.color,
                              fontWeight: 500,
                            }}
                          />
                        ))}
                      </Box>
                    </Box>
                  )}

                  {topic.cwe && (
                    <Box>
                      <Typography variant="subtitle2" sx={{ fontWeight: 700, mb: 1 }}>
                         Related CWEs
                      </Typography>
                      {topic.cwe.map((cwe) => (
                        <Chip
                          key={cwe}
                          label={cwe}
                          size="small"
                          variant="outlined"
                          sx={{ mr: 0.5, mb: 0.5, fontSize: "0.7rem" }}
                        />
                      ))}
                    </Box>
                  )}
                </Grid>
              )}

              {/* Tips */}
              {topic.tips && (
                <Grid item xs={12}>
                  <Alert
                    severity="info"
                    icon={<InfoIcon />}
                    sx={{
                      borderRadius: 2,
                      "& .MuiAlert-message": { width: "100%" },
                    }}
                  >
                    <Typography variant="subtitle2" sx={{ fontWeight: 700, mb: 1 }}>
                       Pro Tips
                    </Typography>
                    <List dense disablePadding>
                      {topic.tips.map((tip, i) => (
                        <ListItem key={i} disableGutters sx={{ py: 0.25 }}>
                          <Typography variant="body2"> {tip}</Typography>
                        </ListItem>
                      ))}
                    </List>
                  </Alert>
                </Grid>
              )}
            </Grid>
          </AccordionDetails>
        </Accordion>
      ))}
    </>
  );
}

export default function PentestGuidePage() {
  const theme = useTheme();
  const navigate = useNavigate();
  const [tabValue, setTabValue] = useState(0);
  const [quizPool] = useState<QuizQuestion[]>(() =>
    selectRandomQuestions(quizQuestions, QUIZ_QUESTION_COUNT)
  );

  const pageContext = `This page covers penetration testing methodology and techniques. Topics include: reconnaissance, scanning, enumeration, exploitation, post-exploitation, and reporting. Current tab: ${['Methodology', 'Web Testing', 'Network Testing', 'Social Engineering', 'Reporting'][tabValue] || 'Overview'}. Covers OWASP testing methodology, common attack vectors, and professional pentest workflows.`;

  return (
    <LearnPageLayout pageTitle="Penetration Testing Guide" pageContext={pageContext}>
    <Box sx={{ minHeight: "100vh", bgcolor: "#0a0a0f", py: 4 }}>
      <Container maxWidth="lg">
        {/* Header */}
        <Box sx={{ mb: 4 }}>
          <Chip
            component={Link}
            to="/learn"
            icon={<ArrowBackIcon />}
            label="Back to Learning Hub"
            clickable
            variant="outlined"
            sx={{ borderRadius: 2, mb: 3 }}
          />
          <Box sx={{ display: "flex", alignItems: "center", gap: 2, mb: 2 }}>
            <SecurityIcon sx={{ fontSize: 40, color: "#ef4444" }} />
            <Typography
              variant="h3"
              sx={{
                fontWeight: 700,
                background: "linear-gradient(135deg, #ef4444 0%, #f59e0b 100%)",
                backgroundClip: "text",
                WebkitBackgroundClip: "text",
                color: "transparent",
              }}
            >
              Web App Pentesting Guide
            </Typography>
          </Box>
          <Typography variant="h6" sx={{ color: "grey.400", mb: 2 }}>
            Comprehensive methodology for professional security assessments
          </Typography>
          <Box sx={{ display: "flex", gap: 1, flexWrap: "wrap" }}>
            <Chip icon={<BugReportIcon />} label="OWASP Top 10" size="small" />
            <Chip icon={<SearchIcon />} label="Reconnaissance" size="small" />
            <Chip icon={<LockIcon />} label="Authentication" size="small" />
            <Chip icon={<CodeIcon />} label="Injection Attacks" size="small" />
          </Box>
        </Box>

        {/* Introduction Section */}
        <Paper
          sx={{
            p: 4,
            mb: 4,
            borderRadius: 3,
            background: `linear-gradient(135deg, ${alpha("#ef4444", 0.15)} 0%, ${alpha("#f59e0b", 0.1)} 50%, ${alpha("#ef4444", 0.05)} 100%)`,
            border: `1px solid ${alpha("#ef4444", 0.3)}`,
          }}
        >
          <Typography variant="h5" gutterBottom sx={{ fontWeight: 700, color: "#e0e0e0" }}>
            What is Web Application Penetration Testing?
          </Typography>

          <Typography paragraph sx={{ fontSize: "1.05rem", lineHeight: 1.8, color: "grey.300" }}>
            <strong>Web Application Penetration Testing</strong> (or "web pentesting") is the practice of simulating real-world
            attacks against web applications to identify security vulnerabilities before malicious actors can exploit them.
            It's a critical component of any organization's security program.
          </Typography>

          <Typography paragraph sx={{ fontSize: "1.05rem", lineHeight: 1.8, color: "grey.300" }}>
            Unlike automated vulnerability scanning, penetration testing involves <em>manual verification</em>, business logic
            testing, and chaining multiple vulnerabilities together - just like a real attacker would.
          </Typography>

          <Grid container spacing={2} sx={{ mb: 3 }}>
            {[
              { icon: <BugReportIcon />, title: "Find Vulnerabilities", desc: "Identify security flaws before attackers do", color: "#ef4444" },
              { icon: <PolicyIcon />, title: "Compliance", desc: "Meet PCI-DSS, SOC2, and regulatory requirements", color: "#f59e0b" },
              { icon: <SecurityIcon />, title: "Risk Assessment", desc: "Understand real-world impact of security issues", color: "#22c55e" },
              { icon: <FactCheckIcon />, title: "Validate Controls", desc: "Test effectiveness of security measures", color: "#06b6d4" },
            ].map((item) => (
              <Grid item xs={12} sm={6} md={3} key={item.title}>
                <Card
                  sx={{
                    height: "100%",
                    bgcolor: alpha(item.color, 0.1),
                    border: `1px solid ${alpha(item.color, 0.3)}`,
                    borderRadius: 2,
                  }}
                >
                  <CardContent>
                    <Box sx={{ display: "flex", alignItems: "center", gap: 1, mb: 1, color: item.color }}>
                      {item.icon}
                      <Typography variant="subtitle2" fontWeight="bold" sx={{ color: "#e0e0e0" }}>{item.title}</Typography>
                    </Box>
                    <Typography variant="body2" sx={{ color: "grey.400" }}>{item.desc}</Typography>
                  </CardContent>
                </Card>
              </Grid>
            ))}
          </Grid>

          <Alert severity="warning" sx={{ bgcolor: alpha("#f59e0b", 0.1), border: `1px solid ${alpha("#f59e0b", 0.3)}` }}>
            <Typography sx={{ color: "#e0e0e0", fontWeight: 600 }}>Legal Disclaimer</Typography>
            <Typography sx={{ color: "grey.300" }}>
              This guide is for authorized security testing only. Always obtain written permission before testing.
              Unauthorized access to computer systems is illegal. Use this knowledge responsibly and ethically.
            </Typography>
          </Alert>
        </Paper>

        {/* Essential Pentesting Tools */}
        <Paper
          sx={{
            p: 4,
            mb: 4,
            borderRadius: 3,
            bgcolor: "#0f1024",
            border: `1px solid ${alpha("#8b5cf6", 0.3)}`,
          }}
        >
          <Typography variant="h5" sx={{ fontWeight: 700, color: "#e0e0e0", mb: 3, display: "flex", alignItems: "center", gap: 2 }}>
            <BuildIcon sx={{ color: "#8b5cf6" }} />
            Essential Pentesting Tools
          </Typography>

          <Grid container spacing={2}>
            {[
              {
                category: "Proxy & Interception",
                color: "#ef4444",
                tools: [
                  { name: "Burp Suite", desc: "Industry-standard web proxy with scanner, intruder, repeater" },
                  { name: "OWASP ZAP", desc: "Free open-source alternative with active scanning" },
                  { name: "mitmproxy", desc: "CLI-based proxy for scripting and automation" },
                ],
              },
              {
                category: "Reconnaissance",
                color: "#f59e0b",
                tools: [
                  { name: "Nmap", desc: "Network scanning and service enumeration" },
                  { name: "Amass / Subfinder", desc: "Subdomain enumeration and OSINT" },
                  { name: "ffuf / Gobuster", desc: "Directory and parameter fuzzing" },
                ],
              },
              {
                category: "Exploitation",
                color: "#22c55e",
                tools: [
                  { name: "SQLMap", desc: "Automated SQL injection detection and exploitation" },
                  { name: "Nuclei", desc: "Template-based vulnerability scanning" },
                  { name: "XSStrike", desc: "Advanced XSS detection and exploitation" },
                ],
              },
              {
                category: "Post-Exploitation",
                color: "#06b6d4",
                tools: [
                  { name: "Metasploit", desc: "Exploitation framework with payloads and post modules" },
                  { name: "Cobalt Strike", desc: "Commercial adversary simulation platform" },
                  { name: "Impacket", desc: "Python network protocol tools for Windows" },
                ],
              },
            ].map((cat) => (
              <Grid item xs={12} sm={6} md={3} key={cat.category}>
                <Card sx={{ height: "100%", bgcolor: alpha(cat.color, 0.08), border: `1px solid ${alpha(cat.color, 0.2)}`, borderRadius: 2 }}>
                  <CardContent>
                    <Typography variant="subtitle1" sx={{ fontWeight: 700, color: cat.color, mb: 2 }}>
                      {cat.category}
                    </Typography>
                    {cat.tools.map((tool) => (
                      <Box key={tool.name} sx={{ mb: 1.5 }}>
                        <Typography variant="subtitle2" sx={{ fontWeight: 600, color: "#e0e0e0" }}>
                          {tool.name}
                        </Typography>
                        <Typography variant="caption" sx={{ color: "grey.400" }}>
                          {tool.desc}
                        </Typography>
                      </Box>
                    ))}
                  </CardContent>
                </Card>
              </Grid>
            ))}
          </Grid>
        </Paper>

        {/* Quick Reference: Common Payloads */}
        <Paper
          sx={{
            p: 4,
            mb: 4,
            borderRadius: 3,
            bgcolor: "#0f1024",
            border: `1px solid ${alpha("#ef4444", 0.3)}`,
          }}
        >
          <Typography variant="h5" sx={{ fontWeight: 700, color: "#e0e0e0", mb: 3, display: "flex", alignItems: "center", gap: 2 }}>
            <SpeedIcon sx={{ color: "#ef4444" }} />
            Quick Reference: Common Attack Payloads
          </Typography>

          <Grid container spacing={2}>
            {[
              { attack: "SQL Injection", payload: "' OR '1'='1' --", target: "Login forms, search, APIs", severity: "Critical", color: "#ef4444" },
              { attack: "XSS (Reflected)", payload: "<script>alert(document.domain)</script>", target: "URL parameters, search boxes", severity: "High", color: "#f59e0b" },
              { attack: "XSS (Stored)", payload: "<img src=x onerror=alert(1)>", target: "Comments, profiles, messages", severity: "High", color: "#f59e0b" },
              { attack: "Command Injection", payload: "; cat /etc/passwd", target: "File operations, ping utilities", severity: "Critical", color: "#ef4444" },
              { attack: "Path Traversal", payload: "../../etc/passwd", target: "File download, include functions", severity: "High", color: "#f59e0b" },
              { attack: "SSRF", payload: "http://169.254.169.254/latest/meta-data/", target: "URL fetchers, webhooks", severity: "High", color: "#f59e0b" },
              { attack: "IDOR", payload: "/api/users/123  /api/users/124", target: "User profiles, orders, files", severity: "Medium", color: "#3b82f6" },
              { attack: "JWT None Alg", payload: '{"alg":"none","typ":"JWT"}', target: "JWT authentication", severity: "Critical", color: "#ef4444" },
              { attack: "SSTI (Jinja2)", payload: "{{7*7}}  {{config}}", target: "Template engines", severity: "Critical", color: "#ef4444" },
              { attack: "XXE", payload: '<!ENTITY xxe SYSTEM "file:///etc/passwd">', target: "XML parsers", severity: "High", color: "#f59e0b" },
              { attack: "Open Redirect", payload: "//evil.com or /\\evil.com", target: "Login redirects, OAuth", severity: "Medium", color: "#3b82f6" },
              { attack: "CRLF Injection", payload: "%0d%0aSet-Cookie:admin=true", target: "Headers, logs", severity: "Medium", color: "#3b82f6" },
            ].map((item, idx) => (
              <Grid item xs={12} sm={6} md={4} key={idx}>
                <Paper
                  sx={{
                    p: 2,
                    height: "100%",
                    bgcolor: alpha(item.color, 0.08),
                    border: `1px solid ${alpha(item.color, 0.2)}`,
                    borderRadius: 2,
                  }}
                >
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "center", mb: 1 }}>
                    <Typography variant="subtitle2" sx={{ fontWeight: 700, color: "#e0e0e0" }}>
                      {item.attack}
                    </Typography>
                    <Chip
                      label={item.severity}
                      size="small"
                      sx={{ bgcolor: item.color, color: "white", fontSize: "0.65rem", height: 20 }}
                    />
                  </Box>
                  <Typography variant="caption" sx={{ color: "grey.500", display: "block", mb: 0.5 }}>
                    Target: {item.target}
                  </Typography>
                  <Typography
                    variant="caption"
                    sx={{
                      fontFamily: "monospace",
                      color: "#22c55e",
                      bgcolor: alpha("#22c55e", 0.1),
                      px: 0.5,
                      py: 0.25,
                      borderRadius: 0.5,
                      display: "inline-block",
                      wordBreak: "break-all",
                      fontSize: "0.7rem",
                    }}
                  >
                    {item.payload}
                  </Typography>
                </Paper>
              </Grid>
            ))}
          </Grid>
        </Paper>

        {/* Pentesting Phases Workflow */}
        <Paper
          sx={{
            p: 4,
            mb: 4,
            borderRadius: 3,
            bgcolor: "#0f1024",
            border: `1px solid ${alpha("#22c55e", 0.3)}`,
          }}
        >
          <Typography variant="h5" sx={{ fontWeight: 700, color: "#e0e0e0", mb: 3, display: "flex", alignItems: "center", gap: 2 }}>
            <AccountTreeIcon sx={{ color: "#22c55e" }} />
            Pentesting Phases Workflow
          </Typography>

          <Grid container spacing={1}>
            {[
              { phase: "1", title: "Scoping", desc: "Define targets, rules of engagement, and testing windows", color: "#6366f1", duration: "1-2 days" },
              { phase: "2", title: "Reconnaissance", desc: "Passive and active information gathering about the target", color: "#8b5cf6", duration: "2-3 days" },
              { phase: "3", title: "Scanning", desc: "Port scanning, service enumeration, vulnerability scanning", color: "#a855f7", duration: "1-2 days" },
              { phase: "4", title: "Enumeration", desc: "Deep dive into discovered services, users, and configurations", color: "#d946ef", duration: "2-3 days" },
              { phase: "5", title: "Exploitation", desc: "Attempt to exploit identified vulnerabilities safely", color: "#ef4444", duration: "3-5 days" },
              { phase: "6", title: "Post-Exploitation", desc: "Privilege escalation, lateral movement, data exfiltration", color: "#f59e0b", duration: "2-3 days" },
              { phase: "7", title: "Reporting", desc: "Document findings, risk ratings, and remediation guidance", color: "#22c55e", duration: "2-3 days" },
              { phase: "8", title: "Remediation Support", desc: "Assist with fixes and verify remediation effectiveness", color: "#06b6d4", duration: "Ongoing" },
            ].map((item) => (
              <Grid item xs={6} sm={3} key={item.phase}>
                <Paper
                  sx={{
                    p: 2,
                    height: "100%",
                    bgcolor: alpha(item.color, 0.1),
                    border: `1px solid ${alpha(item.color, 0.3)}`,
                    borderRadius: 2,
                    position: "relative",
                  }}
                >
                  <Box sx={{ display: "flex", alignItems: "center", gap: 1, mb: 1 }}>
                    <Chip
                      label={item.phase}
                      size="small"
                      sx={{ bgcolor: item.color, color: "white", fontWeight: 700, minWidth: 24, height: 24 }}
                    />
                    <Typography variant="subtitle2" sx={{ fontWeight: 700, color: item.color }}>
                      {item.title}
                    </Typography>
                  </Box>
                  <Typography variant="caption" sx={{ color: "grey.400", display: "block", mb: 1 }}>
                    {item.desc}
                  </Typography>
                  <Chip label={item.duration} size="small" sx={{ bgcolor: alpha(item.color, 0.2), color: item.color, fontSize: "0.65rem", height: 18 }} />
                </Paper>
              </Grid>
            ))}
          </Grid>
        </Paper>

        {/* HTTP Headers & Status Codes Reference */}
        <Paper
          sx={{
            p: 4,
            mb: 4,
            borderRadius: 3,
            bgcolor: "#0f1024",
            border: `1px solid ${alpha("#06b6d4", 0.3)}`,
          }}
        >
          <Typography variant="h5" sx={{ fontWeight: 700, color: "#e0e0e0", mb: 3, display: "flex", alignItems: "center", gap: 2 }}>
            <HttpIcon sx={{ color: "#06b6d4" }} />
            HTTP Security Headers & Status Codes
          </Typography>

          <Grid container spacing={3}>
            {/* Security Headers */}
            <Grid item xs={12} md={6}>
              <Typography variant="subtitle1" sx={{ fontWeight: 700, color: "#06b6d4", mb: 2 }}>
                Security Headers to Check
              </Typography>
              <List dense disablePadding>
                {[
                  { header: "Content-Security-Policy", status: "Missing = XSS risk", color: "#ef4444" },
                  { header: "X-Frame-Options", status: "Missing = Clickjacking", color: "#f59e0b" },
                  { header: "X-Content-Type-Options", status: "Should be: nosniff", color: "#22c55e" },
                  { header: "Strict-Transport-Security", status: "HSTS enforcement", color: "#8b5cf6" },
                  { header: "X-XSS-Protection", status: "Legacy, check CSP instead", color: "#6b7280" },
                  { header: "Referrer-Policy", status: "Controls referrer leakage", color: "#06b6d4" },
                  { header: "Permissions-Policy", status: "Feature restrictions", color: "#ec4899" },
                  { header: "Set-Cookie flags", status: "HttpOnly, Secure, SameSite", color: "#f59e0b" },
                ].map((item) => (
                  <ListItem key={item.header} sx={{ py: 0.5, px: 0 }}>
                    <ListItemIcon sx={{ minWidth: 32 }}>
                      <Box sx={{ width: 8, height: 8, borderRadius: "50%", bgcolor: item.color }} />
                    </ListItemIcon>
                    <ListItemText
                      primary={<Typography variant="body2" sx={{ fontFamily: "monospace", color: "#e0e0e0" }}>{item.header}</Typography>}
                      secondary={<Typography variant="caption" sx={{ color: "grey.500" }}>{item.status}</Typography>}
                    />
                  </ListItem>
                ))}
              </List>
            </Grid>

            {/* Status Codes */}
            <Grid item xs={12} md={6}>
              <Typography variant="subtitle1" sx={{ fontWeight: 700, color: "#f59e0b", mb: 2 }}>
                Interesting Status Codes
              </Typography>
              <Grid container spacing={1}>
                {[
                  { code: "200", meaning: "OK - Request succeeded", interest: "Normal response" },
                  { code: "301/302", meaning: "Redirect", interest: "Open redirect testing" },
                  { code: "400", meaning: "Bad Request", interest: "Input validation" },
                  { code: "401", meaning: "Unauthorized", interest: "Auth bypass attempts" },
                  { code: "403", meaning: "Forbidden", interest: "Authorization bypass" },
                  { code: "404", meaning: "Not Found", interest: "Hidden endpoint fuzzing" },
                  { code: "405", meaning: "Method Not Allowed", interest: "Try other HTTP methods" },
                  { code: "500", meaning: "Internal Server Error", interest: "Error-based info leak" },
                  { code: "502/503", meaning: "Bad Gateway/Unavailable", interest: "Backend issues" },
                ].map((item) => (
                  <Grid item xs={6} key={item.code}>
                    <Box sx={{ p: 1, bgcolor: alpha("#f59e0b", 0.05), borderRadius: 1 }}>
                      <Chip label={item.code} size="small" sx={{ bgcolor: "#f59e0b", color: "white", fontWeight: 700, mb: 0.5 }} />
                      <Typography variant="caption" sx={{ color: "grey.400", display: "block" }}>
                        {item.meaning}
                      </Typography>
                      <Typography variant="caption" sx={{ color: "grey.500", fontSize: "0.65rem" }}>
                        {item.interest}
                      </Typography>
                    </Box>
                  </Grid>
                ))}
              </Grid>
            </Grid>
          </Grid>
        </Paper>

        {/* Educational Content Tabs */}
        <Typography variant="h5" sx={{ fontWeight: 700, color: "#e0e0e0", mb: 2, display: "flex", alignItems: "center", gap: 1 }}>
          <SchoolIcon sx={{ color: "#ef4444" }} />
          Web Pentesting Methodology
        </Typography>

        {/* Tabs */}
        <Paper sx={{ bgcolor: "#12121a", borderRadius: 2 }}>
          <Tabs
            value={tabValue}
            onChange={(_, v) => setTabValue(v)}
            variant="scrollable"
            scrollButtons="auto"
            sx={{
              borderBottom: "1px solid rgba(255,255,255,0.1)",
              "& .MuiTab-root": { color: "grey.400" },
              "& .Mui-selected": { color: "#ef4444" },
            }}
          >
            {tabSections.map((section, i) => (
              <Tab
                key={section.label}
                icon={section.icon}
                label={section.label}
              />
            ))}
          </Tabs>

        <Box sx={{ p: 3 }}>
          <TabPanel value={tabValue} index={0}>
            <Typography variant="h5" sx={{ fontWeight: 700, mb: 1 }}>
               Overview and Methodology
            </Typography>
            <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
              Before diving into technical attacks, establish your testing framework, understand the scope,
              and map the application's attack surface.
            </Typography>
            <TopicAccordion topics={overviewTopics} defaultExpanded />
          </TabPanel>

          <TabPanel value={tabValue} index={1}>
            <Typography variant="h5" sx={{ fontWeight: 700, mb: 1 }}>
               Authentication and Authorization
            </Typography>
            <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
              Identity and access control vulnerabilities often lead to complete application compromise.
              Test authentication mechanisms, session management, and authorization controls thoroughly.
            </Typography>
            <TopicAccordion topics={authTopics} defaultExpanded />
          </TabPanel>

          <TabPanel value={tabValue} index={2}>
            <Typography variant="h5" sx={{ fontWeight: 700, mb: 1 }}>
               Injection Attacks
            </Typography>
            <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
              Injection flaws allow attackers to send hostile data to interpreters. These attacks remain
              among the most dangerous and prevalent web vulnerabilities.
            </Typography>
            <TopicAccordion topics={injectionTopics} defaultExpanded />
          </TabPanel>

          <TabPanel value={tabValue} index={3}>
            <Typography variant="h5" sx={{ fontWeight: 700, mb: 1 }}>
               Advanced Server-Side Attacks
            </Typography>
            <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
              Server-side vulnerabilities can lead to remote code execution, internal network access,
              and complete infrastructure compromise.
            </Typography>
            <TopicAccordion topics={serverSideTopics} defaultExpanded />
          </TabPanel>

          <TabPanel value={tabValue} index={4}>
            <Typography variant="h5" sx={{ fontWeight: 700, mb: 1 }}>
               Advanced Client-Side Attacks
            </Typography>
            <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
              Client-side attacks target users' browsers to steal credentials, perform actions, or
              pivot to other attacks.
            </Typography>
            <TopicAccordion topics={clientSideTopics} defaultExpanded />
          </TabPanel>

          <TabPanel value={tabValue} index={5}>
            <Typography variant="h5" sx={{ fontWeight: 700, mb: 1 }}>
               HTTP Request Smuggling
            </Typography>
            <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
              Request smuggling exploits discrepancies in how servers parse HTTP requests, enabling
              cache poisoning, credential theft, and security bypass.
            </Typography>
            <TopicAccordion topics={smugglingTopics} defaultExpanded />
          </TabPanel>

          <TabPanel value={tabValue} index={6}>
            <Typography variant="h5" sx={{ fontWeight: 700, mb: 1 }}>
               Testing Workflow and Reporting
            </Typography>
            <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
              Professional pentesting requires structured methodology, safe exploitation, and clear
              communication of findings to stakeholders.
            </Typography>
            <TopicAccordion topics={workflowTopics} defaultExpanded />
          </TabPanel>
        </Box>
      </Paper>

      {/* Modern Web App Targets */}
      <Paper sx={{ mt: 4, p: 4, borderRadius: 3, bgcolor: "#0f1024", border: `1px solid ${alpha("#06b6d4", 0.3)}` }}>
        <Typography variant="h5" sx={{ fontWeight: 700, mb: 1, color: "#e0e0e0" }}>
          Modern Web App Targets
        </Typography>
        <Typography variant="body1" sx={{ color: "grey.400", mb: 3 }}>
          Many web apps depend on APIs, real-time channels, and cloud services. These areas add new attack surface
          beyond classic server-rendered pages.
        </Typography>
        <Grid container spacing={3}>
          {modernTargets.map((target) => (
            <Grid item xs={12} md={6} key={target.title}>
              <Paper
                sx={{
                  p: 2.5,
                  borderRadius: 2,
                  height: "100%",
                  border: `1px solid ${alpha(target.color, 0.2)}`,
                }}
              >
                <Box sx={{ display: "flex", alignItems: "flex-start", gap: 1.5, mb: 1.5 }}>
                  <Box
                    sx={{
                      width: 36,
                      height: 36,
                      borderRadius: 2,
                      bgcolor: alpha(target.color, 0.1),
                      display: "flex",
                      alignItems: "center",
                      justifyContent: "center",
                      color: target.color,
                    }}
                  >
                    {target.icon}
                  </Box>
                  <Box>
                    <Typography variant="subtitle1" sx={{ fontWeight: 700 }}>
                      {target.title}
                    </Typography>
                    <Typography variant="body2" color="text.secondary">
                      {target.description}
                    </Typography>
                  </Box>
                </Box>
                <List dense disablePadding>
                  {target.checks.map((check) => (
                    <ListItem key={check} disableGutters sx={{ py: 0.35 }}>
                      <ListItemIcon sx={{ minWidth: 24 }}>
                        <CheckCircleIcon sx={{ fontSize: 14, color: target.color }} />
                      </ListItemIcon>
                      <ListItemText primary={check} primaryTypographyProps={{ variant: "body2" }} />
                    </ListItem>
                  ))}
                </List>
              </Paper>
            </Grid>
          ))}
        </Grid>
      </Paper>

      {/* Quick Reference */}
      <Paper sx={{ mt: 4, p: 4, borderRadius: 3, bgcolor: "#0f1024", border: `1px solid ${alpha("#f59e0b", 0.3)}` }}>
        <Typography variant="h5" sx={{ fontWeight: 700, mb: 3, color: "#e0e0e0" }}>
          Quick Reference: Testing Checklist
        </Typography>
        <Grid container spacing={3}>
          {[
            {
              phase: "Pre-Engagement",
              items: ["Scope definition", "Authorization docs", "Rules of engagement", "Emergency contacts"],
              color: "#6366f1",
            },
            {
              phase: "Reconnaissance",
              items: ["Subdomain enum", "Tech fingerprint", "Endpoint discovery", "API mapping"],
              color: "#8b5cf6",
            },
            {
              phase: "Authentication",
              items: ["Login bypass", "Session tests", "MFA bypass", "OAuth flows"],
              color: "#3b82f6",
            },
            {
              phase: "Authorization",
              items: ["IDOR tests", "Privilege escalation", "Role bypass", "API authz"],
              color: "#10b981",
            },
            {
              phase: "Injection",
              items: ["SQLi all params", "XSS contexts", "Command injection", "SSTI"],
              color: "#ef4444",
            },
            {
              phase: "Reporting",
              items: ["PoC creation", "Impact assessment", "Remediation advice", "Executive summary"],
              color: "#f59e0b",
            },
          ].map((phase) => (
            <Grid item xs={12} sm={6} md={4} key={phase.phase}>
              <Card
                sx={{
                  height: "100%",
                  borderTop: `4px solid ${phase.color}`,
                  borderRadius: 2,
                }}
              >
                <CardContent>
                  <Typography variant="subtitle1" sx={{ fontWeight: 700, mb: 1.5, color: phase.color }}>
                    {phase.phase}
                  </Typography>
                  {phase.items.map((item) => (
                    <Box key={item} sx={{ display: "flex", alignItems: "center", gap: 1, mb: 0.5 }}>
                      <Box
                        sx={{
                          width: 16,
                          height: 16,
                          border: `2px solid ${alpha(phase.color, 0.3)}`,
                          borderRadius: 0.5,
                        }}
                      />
                      <Typography variant="body2">{item}</Typography>
                    </Box>
                  ))}
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </Paper>

      {/* Resources */}
      <Paper sx={{ mt: 4, p: 4, borderRadius: 3, bgcolor: "#0f1024", border: `1px solid ${alpha("#3b82f6", 0.3)}` }}>
        <Typography variant="h5" sx={{ fontWeight: 700, mb: 3, color: "#e0e0e0", display: "flex", alignItems: "center", gap: 2 }}>
          <DescriptionIcon sx={{ color: "#3b82f6" }} />
          Essential Resources
        </Typography>
        <Grid container spacing={2}>
          {[
            { name: "OWASP Testing Guide", url: "https://owasp.org/www-project-web-security-testing-guide/", desc: "Comprehensive web security testing methodology", color: "#ef4444" },
            { name: "PortSwigger Web Security Academy", url: "https://portswigger.net/web-security", desc: "Free interactive labs for all attack types", color: "#f59e0b" },
            { name: "HackTricks", url: "https://book.hacktricks.xyz/", desc: "Practical hacking tricks and techniques", color: "#22c55e" },
            { name: "PayloadsAllTheThings", url: "https://github.com/swisskyrepo/PayloadsAllTheThings", desc: "Payload collections for various attacks", color: "#8b5cf6" },
            { name: "OWASP Cheat Sheet Series", url: "https://cheatsheetseries.owasp.org/", desc: "Quick reference for secure development", color: "#06b6d4" },
            { name: "Bug Bounty Hunting Essentials", url: "https://www.bugcrowd.com/hackers/bugcrowd-university/", desc: "Bug bounty methodology and tips", color: "#ec4899" },
          ].map((resource) => (
            <Grid item xs={12} sm={6} key={resource.name}>
              <Paper
                sx={{
                  p: 2,
                  borderRadius: 2,
                  bgcolor: alpha(resource.color, 0.08),
                  border: `1px solid ${alpha(resource.color, 0.2)}`,
                  cursor: "pointer",
                  transition: "all 0.2s",
                  "&:hover": {
                    borderColor: resource.color,
                    transform: "translateY(-2px)",
                  },
                }}
                onClick={() => window.open(resource.url, "_blank")}
              >
                <Typography variant="subtitle2" sx={{ fontWeight: 700, color: resource.color }}>
                  {resource.name} 
                </Typography>
                <Typography variant="body2" sx={{ color: "grey.400" }}>
                  {resource.desc}
                </Typography>
              </Paper>
            </Grid>
          ))}
        </Grid>
      </Paper>

      {/* Related Learning Pages */}
      <Paper
        sx={{
          p: 4,
          mt: 4,
          borderRadius: 3,
          bgcolor: "#0f1024",
          border: `1px solid ${alpha("#8b5cf6", 0.3)}`,
        }}
      >
        <Typography variant="h5" sx={{ fontWeight: 700, color: "#e0e0e0", mb: 3, display: "flex", alignItems: "center", gap: 2 }}>
          <AssignmentIcon sx={{ color: "#8b5cf6" }} />
          Related Learning Topics
        </Typography>

        <Grid container spacing={2}>
          {[
            {
              title: "SQL Injection Guide",
              desc: "Deep dive into SQL injection techniques, detection, and prevention",
              link: "/learn/sql-injection",
              color: "#ef4444",
              icon: <StorageIcon />,
            },
            {
              title: "XSS Attack Guide",
              desc: "Cross-site scripting fundamentals, payloads, and remediation",
              link: "/learn/xss",
              color: "#f59e0b",
              icon: <JavascriptIcon />,
            },
            {
              title: "Command Injection",
              desc: "OS command injection techniques and secure coding practices",
              link: "/learn/command-injection",
              color: "#22c55e",
              icon: <TerminalIcon />,
            },
            {
              title: "OWASP Top 10",
              desc: "Understanding the most critical web application security risks",
              link: "/learn/owasp-top-10",
              color: "#8b5cf6",
              icon: <SecurityIcon />,
            },
            {
              title: "API Testing Guide",
              desc: "REST and GraphQL API security testing methodology",
              link: "/learn/api-testing",
              color: "#06b6d4",
              icon: <HttpIcon />,
            },
            {
              title: "Burp Suite Mastery",
              desc: "Advanced techniques for the industry-standard web proxy",
              link: "/learn/burp-suite",
              color: "#ec4899",
              icon: <BugReportIcon />,
            },
          ].map((item) => (
            <Grid item xs={12} sm={6} md={4} key={item.title}>
              <Card
                component={Link}
                to={item.link}
                sx={{
                  height: "100%",
                  bgcolor: alpha(item.color, 0.08),
                  border: `1px solid ${alpha(item.color, 0.2)}`,
                  borderRadius: 2,
                  textDecoration: "none",
                  transition: "all 0.2s",
                  "&:hover": {
                    bgcolor: alpha(item.color, 0.15),
                    borderColor: item.color,
                    transform: "translateY(-2px)",
                  },
                }}
              >
                <CardContent>
                  <Box sx={{ display: "flex", alignItems: "center", gap: 1.5, mb: 1.5 }}>
                    <Box sx={{ color: item.color }}>{item.icon}</Box>
                    <Typography variant="subtitle1" sx={{ fontWeight: 700, color: "#e0e0e0" }}>
                      {item.title}
                    </Typography>
                  </Box>
                  <Typography variant="body2" sx={{ color: "grey.400" }}>
                    {item.desc}
                  </Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </Paper>

      {/* Quiz Section */}
      <Box id="quiz" sx={{ mt: 4 }}>
        <QuizSection
          questions={quizPool}
          accentColor={ACCENT_COLOR}
          title="Web App Pentesting Knowledge Check"
          description="Random 10-question quiz drawn from a 75-question bank each time the page loads."
          questionsPerQuiz={QUIZ_QUESTION_COUNT}
        />
      </Box>

      {/* Bottom Navigation */}
      <Box sx={{ mt: 4, textAlign: "center" }}>
        <Button
          variant="outlined"
          startIcon={<ArrowBackIcon />}
          onClick={() => navigate("/learn")}
          sx={{ borderColor: "#ef4444", color: "#ef4444", "&:hover": { bgcolor: alpha("#ef4444", 0.1), borderColor: "#f87171" } }}
        >
          Back to Learning Hub
        </Button>
      </Box>
      </Container>
    </Box>
    </LearnPageLayout>
  );
}
