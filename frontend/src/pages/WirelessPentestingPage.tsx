import React, { useState } from "react";
import { Link } from "react-router-dom";
import {
  Box,
  Typography,
  Paper,
  Tabs,
  Tab,
  Grid,
  Card,
  CardContent,
  Chip,
  List,
  ListItem,
  ListItemIcon,
  ListItemText,
  Accordion,
  AccordionSummary,
  AccordionDetails,
  Alert,
  AlertTitle,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  Divider,
  Stepper,
  Step,
  StepLabel,
  StepContent,
  Button,
} from "@mui/material";
import ArrowBackIcon from "@mui/icons-material/ArrowBack";
import ExpandMoreIcon from "@mui/icons-material/ExpandMore";
import WifiIcon from "@mui/icons-material/Wifi";
import SecurityIcon from "@mui/icons-material/Security";
import RouterIcon from "@mui/icons-material/Router";
import DevicesIcon from "@mui/icons-material/Devices";
import BuildIcon from "@mui/icons-material/Build";
import BugReportIcon from "@mui/icons-material/BugReport";
import ShieldIcon from "@mui/icons-material/Shield";
import WarningIcon from "@mui/icons-material/Warning";
import BluetoothIcon from "@mui/icons-material/Bluetooth";
import SettingsInputAntennaIcon from "@mui/icons-material/SettingsInputAntenna";
import LockIcon from "@mui/icons-material/Lock";
import LockOpenIcon from "@mui/icons-material/LockOpen";
import RadarIcon from "@mui/icons-material/Radar";
import PhoneAndroidIcon from "@mui/icons-material/PhoneAndroid";
import ComputerIcon from "@mui/icons-material/Computer";
import BusinessIcon from "@mui/icons-material/Business";
import HomeIcon from "@mui/icons-material/Home";
import PublicIcon from "@mui/icons-material/Public";
import SpeedIcon from "@mui/icons-material/Speed";
import VisibilityIcon from "@mui/icons-material/Visibility";
import GavelIcon from "@mui/icons-material/Gavel";
import TimerIcon from "@mui/icons-material/Timer";
import CheckCircleIcon from "@mui/icons-material/CheckCircle";
import ErrorIcon from "@mui/icons-material/Error";
import InfoIcon from "@mui/icons-material/Info";
import TerminalIcon from "@mui/icons-material/Terminal";
import StorageIcon from "@mui/icons-material/Storage";
import SignalWifi4BarIcon from "@mui/icons-material/SignalWifi4Bar";
import NetworkCheckIcon from "@mui/icons-material/NetworkCheck";
import LearnPageLayout from "../components/LearnPageLayout";

// Simple code block component
const CodeBlock: React.FC<{ children: string; title?: string }> = ({ children, title }) => (
  <Paper sx={{ p: 2, bgcolor: "#1e1e1e", borderRadius: 1, my: 2, overflow: "auto" }}>
    {title && (
      <Typography variant="caption" sx={{ color: "#888", display: "block", mb: 1 }}>
        {title}
      </Typography>
    )}
    <Typography
      component="pre"
      sx={{
        fontFamily: "monospace",
        fontSize: "0.85rem",
        color: "#d4d4d4",
        whiteSpace: "pre-wrap",
        wordBreak: "break-word",
        m: 0,
      }}
    >
      {children}
    </Typography>
  </Paper>
);

interface TabPanelProps {
  children?: React.ReactNode;
  index: number;
  value: number;
}

function TabPanel(props: TabPanelProps) {
  const { children, value, index, ...other } = props;
  return (
    <div role="tabpanel" hidden={value !== index} {...other}>
      {value === index && <Box sx={{ p: 3 }}>{children}</Box>}
    </div>
  );
}

// =============================================================================
// DATA ARRAYS - To be expanded later
// =============================================================================

const wifiStandards = [
  { standard: "802.11a", frequency: "5 GHz", maxSpeed: "54 Mbps", year: 1999, status: "Legacy" },
  { standard: "802.11b", frequency: "2.4 GHz", maxSpeed: "11 Mbps", year: 1999, status: "Legacy" },
  { standard: "802.11g", frequency: "2.4 GHz", maxSpeed: "54 Mbps", year: 2003, status: "Legacy" },
  { standard: "802.11n (Wi-Fi 4)", frequency: "2.4/5 GHz", maxSpeed: "600 Mbps", year: 2009, status: "Common" },
  { standard: "802.11ac (Wi-Fi 5)", frequency: "5 GHz", maxSpeed: "6.9 Gbps", year: 2013, status: "Common" },
  { standard: "802.11ax (Wi-Fi 6)", frequency: "2.4/5/6 GHz", maxSpeed: "9.6 Gbps", year: 2019, status: "Current" },
  { standard: "802.11be (Wi-Fi 7)", frequency: "2.4/5/6 GHz", maxSpeed: "46 Gbps", year: 2024, status: "Emerging" },
];

const securityProtocols = [
  { protocol: "WEP", year: 1997, security: "Broken", description: "Wired Equivalent Privacy - easily cracked in minutes", crackTime: "< 5 minutes", keyLength: "40/104-bit" },
  { protocol: "WPA", year: 2003, security: "Weak", description: "Wi-Fi Protected Access - TKIP vulnerable to attacks", crackTime: "Hours-Days", keyLength: "128-bit TKIP" },
  { protocol: "WPA2-Personal", year: 2004, security: "Moderate", description: "AES encryption, vulnerable to KRACK and dictionary attacks", crackTime: "Depends on PSK", keyLength: "128-bit AES" },
  { protocol: "WPA2-Enterprise", year: 2004, security: "Strong", description: "802.1X authentication with RADIUS server", crackTime: "Very difficult", keyLength: "128-bit AES" },
  { protocol: "WPA3-Personal", year: 2018, security: "Strong", description: "SAE (Dragonfly) handshake, forward secrecy", crackTime: "Extremely difficult", keyLength: "128-bit AES" },
  { protocol: "WPA3-Enterprise", year: 2018, security: "Very Strong", description: "192-bit security suite, enhanced protection", crackTime: "Not practical", keyLength: "192-bit AES" },
];

const protocolDetails = [
  {
    name: "WEP (Wired Equivalent Privacy)",
    status: "error",
    year: "1997",
    summary: "The original WiFi security protocol, now completely broken and should never be used.",
    vulnerabilities: [
      "24-bit Initialization Vector (IV) is too short - only ~16 million combinations",
      "IVs are transmitted in plaintext and reused frequently",
      "RC4 stream cipher has known weaknesses",
      "No protection against replay attacks",
      "CRC-32 checksum is not cryptographically secure",
    ],
    attacks: [
      { name: "PTW Attack", desc: "Crack WEP in under 60 seconds with enough IVs" },
      { name: "FMS Attack", desc: "Statistical attack exploiting weak IVs" },
      { name: "ChopChop", desc: "Decrypt packets one byte at a time" },
      { name: "Fragmentation", desc: "Obtain keystream from a single packet" },
      { name: "Caffe-Latte", desc: "Attack client without AP using gratuitous ARP" },
    ],
    commands: `# Enable monitor mode
airmon-ng start wlan0

# Capture packets (target channel 6)
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon

# Generate traffic (ARP replay)
aireplay-ng -3 -b AA:BB:CC:DD:EE:FF wlan0mon

# Crack the key (need ~40,000 IVs)
aircrack-ng capture-01.cap`,
  },
  {
    name: "WPA/WPA2-Personal (PSK)",
    status: "warning",
    year: "2003/2004",
    summary: "Pre-Shared Key mode used in homes and small businesses. Security depends on password strength.",
    vulnerabilities: [
      "Susceptible to offline dictionary attacks if handshake captured",
      "KRACK attack (2017) - Key Reinstallation Attack",
      "PMKID attack allows cracking without full handshake",
      "Weak passwords can be cracked in minutes",
      "No forward secrecy - captured traffic can be decrypted later",
    ],
    attacks: [
      { name: "4-Way Handshake Capture", desc: "Capture authentication exchange for offline cracking" },
      { name: "PMKID Attack", desc: "Extract PMKID from first EAPOL frame (no client needed)" },
      { name: "Dictionary Attack", desc: "Test captured handshake against wordlist" },
      { name: "KRACK Attack", desc: "Force nonce reuse to decrypt/inject traffic" },
      { name: "Deauth + Capture", desc: "Force reconnection to capture fresh handshake" },
    ],
    commands: `# Capture handshake
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w handshake wlan0mon

# Deauth client to force reconnection
aireplay-ng -0 5 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:66 wlan0mon

# Crack with dictionary
aircrack-ng -w rockyou.txt handshake-01.cap

# PMKID capture with hcxdumptool
hcxdumptool -i wlan0mon -o pmkid.pcapng --enable_status=1

# Convert and crack PMKID
hcxpcapngtool -o hash.22000 pmkid.pcapng
hashcat -m 22000 hash.22000 wordlist.txt`,
  },
  {
    name: "WPA2-Enterprise (802.1X)",
    status: "info",
    year: "2004",
    summary: "Uses RADIUS server for authentication. Each user has unique credentials.",
    vulnerabilities: [
      "Rogue AP can capture credentials if certificate validation bypassed",
      "Some EAP methods transmit identity in cleartext",
      "PEAP/MSCHAPv2 credentials can be cracked offline",
      "Improper certificate validation common in mobile devices",
      "Legacy EAP methods (LEAP) are broken",
    ],
    attacks: [
      { name: "Evil Twin + hostapd-wpe", desc: "Capture enterprise credentials via rogue AP" },
      { name: "EAP Downgrade", desc: "Force client to use weaker authentication" },
      { name: "MSCHAPv2 Cracking", desc: "Offline attack on captured challenge/response" },
      { name: "Certificate Impersonation", desc: "Exploit missing or weak cert validation" },
      { name: "Identity Harvesting", desc: "Collect usernames from EAP identity responses" },
    ],
    commands: `# Setup evil twin with hostapd-wpe
# Edit hostapd-wpe.conf with target SSID
hostapd-wpe hostapd-wpe.conf

# Captured credentials appear in hostapd-wpe.log
# Format: username:challenge:response

# Crack MSCHAPv2 with asleap
asleap -C <challenge> -R <response> -W wordlist.txt

# Or use hashcat (mode 5500)
hashcat -m 5500 captured_hash.txt wordlist.txt`,
  },
  {
    name: "WPA3 & SAE",
    status: "success",
    year: "2018",
    summary: "Latest security standard using Simultaneous Authentication of Equals (SAE/Dragonfly).",
    vulnerabilities: [
      "Dragonblood vulnerabilities (CVE-2019-9494 to 9499)",
      "Side-channel attacks on SAE handshake",
      "Downgrade attacks to WPA2 on transition networks",
      "Implementation bugs in early deployments",
      "Still vulnerable if WPA3-Transition mode enabled",
    ],
    attacks: [
      { name: "Dragonblood", desc: "Timing and cache-based side-channel attacks" },
      { name: "Downgrade Attack", desc: "Force WPA2 mode on mixed networks" },
      { name: "DoS via SAE", desc: "Resource exhaustion with SAE commit messages" },
      { name: "Group Downgrade", desc: "Force weaker elliptic curve groups" },
    ],
    commands: `# WPA3 testing requires specific tools
# Dragonblood proof-of-concept
git clone https://github.com/vanhoefm/dragonslayer
cd dragonslayer

# Test for timing side-channel
./dragontime -i wlan0 -s "TargetSSID"

# Test for cache side-channel (requires local access)
./dragondrain -i wlan0 -s "TargetSSID"`,
  },
  {
    name: "WPS (WiFi Protected Setup)",
    status: "error",
    year: "2006",
    summary: "Designed for easy setup, but PIN-based authentication is fundamentally flawed.",
    vulnerabilities: [
      "8-digit PIN split into two halves verified separately",
      "Only 11,000 combinations to bruteforce (not 100 million)",
      "Pixie Dust attack can crack instantly if weak random numbers",
      "Many routers don't implement lockout properly",
      "Some routers have WPS enabled by default with no way to disable",
    ],
    attacks: [
      { name: "Online Bruteforce", desc: "Try all 11,000 PIN combinations" },
      { name: "Pixie Dust", desc: "Exploit weak random number generation" },
      { name: "Pin Null Attack", desc: "Some APs accept empty PIN" },
      { name: "WPS Lockout Bypass", desc: "Exploit rate limiting implementation flaws" },
    ],
    commands: `# Check if WPS is enabled
wash -i wlan0mon

# Pixie Dust attack (instant if vulnerable)
reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -K 1 -vv

# Standard bruteforce (can take hours)
reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -vv

# Using Bully
bully -b AA:BB:CC:DD:EE:FF -c 6 wlan0mon`,
  },
];

const attackTypes = [
  {
    category: "Reconnaissance",
    icon: <RadarIcon />,
    description: "The first phase of any wireless assessment - discovering and mapping target networks.",
    attacks: [
      { name: "Passive Scanning", description: "Listen for beacon frames and probe requests without transmitting", difficulty: "Easy", detectability: "Undetectable" },
      { name: "Active Scanning", description: "Send probe requests to discover hidden networks", difficulty: "Easy", detectability: "Low" },
      { name: "War Driving", description: "Map wireless networks while moving through an area with GPS logging", difficulty: "Easy", detectability: "Undetectable" },
      { name: "War Walking", description: "On-foot wireless network discovery for building surveys", difficulty: "Easy", detectability: "Undetectable" },
      { name: "Drone Recon", description: "Aerial wireless reconnaissance for large facilities", difficulty: "Medium", detectability: "Undetectable" },
    ],
  },
  {
    category: "Cracking Attacks",
    icon: <LockOpenIcon />,
    description: "Attacks focused on recovering wireless network keys and passwords.",
    attacks: [
      { name: "WEP IV Attack", description: "Collect IVs to crack WEP key - guaranteed success with enough packets", difficulty: "Easy", detectability: "Low" },
      { name: "WPA/WPA2 Dictionary", description: "Capture handshake then crack offline against wordlist", difficulty: "Medium", detectability: "Low" },
      { name: "PMKID Attack", description: "Extract PMKID from AP without needing a client - single packet!", difficulty: "Easy", detectability: "Very Low" },
      { name: "WPS PIN Bruteforce", description: "Exploit weak WPS implementation - only 11,000 PINs possible", difficulty: "Easy", detectability: "Medium" },
      { name: "Pixie Dust", description: "Instant WPS crack exploiting weak random number generation", difficulty: "Easy", detectability: "Low" },
      { name: "Rainbow Tables", description: "Precomputed hash tables for top 1000 SSIDs", difficulty: "Easy", detectability: "None" },
      { name: "GPU Cracking", description: "Hashcat with RTX 4090 can test 2.5M+ WPA passwords/sec", difficulty: "Medium", detectability: "None" },
    ],
  },
  {
    category: "Man-in-the-Middle",
    icon: <DevicesIcon />,
    description: "Position yourself between clients and legitimate access points to intercept traffic.",
    attacks: [
      { name: "Evil Twin", description: "Clone target AP's SSID/BSSID to intercept connections", difficulty: "Medium", detectability: "Medium" },
      { name: "Karma Attack", description: "Respond to ALL probe requests - catch any device looking for known networks", difficulty: "Easy", detectability: "High" },
      { name: "MANA Attack", description: "Enhanced Karma with loud mode for maximum client capture", difficulty: "Easy", detectability: "High" },
      { name: "HTTPS Stripping", description: "Downgrade secure connections to HTTP for credential capture", difficulty: "Medium", detectability: "Low" },
      { name: "Captive Portal", description: "Fake login pages mimicking corporate portals or social sites", difficulty: "Medium", detectability: "Medium" },
      { name: "DNS Hijacking", description: "Redirect DNS queries to malicious servers", difficulty: "Medium", detectability: "Medium" },
    ],
  },
  {
    category: "Denial of Service",
    icon: <WarningIcon />,
    description: "Disrupt wireless network availability - often used to force client reconnections.",
    attacks: [
      { name: "Deauthentication Flood", description: "Forge deauth frames to disconnect all clients", difficulty: "Easy", detectability: "High" },
      { name: "Disassociation Attack", description: "Break client-AP association without full deauth", difficulty: "Easy", detectability: "High" },
      { name: "Beacon Flood", description: "Create thousands of fake networks to overwhelm clients", difficulty: "Easy", detectability: "High" },
      { name: "Authentication Flood", description: "Exhaust AP's authentication table capacity", difficulty: "Easy", detectability: "High" },
      { name: "CTS Flood", description: "Abuse Clear-to-Send frames to silence the channel", difficulty: "Medium", detectability: "Medium" },
      { name: "RTS Flood", description: "Abuse Request-to-Send to reserve channel continuously", difficulty: "Medium", detectability: "Medium" },
    ],
  },
  {
    category: "Client Attacks",
    icon: <PhoneAndroidIcon />,
    description: "Target individual client devices rather than access points.",
    attacks: [
      { name: "Probe Request Tracking", description: "Identify and track devices by their probe requests", difficulty: "Easy", detectability: "Undetectable" },
      { name: "Rogue AP Association", description: "Lure clients to connect to your malicious access point", difficulty: "Medium", detectability: "Medium" },
      { name: "Hotspot Honeypot", description: "Free WiFi trap in public spaces for credential theft", difficulty: "Easy", detectability: "Low" },
      { name: "MAC Spoofing", description: "Impersonate authorized client to bypass MAC filtering", difficulty: "Easy", detectability: "Low" },
      { name: "WiFi Direct Attacks", description: "Exploit peer-to-peer WiFi connections on devices", difficulty: "Medium", detectability: "Low" },
      { name: "Probe Response Injection", description: "Send fake probe responses to manipulate client behavior", difficulty: "Medium", detectability: "Low" },
    ],
  },
];

const tools = [
  {
    category: "Wireless Adapters",
    description: "Hardware with chipsets that support monitor mode and packet injection",
    items: [
      { name: "Alfa AWUS036ACH", description: "Dual-band AC1200, Realtek RTL8812AU, excellent for modern networks", type: "Hardware", chipset: "RTL8812AU", bands: "2.4/5 GHz" },
      { name: "Alfa AWUS036ACHM", description: "Mediatek MT7612U, better driver support on newer kernels", type: "Hardware", chipset: "MT7612U", bands: "2.4/5 GHz" },
      { name: "Alfa AWUS036ACM", description: "AC1200 with Mediatek chipset, excellent range with antennas", type: "Hardware", chipset: "MT7612U", bands: "2.4/5 GHz" },
      { name: "TP-Link TL-WN722N v1", description: "Budget classic - ONLY version 1 works (Atheros AR9271)", type: "Hardware", chipset: "AR9271", bands: "2.4 GHz" },
      { name: "Panda PAU09", description: "Dual-band with Ralink chipset, good Linux support", type: "Hardware", chipset: "RT5572", bands: "2.4/5 GHz" },
      { name: "Alfa AWUS1900", description: "AC1900 4x4 MIMO, maximum range and throughput", type: "Hardware", chipset: "RTL8814AU", bands: "2.4/5 GHz" },
    ],
  },
  {
    category: "Scanning & Discovery",
    description: "Tools for finding and mapping wireless networks",
    items: [
      { name: "Aircrack-ng Suite", description: "The gold standard - includes airmon-ng, airodump-ng, aireplay-ng, aircrack-ng", type: "Software", platform: "Linux/Windows" },
      { name: "Kismet", description: "Wireless detector, sniffer, WIDS - supports WiFi, Bluetooth, SDR", type: "Software", platform: "Linux" },
      { name: "Wireshark", description: "Deep packet analysis with 802.11 dissectors and filters", type: "Software", platform: "Cross-platform" },
      { name: "WiFite2", description: "Automated wireless auditing - runs multiple attacks automatically", type: "Software", platform: "Linux" },
      { name: "LinSSID", description: "Graphical WiFi scanner showing signal strength over time", type: "Software", platform: "Linux" },
      { name: "inSSIDer", description: "Professional site survey tool with spectrum analysis", type: "Software", platform: "Windows" },
    ],
  },
  {
    category: "Attack Tools",
    description: "Core tools for executing wireless attacks",
    items: [
      { name: "airmon-ng", description: "Enable/disable monitor mode on wireless interfaces", type: "Software", usage: "airmon-ng start wlan0" },
      { name: "airodump-ng", description: "Capture 802.11 frames, display nearby networks and clients", type: "Software", usage: "airodump-ng -c 6 wlan0mon" },
      { name: "aireplay-ng", description: "Inject packets: deauth, fake auth, ARP replay, chopchop", type: "Software", usage: "aireplay-ng -0 5 -a BSSID wlan0mon" },
      { name: "aircrack-ng", description: "WEP/WPA key cracking engine with dictionary support", type: "Software", usage: "aircrack-ng -w wordlist.txt capture.cap" },
      { name: "hcxdumptool", description: "Capture PMKID and full EAPOL handshakes efficiently", type: "Software", usage: "hcxdumptool -i wlan0mon -o dump.pcapng" },
      { name: "hcxpcapngtool", description: "Convert captures to hashcat/JtR format", type: "Software", usage: "hcxpcapngtool -o hash.22000 dump.pcapng" },
    ],
  },
  {
    category: "Evil Twin & MITM",
    description: "Create rogue access points and intercept traffic",
    items: [
      { name: "hostapd", description: "Create software access points with full configuration control", type: "Software", platform: "Linux" },
      { name: "hostapd-wpe", description: "Modified hostapd for WPA-Enterprise credential capture", type: "Software", platform: "Linux" },
      { name: "Fluxion", description: "Automated evil twin + captive portal for WPA key phishing", type: "Software", platform: "Linux" },
      { name: "WiFi-Pumpkin3", description: "Full MITM framework with plugins for credential capture", type: "Software", platform: "Linux" },
      { name: "Bettercap", description: "Swiss army knife for network attacks, including WiFi", type: "Software", platform: "Cross-platform" },
      { name: "EAPHammer", description: "Targeted evil twin attacks against WPA-Enterprise", type: "Software", platform: "Linux" },
    ],
  },
  {
    category: "WPS & Specialized",
    description: "Tools for WPS attacks and specialized scenarios",
    items: [
      { name: "Reaver", description: "WPS PIN bruteforce with Pixie Dust support (-K flag)", type: "Software", usage: "reaver -i wlan0mon -b BSSID -K 1" },
      { name: "Bully", description: "Alternative WPS bruteforce, sometimes works when Reaver doesn't", type: "Software", usage: "bully -b BSSID -c 6 wlan0mon" },
      { name: "PixieWPS", description: "Standalone Pixie Dust implementation for offline WPS cracking", type: "Software", platform: "Linux" },
      { name: "Wash", description: "Scan for WPS-enabled access points and check lock status", type: "Software", usage: "wash -i wlan0mon" },
      { name: "mdk4", description: "Wireless attack toolkit: beacon flood, deauth, WDS confusion", type: "Software", platform: "Linux" },
      { name: "Airgeddon", description: "Multi-use bash script combining many wireless tools", type: "Software", platform: "Linux" },
    ],
  },
  {
    category: "Password Cracking",
    description: "Offline cracking of captured handshakes",
    items: [
      { name: "Hashcat", description: "GPU-accelerated cracking - mode 22000 for WPA, 22001 for PMKID", type: "Software", platform: "Cross-platform" },
      { name: "John the Ripper", description: "CPU cracking with rules, good for slow hashes", type: "Software", platform: "Cross-platform" },
      { name: "coWPAtty", description: "WPA-PSK dictionary attack with rainbow table support", type: "Software", platform: "Linux" },
      { name: "Pyrit", description: "WPA cracking with GPU and precomputation database", type: "Software", platform: "Linux" },
    ],
  },
];

const bluetoothAttacks = [
  { name: "BlueBorne", description: "Remote code execution via Bluetooth stack vulnerabilities (CVE-2017-0781)", severity: "Critical", year: 2017 },
  { name: "Bluejacking", description: "Sending unsolicited messages via OBEX Push", severity: "Low", year: 2003 },
  { name: "Bluesnarfing", description: "Unauthorized access to contacts, calendars, messages", severity: "High", year: 2003 },
  { name: "BlueSmacking", description: "Bluetooth L2CAP ping flood causing DoS", severity: "Medium", year: 2003 },
  { name: "KNOB Attack", description: "Key Negotiation of Bluetooth - force 1-byte entropy key", severity: "High", year: 2019 },
  { name: "BIAS Attack", description: "Bluetooth Impersonation AttackS - impersonate paired devices", severity: "High", year: 2020 },
  { name: "BlueFrag", description: "Android Bluetooth RCE via malformed L2CAP packets", severity: "Critical", year: 2020 },
  { name: "BrakTooth", description: "Family of 16 BT Classic vulnerabilities affecting billions of devices", severity: "Critical", year: 2021 },
  { name: "BLE Sniffing", description: "Capture Bluetooth Low Energy advertising and connections", severity: "Medium", year: "Ongoing" },
  { name: "GATT Attacks", description: "Exploit misconfigured BLE services and characteristics", severity: "Variable", year: "Ongoing" },
];

const bluetoothTools = [
  { name: "hcitool", description: "Configure Bluetooth connections and devices", platform: "Linux" },
  { name: "Ubertooth One", description: "Open source 2.4GHz wireless platform for BT sniffing", platform: "Hardware" },
  { name: "Bettercap", description: "BLE enumeration and MITM capabilities", platform: "Cross-platform" },
  { name: "Bluez", description: "Official Linux Bluetooth stack with testing tools", platform: "Linux" },
  { name: "BTLE-Sniffer", description: "Passive BLE advertisement capture", platform: "Linux" },
  { name: "GATTacker", description: "MITM framework for BLE devices", platform: "Node.js" },
  { name: "Crackle", description: "Crack BLE encryption from captured traffic", platform: "Linux" },
];

const rfProtocols = [
  { protocol: "Zigbee", frequency: "2.4 GHz", use: "IoT, Smart Home", security: "AES-128", vulnerabilities: "Key extraction, replay attacks, default keys" },
  { protocol: "Z-Wave", frequency: "908 MHz (US)", use: "Home Automation", security: "AES-128", vulnerabilities: "S0 downgrade, network key interception" },
  { protocol: "LoRa/LoRaWAN", frequency: "Various (ISM bands)", use: "Long-range IoT, sensors", security: "AES-128", vulnerabilities: "Replay attacks, join procedure exploitation" },
  { protocol: "NFC", frequency: "13.56 MHz", use: "Payments, Access Cards", security: "Variable", vulnerabilities: "Relay attacks, weak MIFARE Classic crypto" },
  { protocol: "RFID LF", frequency: "125 kHz", use: "Access Cards, Tracking", security: "Often none", vulnerabilities: "Easy cloning, no encryption on many cards" },
  { protocol: "RFID HF", frequency: "13.56 MHz", use: "Passports, Transit", security: "Variable", vulnerabilities: "Depends on implementation" },
  { protocol: "Sub-GHz", frequency: "315/433/868 MHz", use: "Car fobs, Remotes", security: "Often none", vulnerabilities: "Replay attacks, rolling code weaknesses" },
  { protocol: "Thread", frequency: "2.4 GHz", use: "Smart Home (Matter)", security: "DTLS + AES-128", vulnerabilities: "Relatively new, few known attacks" },
];

const enterpriseTopics = [
  { topic: "802.1X Authentication", description: "Port-based network access control - the foundation of enterprise wireless", icon: <LockIcon /> },
  { topic: "RADIUS Server", description: "Remote Authentication Dial-In User Service - centralized AAA", icon: <StorageIcon /> },
  { topic: "EAP Methods", description: "EAP-TLS (certs both sides), EAP-TTLS, PEAP (server cert only), EAP-FAST", icon: <SecurityIcon /> },
  { topic: "Certificate Management", description: "PKI infrastructure, CA hierarchy, client cert distribution", icon: <LockIcon /> },
  { topic: "Network Segmentation", description: "Dynamic VLAN assignment based on user/device attributes", icon: <NetworkCheckIcon /> },
  { topic: "Wireless IDS/IPS", description: "Detect rogue APs, deauth floods, evil twins in real-time", icon: <ShieldIcon /> },
  { topic: "NAC Integration", description: "802.1X + posture assessment for endpoint compliance", icon: <DevicesIcon /> },
  { topic: "MDM Integration", description: "Mobile Device Management for certificate provisioning", icon: <PhoneAndroidIcon /> },
];

const eapMethods = [
  { method: "EAP-TLS", security: "Highest", description: "Mutual certificate authentication - client and server certs", deployment: "Complex", vulnerability: "Certificate management overhead" },
  { method: "EAP-TTLS", security: "High", description: "Server cert creates tunnel, inner auth (PAP, CHAP, MSCHAPv2)", deployment: "Medium", vulnerability: "Inner credentials can be captured" },
  { method: "PEAP", security: "High", description: "Similar to TTLS, Microsoft-backed, MSCHAPv2 common inside", deployment: "Easy", vulnerability: "MSCHAPv2 offline cracking possible" },
  { method: "EAP-FAST", security: "High", description: "Cisco proprietary, uses Protected Access Credentials", deployment: "Medium", vulnerability: "PAC provisioning can be exploited" },
  { method: "LEAP", security: "Broken", description: "Cisco legacy - MS-CHAPv1 based, easily cracked", deployment: "Easy", vulnerability: "Offline dictionary attack in seconds" },
];

const enterpriseAttacks = [
  { attack: "Evil Twin + hostapd-wpe", description: "Impersonate corporate SSID to capture enterprise credentials via fake RADIUS", difficulty: "Medium", impact: "High" },
  { attack: "EAP Downgrade", description: "Force client to use weaker EAP method by advertising different capabilities", difficulty: "Medium", impact: "High" },
  { attack: "Certificate Impersonation", description: "Many clients skip certificate validation - present any cert", difficulty: "Easy", impact: "High" },
  { attack: "MSCHAPv2 Offline Cracking", description: "Captured challenge/response cracked with dictionary attack", difficulty: "Easy", impact: "High" },
  { attack: "RADIUS Impersonation", description: "If shared secret weak, impersonate RADIUS to approve any auth", difficulty: "Hard", impact: "Critical" },
  { attack: "Guest Network Pivoting", description: "Escape guest VLAN isolation via misconfigurations", difficulty: "Medium", impact: "Medium" },
  { attack: "Rogue AP Detection Bypass", description: "Evade WIDS by mimicking legitimate AP characteristics", difficulty: "Hard", impact: "Medium" },
  { attack: "GTC Password Capture", description: "If EAP-GTC used, passwords transmitted in cleartext in tunnel", difficulty: "Easy", impact: "Critical" },
];

const defenseStrategies = [
  { strategy: "Strong Encryption", description: "WPA3-Enterprise or WPA2-Enterprise with EAP-TLS minimum", priority: "Critical", implementation: "Upgrade APs, configure RADIUS" },
  { strategy: "Complex Passwords", description: "20+ character random PSKs for any personal networks", priority: "Critical", implementation: "Password manager, regular rotation" },
  { strategy: "Disable WPS", description: "Remove PIN-based authentication attack surface completely", priority: "High", implementation: "AP configuration, verify with wash scan" },
  { strategy: "Certificate Pinning", description: "Clients must validate specific server certificate", priority: "High", implementation: "MDM policy, supplicant configuration" },
  { strategy: "Network Segmentation", description: "Separate guest, IoT, BYOD, and corporate traffic via VLANs", priority: "High", implementation: "Dynamic VLAN assignment via RADIUS" },
  { strategy: "Wireless IDS/IPS", description: "24/7 monitoring for rogue APs, deauth attacks, evil twins", priority: "High", implementation: "Dedicated sensors or AP-integrated" },
  { strategy: "Regular Audits", description: "Quarterly penetration testing of wireless infrastructure", priority: "Medium", implementation: "Internal or third-party assessments" },
  { strategy: "Client Isolation", description: "Prevent direct client-to-client communication on same AP", priority: "Medium", implementation: "AP configuration, guest network default" },
  { strategy: "MAC Randomization Awareness", description: "Understand that MAC filtering is security theater", priority: "Low", implementation: "Don't rely on MAC-based controls" },
  { strategy: "Deauth Protection", description: "802.11w (PMF) to protect management frames", priority: "High", implementation: "Enable MFP on AP and require on clients" },
];

const certifications = [
  { cert: "OSWP", org: "OffSec", description: "OffSec Wireless Professional - hands-on wireless pentesting", difficulty: "Intermediate", focus: "Practical attacks" },
  { cert: "CWNA", org: "CWNP", description: "Certified Wireless Network Administrator - foundation", difficulty: "Beginner", focus: "WiFi fundamentals" },
  { cert: "CWSP", org: "CWNP", description: "Certified Wireless Security Professional - security focus", difficulty: "Intermediate", focus: "Wireless security" },
  { cert: "CWAP", org: "CWNP", description: "Certified Wireless Analysis Professional - protocol analysis", difficulty: "Advanced", focus: "Packet analysis" },
  { cert: "CWNE", org: "CWNP", description: "Certified Wireless Network Expert - highest CWNP level", difficulty: "Expert", focus: "Complete mastery" },
  { cert: "GAWN", org: "GIAC", description: "GIAC Assessing Wireless Networks - enterprise focus", difficulty: "Intermediate", focus: "Enterprise testing" },
];

// Advanced attack scenarios with detailed steps
const advancedAttackScenarios = [
  {
    name: "Corporate WiFi Compromise (Full Kill Chain)",
    difficulty: "Advanced",
    time: "2-4 hours",
    prerequisites: ["Monitor mode adapter", "hostapd-wpe", "Wordlist"],
    steps: [
      { step: 1, action: "Reconnaissance", detail: "Identify corporate SSID, channel, and EAP type using airodump-ng" },
      { step: 2, action: "Setup Evil Twin", detail: "Configure hostapd-wpe with matching SSID and channel" },
      { step: 3, action: "Deauth Clients", detail: "Force clients to disconnect using aireplay-ng -0" },
      { step: 4, action: "Capture Credentials", detail: "Wait for clients to reconnect to rogue AP" },
      { step: 5, action: "Crack MSCHAPv2", detail: "Use asleap or hashcat -m 5500 on captured challenge/response" },
      { step: 6, action: "Access Network", detail: "Connect with recovered credentials" },
      { step: 7, action: "Post-Exploitation", detail: "Enumerate internal network, identify sensitive systems" },
    ],
    detection: "WIDS alerts on SSID spoofing, unusual deauth frames, RADIUS authentication failures",
    mitigation: "Enforce certificate validation, deploy WIPS, use EAP-TLS with client certs",
  },
  {
    name: "WPA2-PSK Network Breach",
    difficulty: "Intermediate",
    time: "30 min - several days",
    prerequisites: ["Monitor mode adapter", "Hashcat + GPU", "Quality wordlist"],
    steps: [
      { step: 1, action: "Target Selection", detail: "Identify target network with airodump-ng, note BSSID/channel" },
      { step: 2, action: "Capture Handshake", detail: "Wait for client connection or deauth to force reconnect" },
      { step: 3, action: "Alternative: PMKID", detail: "Use hcxdumptool to capture PMKID without client" },
      { step: 4, action: "Convert Format", detail: "hcxpcapngtool -o hash.22000 capture.pcapng" },
      { step: 5, action: "GPU Cracking", detail: "hashcat -m 22000 -a 0 hash.22000 rockyou.txt -r best64.rule" },
      { step: 6, action: "Rule-based Attack", detail: "Apply mutation rules for password variations" },
      { step: 7, action: "Connect & Pivot", detail: "Join network with cracked PSK, enumerate hosts" },
    ],
    detection: "Deauth flood detection, unusual probe responses, new MAC addresses after attack",
    mitigation: "Use 20+ char random passphrase, enable WPA3-SAE, rotate PSK regularly",
  },
  {
    name: "IoT Device Exploitation via WiFi",
    difficulty: "Intermediate",
    time: "1-2 hours",
    prerequisites: ["Monitor mode adapter", "Wireshark", "Device-specific tools"],
    steps: [
      { step: 1, action: "Device Discovery", detail: "Identify IoT devices by MAC OUI and probe requests" },
      { step: 2, action: "Traffic Analysis", detail: "Capture and analyze device communication patterns" },
      { step: 3, action: "Protocol Identification", detail: "Identify HTTP, MQTT, CoAP, or proprietary protocols" },
      { step: 4, action: "Credential Sniffing", detail: "Look for cleartext credentials or API keys" },
      { step: 5, action: "Replay Attacks", detail: "Capture and replay commands to control devices" },
      { step: 6, action: "Firmware Analysis", detail: "Extract and analyze device firmware for hardcoded creds" },
      { step: 7, action: "Lateral Movement", detail: "Use compromised IoT device to access main network" },
    ],
    detection: "Unusual traffic patterns from IoT VLAN, anomalous device behavior, new connections",
    mitigation: "Segment IoT on separate VLAN, monitor traffic, update firmware, disable UPnP",
  },
  {
    name: "Captive Portal Credential Harvesting",
    difficulty: "Intermediate",
    time: "30 min - 2 hours",
    prerequisites: ["Monitor mode adapter", "WiFi-Pumpkin or Fluxion", "Social engineering"],
    steps: [
      { step: 1, action: "Clone Target Portal", detail: "Capture or recreate the target network's login page" },
      { step: 2, action: "Setup Rogue AP", detail: "Configure evil twin with captive portal redirect" },
      { step: 3, action: "DNS/DHCP Config", detail: "Redirect all DNS to captive portal server" },
      { step: 4, action: "Deauth Legitimate AP", detail: "Force clients to disconnect and search for networks" },
      { step: 5, action: "Credential Capture", detail: "Log username/password from portal submissions" },
      { step: 6, action: "Verify Credentials", detail: "Test captured creds against real authentication" },
    ],
    detection: "Multiple APs with same SSID, certificate warnings, unusual redirect behavior",
    mitigation: "User awareness training, HTTPS enforcement, certificate validation policies",
  },
];

// SIEM detection queries for wireless attacks
const siemDetectionQueries = {
  splunk: [
    {
      name: "Deauth Flood Detection",
      query: `index=wireless sourcetype=wids
| where frame_type="deauthentication" OR frame_type="disassociation"
| stats count by src_mac, dst_mac, ssid, span=1m
| where count > 10
| table _time, src_mac, dst_mac, ssid, count`,
      description: "Detect excessive deauthentication frames indicating attack",
    },
    {
      name: "Rogue AP Detection",
      query: `index=wireless sourcetype=wids
| dedup bssid
| lookup authorized_aps.csv bssid OUTPUT authorized
| where isnull(authorized) OR authorized="false"
| table _time, ssid, bssid, channel, signal_strength, vendor`,
      description: "Identify unauthorized access points in the environment",
    },
    {
      name: "Evil Twin Detection",
      query: `index=wireless sourcetype=wids
| stats dc(bssid) as unique_bssids, values(bssid) as bssids by ssid
| where unique_bssids > 1
| lookup authorized_aps.csv ssid OUTPUT expected_bssid
| where bssids!=expected_bssid`,
      description: "Detect multiple BSSIDs broadcasting same SSID",
    },
    {
      name: "RADIUS Auth Failures",
      query: `index=network sourcetype=radius
| where result="Access-Reject" OR result="Access-Challenge"
| stats count by user, calling_station_id, nas_ip, span=1h
| where count > 5
| table _time, user, calling_station_id, nas_ip, count`,
      description: "Track failed enterprise WiFi authentication attempts",
    },
  ],
  sentinel: [
    {
      name: "Wireless Anomaly Detection",
      query: `WirelessLogs
| where TimeGenerated > ago(1h)
| where EventType in ("Deauth", "Disassoc", "AuthFailure")
| summarize EventCount = count() by SourceMAC, TargetMAC, SSID, bin(TimeGenerated, 5m)
| where EventCount > 20
| project TimeGenerated, SourceMAC, TargetMAC, SSID, EventCount`,
      description: "Detect wireless attack indicators using KQL",
    },
    {
      name: "New SSID Detection",
      query: `WirelessLogs
| where TimeGenerated > ago(24h)
| where EventType == "BeaconFrame"
| distinct SSID, BSSID
| join kind=leftanti (
    WirelessLogs
    | where TimeGenerated between(ago(30d) .. ago(24h))
    | distinct SSID, BSSID
) on SSID, BSSID
| project SSID, BSSID, FirstSeen = now()`,
      description: "Identify newly appeared wireless networks",
    },
  ],
  elastic: [
    {
      name: "Wireless Attack Pattern",
      query: `{
  "query": {
    "bool": {
      "must": [
        { "range": { "@timestamp": { "gte": "now-1h" }}},
        { "terms": { "event.type": ["deauth", "disassoc", "probe_response"]}}
      ]
    }
  },
  "aggs": {
    "by_source": {
      "terms": { "field": "source.mac" },
      "aggs": {
        "event_count": { "value_count": { "field": "@timestamp" }}
      }
    }
  }
}`,
      description: "Aggregate wireless events by source MAC for anomaly detection",
    },
  ],
};

// Lab exercises with detailed instructions
const labExercises = [
  {
    title: "Lab 1: WEP Cracking Fundamentals",
    level: "Beginner",
    time: "30 minutes",
    objective: "Understand WEP weaknesses by cracking a WEP-protected network",
    setup: "Configure old router with WEP 64-bit key",
    tools: ["aircrack-ng suite", "Monitor mode adapter"],
    steps: [
      "Enable monitor mode: airmon-ng start wlan0",
      "Identify target: airodump-ng wlan0mon",
      "Focus on target: airodump-ng -c [channel] --bssid [BSSID] -w wep_capture wlan0mon",
      "Inject traffic: aireplay-ng -3 -b [BSSID] wlan0mon",
      "Wait for 40,000+ IVs (watch #Data column)",
      "Crack: aircrack-ng wep_capture-01.cap",
      "Key should appear in under 5 minutes",
    ],
    learningOutcome: "Understand why WEP is fundamentally broken and should never be used",
  },
  {
    title: "Lab 2: WPA2 Handshake Capture & Cracking",
    level: "Beginner",
    time: "45 minutes",
    objective: "Capture WPA2 4-way handshake and perform dictionary attack",
    setup: "Configure router with WPA2-PSK using password from rockyou.txt",
    tools: ["aircrack-ng suite", "rockyou.txt wordlist"],
    steps: [
      "Enable monitor mode and scan for targets",
      "Start capture on target channel/BSSID with -w flag",
      "In new terminal, deauth a client: aireplay-ng -0 5 -a [BSSID] -c [CLIENT] wlan0mon",
      "Watch for 'WPA handshake' message in airodump-ng",
      "Crack with dictionary: aircrack-ng -w /usr/share/wordlists/rockyou.txt capture-01.cap",
      "Observe password recovery time",
    ],
    learningOutcome: "Understand importance of strong passwords and handshake-based attacks",
  },
  {
    title: "Lab 3: PMKID Attack (Clientless)",
    level: "Intermediate",
    time: "30 minutes",
    objective: "Extract PMKID from AP without requiring any connected clients",
    setup: "WPA2-PSK router with weak password",
    tools: ["hcxdumptool", "hcxpcapngtool", "hashcat"],
    steps: [
      "Capture PMKID: hcxdumptool -i wlan0mon -o pmkid.pcapng --filterlist_ap=[BSSID] --filtermode=2 --enable_status=1",
      "Wait for PMKID capture (watch output for 'PMKID')",
      "Convert: hcxpcapngtool -o hash.22000 pmkid.pcapng",
      "Verify hash: cat hash.22000 (should start with WPA*02*)",
      "Crack: hashcat -m 22000 hash.22000 rockyou.txt",
      "Compare speed vs full handshake cracking",
    ],
    learningOutcome: "Modern attacks don't require client deauthentication",
  },
  {
    title: "Lab 4: WPS Pixie Dust Attack",
    level: "Intermediate",
    time: "20 minutes",
    objective: "Exploit weak random number generation in WPS implementations",
    setup: "Router with WPS enabled (vulnerable model preferred)",
    tools: ["wash", "reaver", "bully"],
    steps: [
      "Scan for WPS: wash -i wlan0mon",
      "Note targets with 'Lck' column showing 'No'",
      "Try Pixie Dust: reaver -i wlan0mon -b [BSSID] -K 1 -vv",
      "If successful, PIN and PSK appear instantly",
      "If not vulnerable, try standard bruteforce: reaver -i wlan0mon -b [BSSID] -vv",
      "Alternative: bully -b [BSSID] -c [channel] wlan0mon",
    ],
    learningOutcome: "WPS is a major vulnerability even with strong WPA2 passwords",
  },
  {
    title: "Lab 5: Evil Twin with Captive Portal",
    level: "Advanced",
    time: "60 minutes",
    objective: "Create rogue AP with fake portal to capture credentials",
    setup: "Target network for cloning, second wireless adapter",
    tools: ["hostapd", "dnsmasq", "apache/nginx", "iptables"],
    steps: [
      "Create hostapd.conf with target SSID and channel",
      "Configure dnsmasq for DHCP and DNS redirect",
      "Setup web server with cloned login portal",
      "Configure iptables to redirect HTTP traffic",
      "Start evil twin: hostapd hostapd.conf",
      "Deauth clients from legitimate AP",
      "Monitor portal logs for credential submissions",
    ],
    learningOutcome: "Social engineering combined with technical attacks is highly effective",
  },
  {
    title: "Lab 6: Enterprise WiFi Attack (hostapd-wpe)",
    level: "Advanced",
    time: "90 minutes",
    objective: "Capture and crack enterprise WiFi credentials",
    setup: "WPA2-Enterprise network with PEAP/MSCHAPv2",
    tools: ["hostapd-wpe", "asleap", "hashcat"],
    steps: [
      "Identify target enterprise SSID and authentication type",
      "Configure hostapd-wpe.conf with matching parameters",
      "Generate self-signed certificate for RADIUS",
      "Start rogue AP: hostapd-wpe hostapd-wpe.conf",
      "Deauth clients from legitimate AP",
      "Wait for clients to connect and authenticate",
      "Review hostapd-wpe.log for captured credentials",
      "Crack with asleap: asleap -C [challenge] -R [response] -W wordlist.txt",
    ],
    learningOutcome: "Certificate validation is critical for enterprise WiFi security",
  },
];

// Wireless IDS evasion techniques
const widsEvasionTechniques = [
  {
    technique: "Low and Slow Deauth",
    description: "Send deauth frames at intervals below WIDS threshold detection",
    command: "aireplay-ng -0 1 -a BSSID wlan0mon && sleep 30 && repeat",
    effectiveness: "Medium",
    detection: "Cumulative analysis over longer time periods",
  },
  {
    technique: "Channel Hopping",
    description: "Rapidly change channels during attack to avoid single-channel monitoring",
    command: "while true; do iwconfig wlan0mon channel $((RANDOM % 13 + 1)); sleep 0.5; done",
    effectiveness: "Low-Medium",
    detection: "Multi-channel WIDS deployment",
  },
  {
    technique: "MAC Randomization",
    description: "Change source MAC address for each attack frame",
    command: "macchanger -r wlan0mon (before each attack)",
    effectiveness: "Medium",
    detection: "Behavioral analysis, not MAC-based",
  },
  {
    technique: "Power Level Reduction",
    description: "Reduce transmission power to minimize detection range",
    command: "iwconfig wlan0mon txpower 1",
    effectiveness: "Medium",
    detection: "Sensors close to target will still detect",
  },
  {
    technique: "Passive Reconnaissance Only",
    description: "Avoid any active transmission, only passive listening",
    command: "airodump-ng wlan0mon (no injection)",
    effectiveness: "High",
    detection: "Undetectable without physical security",
  },
  {
    technique: "Time-based Attack Windows",
    description: "Attack during off-hours when WIDS alerts less monitored",
    command: "Scheduled tasks outside business hours",
    effectiveness: "Medium",
    detection: "24/7 SOC monitoring, automated alerting",
  },
];

// Real-world case studies
const caseStudies = [
  {
    title: "TJX Companies Data Breach (2007)",
    type: "WEP Exploitation",
    impact: "94 million credit cards compromised, $256M+ in costs",
    attackVector: "Attackers wardrove TJX stores, found WEP-protected WiFi, cracked keys, and pivoted to internal network to install packet sniffers",
    lessons: ["WEP was known broken for years before this attack", "Wireless security directly impacts PCI compliance", "Physical security and wireless security must align"],
    timeline: "2005-2007 (breach), 2007 (discovery)",
  },
  {
    title: "APT Attack via Hotel WiFi",
    type: "Evil Twin / MITM",
    impact: "Corporate espionage, intellectual property theft",
    attackVector: "Attackers set up rogue AP in hotel hosting business conference, captured credentials of executives connecting to 'Hotel_WiFi'",
    lessons: ["Use VPN on untrusted networks", "Verify network authenticity before connecting", "Corporate travel security policies needed"],
    timeline: "Ongoing threat pattern",
  },
  {
    title: "KRACK Attack Disclosure (2017)",
    type: "Protocol Vulnerability",
    impact: "All WPA2 implementations potentially affected",
    attackVector: "Key Reinstallation Attack exploited nonce reuse in 4-way handshake to decrypt traffic and potentially inject packets",
    lessons: ["Even 'secure' protocols can have implementation flaws", "Prompt patching is critical", "Defense in depth (HTTPS, VPN) provides backup protection"],
    timeline: "October 2017 disclosure",
  },
  {
    title: "Dragonblood WPA3 Vulnerabilities (2019)",
    type: "Protocol Vulnerability",
    impact: "New WPA3 standard had implementation flaws",
    attackVector: "Side-channel attacks on SAE handshake allowed password recovery in some implementations",
    lessons: ["New standards need thorough security review", "Implementation matters as much as protocol design", "Transition modes can create downgrade opportunities"],
    timeline: "April 2019 disclosure",
  },
];

// Advanced Bluetooth attack details
const advancedBluetoothAttacks = [
  {
    name: "BLE MITM with GATTacker",
    description: "Intercept and modify BLE communications between device and app",
    steps: [
      "Identify target device: hcitool lescan",
      "Clone device: gattacker -s [MAC]",
      "Start relay: node ws-slave.js && node advertise.js",
      "Victim app connects to rogue device",
      "All GATT operations pass through attacker",
    ],
    tools: ["GATTacker", "Ubertooth", "nRF52 dongle"],
    defense: "BLE bonding, secure pairing, MITM-resistant profiles",
  },
  {
    name: "Bluetooth Classic PIN Cracking",
    description: "Capture and crack Bluetooth pairing exchange",
    steps: [
      "Enable Bluetooth sniffing with Ubertooth",
      "Capture pairing exchange between devices",
      "Extract E1/E3 values from packet capture",
      "Offline brute-force 4-digit PIN (10,000 combinations)",
    ],
    tools: ["Ubertooth One", "Wireshark", "btcrack"],
    defense: "Use SSP (Secure Simple Pairing), longer PINs",
  },
  {
    name: "BLE Tracking and Surveillance",
    description: "Track individuals via BLE advertising packets",
    steps: [
      "Deploy BLE scanners at multiple locations",
      "Capture advertising packets with device addresses",
      "Correlate MAC addresses across locations",
      "Build movement profiles of targets",
    ],
    tools: ["Raspberry Pi + BLE dongle", "Custom scripts"],
    defense: "MAC address randomization (most modern devices)",
  },
];

// Hashcat optimization tips
const hashcatOptimization = [
  { tip: "Use -O flag for optimized kernels", impact: "2-3x speed increase", command: "hashcat -m 22000 -O hash.22000 wordlist.txt" },
  { tip: "Use -w 3 for workload profile", impact: "Maximum GPU utilization", command: "hashcat -m 22000 -w 3 hash.22000 wordlist.txt" },
  { tip: "Apply rules for password mutations", impact: "Much better coverage", command: "hashcat -m 22000 -r best64.rule hash.22000 wordlist.txt" },
  { tip: "Use combinator attacks", impact: "Word1+Word2 combinations", command: "hashcat -m 22000 -a 1 hash.22000 list1.txt list2.txt" },
  { tip: "Mask attacks for known patterns", impact: "Targeted character positions", command: "hashcat -m 22000 -a 3 hash.22000 ?d?d?d?d?d?d?d?d" },
  { tip: "Use prince processor for phrases", impact: "Generate word combinations", command: "pp64 wordlist.txt | hashcat -m 22000 hash.22000" },
  { tip: "Distributed cracking with --brain", impact: "Coordinate multiple systems", command: "hashcat --brain-server on node1, --brain-client on others" },
];

// =============================================================================
// MAIN COMPONENT
// =============================================================================

const WirelessPentestingPage: React.FC = () => {
  const [tabValue, setTabValue] = useState(0);

  const handleTabChange = (_event: React.SyntheticEvent, newValue: number) => {
    setTabValue(newValue);
  };

  const pageContext = `This page covers wireless penetration testing techniques including WiFi security protocols (WEP, WPA, WPA2, WPA3), attack methodologies, deauthentication attacks, evil twin attacks, PMKID capture, WPS vulnerabilities, and wireless security tools like Aircrack-ng and Hashcat.`;

  return (
    <LearnPageLayout pageTitle="Wireless Penetration Testing" pageContext={pageContext}>
    <Box sx={{ p: 3 }}>
      <Box sx={{ mb: 3 }}>
        <Chip
          component={Link}
          to="/learn"
          icon={<ArrowBackIcon />}
          label="Back to Learning Hub"
          clickable
          variant="outlined"
          sx={{ borderRadius: 2 }}
        />
      </Box>
      <Typography variant="h4" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
        <WifiIcon color="primary" />
        Wireless Penetration Testing
      </Typography>
      <Typography variant="body1" color="text.secondary" paragraph>
        Comprehensive guide to assessing wireless network security
      </Typography>

      <Alert severity="warning" sx={{ mb: 3 }}>
        <AlertTitle>Legal & Ethical Notice</AlertTitle>
        Only perform wireless testing on networks you own or have explicit written authorization to test.
        Unauthorized access to wireless networks is illegal in most jurisdictions.
      </Alert>

      <Paper sx={{ mb: 3 }}>
        <Tabs
          value={tabValue}
          onChange={handleTabChange}
          variant="scrollable"
          scrollButtons="auto"
        >
          <Tab icon={<WifiIcon />} label="Overview" />
          <Tab icon={<LockIcon />} label="WiFi Security" />
          <Tab icon={<BugReportIcon />} label="Attack Types" />
          <Tab icon={<BuildIcon />} label="Tools" />
          <Tab icon={<BluetoothIcon />} label="Bluetooth & RF" />
          <Tab icon={<BusinessIcon />} label="Enterprise" />
          <Tab icon={<ShieldIcon />} label="Defense" />
          <Tab icon={<GavelIcon />} label="Methodology" />
          <Tab icon={<TerminalIcon />} label="Labs" />
          <Tab icon={<RadarIcon />} label="SIEM Detection" />
        </Tabs>
      </Paper>

      {/* Tab 0: Overview */}
      <TabPanel value={tabValue} index={0}>
        <Typography variant="h5" gutterBottom>What is Wireless Penetration Testing?</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Simple Explanation</AlertTitle>
          Think of your wireless network like a house with invisible walls. Unlike wired networks where 
          you need physical access, wireless signals travel through air and can be "heard" by anyone 
          within range. Wireless penetration testing is like hiring a security expert to try breaking 
          into your house to find the weak spots - except they're testing your WiFi network.
        </Alert>

        <Typography paragraph>
          <strong>Wireless penetration testing</strong> is the process of evaluating the security of wireless 
          networks by simulating real-world attacks. Unlike traditional network testing where an attacker 
          needs physical access to plug in a cable, wireless networks broadcast signals that anyone with 
          the right equipment can intercept from outside your building - even from a car parked across 
          the street.
        </Typography>

        <Typography paragraph>
          This makes wireless networks particularly vulnerable because:
        </Typography>

        <Grid container spacing={2} sx={{ mb: 3 }}>
          {[
            { icon: <PublicIcon />, title: "No Physical Barrier", desc: "Signals extend beyond walls and fences" },
            { icon: <VisibilityIcon />, title: "Invisible Traffic", desc: "You can't see who's listening to your network" },
            { icon: <DevicesIcon />, title: "Many Devices", desc: "Phones, laptops, IoT all connect wirelessly" },
            { icon: <LockOpenIcon />, title: "Legacy Protocols", desc: "Old devices may use weak encryption" },
          ].map((item) => (
            <Grid item xs={12} sm={6} md={3} key={item.title}>
              <Card sx={{ height: "100%", textAlign: "center" }}>
                <CardContent>
                  <Box sx={{ color: "primary.main", mb: 1 }}>{item.icon}</Box>
                  <Typography variant="subtitle1" fontWeight="bold">{item.title}</Typography>
                  <Typography variant="body2" color="text.secondary">{item.desc}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Why Wireless Security Matters</Typography>
        <Typography paragraph>
          A compromised wireless network can give attackers the same access as if they were sitting 
          at a desk in your office. From there, they can:
        </Typography>

        <List>
          {[
            "Intercept sensitive data (emails, passwords, financial information)",
            "Access internal systems and databases",
            "Launch attacks on other networks using your connection",
            "Install malware on connected devices",
            "Pivot deeper into the corporate network",
          ].map((item, idx) => (
            <ListItem key={idx}>
              <ListItemIcon><WarningIcon color="error" /></ListItemIcon>
              <ListItemText primary={item} />
            </ListItem>
          ))}
        </List>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Wireless Standards Overview</Typography>
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Standard</strong></TableCell>
                <TableCell><strong>Frequency</strong></TableCell>
                <TableCell><strong>Max Speed</strong></TableCell>
                <TableCell><strong>Year</strong></TableCell>
                <TableCell><strong>Status</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {wifiStandards.map((row) => (
                <TableRow key={row.standard}>
                  <TableCell><Chip label={row.standard} size="small" /></TableCell>
                  <TableCell>{row.frequency}</TableCell>
                  <TableCell>{row.maxSpeed}</TableCell>
                  <TableCell>{row.year}</TableCell>
                  <TableCell>
                    <Chip 
                      label={row.status} 
                      size="small" 
                      color={row.status === "Current" ? "success" : row.status === "Common" ? "primary" : "default"} 
                    />
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Key Concepts for Beginners</Typography>
        <Grid container spacing={2}>
          {[
            { term: "SSID", definition: "Network name - what you see when searching for WiFi" },
            { term: "BSSID", definition: "MAC address of the access point (unique identifier)" },
            { term: "Channel", definition: "Frequency slice the network operates on (1-14 for 2.4GHz)" },
            { term: "Beacon Frame", definition: "Broadcast announcing network presence" },
            { term: "Handshake", definition: "Authentication exchange between client and AP" },
            { term: "Monitor Mode", definition: "Wireless adapter mode to capture all nearby traffic" },
            { term: "Packet Injection", definition: "Ability to send custom wireless frames" },
            { term: "Deauthentication", definition: "Frame type that disconnects clients from AP" },
          ].map((item) => (
            <Grid item xs={12} sm={6} md={3} key={item.term}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Typography variant="subtitle2" color="primary" fontWeight="bold">{item.term}</Typography>
                  <Typography variant="body2">{item.definition}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </TabPanel>

      {/* Tab 1: WiFi Security Protocols */}
      <TabPanel value={tabValue} index={1}>
        <Typography variant="h5" gutterBottom>WiFi Security Protocols</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Understanding WiFi Security Evolution</AlertTitle>
          WiFi security has evolved significantly since 1997. Understanding each protocol's weaknesses 
          helps you identify vulnerable networks and select appropriate attack techniques. The key 
          takeaway: <strong>WEP is broken</strong>, <strong>WPA/WPA2-Personal depends on password strength</strong>, 
          and <strong>WPA2/WPA3-Enterprise is the gold standard</strong>.
        </Alert>

        <Typography variant="h6" gutterBottom>Protocol Comparison</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table>
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Protocol</strong></TableCell>
                <TableCell><strong>Year</strong></TableCell>
                <TableCell><strong>Key Length</strong></TableCell>
                <TableCell><strong>Security</strong></TableCell>
                <TableCell><strong>Crack Time</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {securityProtocols.map((row) => (
                <TableRow key={row.protocol}>
                  <TableCell><Chip label={row.protocol} size="small" variant="outlined" /></TableCell>
                  <TableCell>{row.year}</TableCell>
                  <TableCell><Typography variant="body2">{row.keyLength}</Typography></TableCell>
                  <TableCell>
                    <Chip 
                      label={row.security} 
                      size="small" 
                      color={
                        row.security === "Broken" ? "error" : 
                        row.security === "Weak" ? "warning" :
                        row.security === "Moderate" ? "info" : "success"
                      } 
                    />
                  </TableCell>
                  <TableCell><Typography variant="body2" color="text.secondary">{row.crackTime}</Typography></TableCell>
                  <TableCell>{row.description}</TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Typography variant="h6" gutterBottom>Protocol Deep Dives</Typography>
        
        {protocolDetails.map((protocol) => (
          <Accordion key={protocol.name}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1, width: "100%" }}>
                <LockIcon color={protocol.status as "error" | "warning" | "info" | "success"} />
                <Typography fontWeight="bold">{protocol.name}</Typography>
                <Chip label={protocol.year} size="small" sx={{ ml: "auto", mr: 2 }} />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography paragraph>{protocol.summary}</Typography>
              
              <Typography variant="subtitle2" color="error" gutterBottom>Vulnerabilities:</Typography>
              <List dense>
                {protocol.vulnerabilities.map((vuln, idx) => (
                  <ListItem key={idx}>
                    <ListItemIcon><ErrorIcon color="error" fontSize="small" /></ListItemIcon>
                    <ListItemText primary={vuln} />
                  </ListItem>
                ))}
              </List>

              <Typography variant="subtitle2" color="primary" gutterBottom sx={{ mt: 2 }}>Attack Techniques:</Typography>
              <Grid container spacing={1} sx={{ mb: 2 }}>
                {protocol.attacks.map((attack) => (
                  <Grid item xs={12} sm={6} key={attack.name}>
                    <Card variant="outlined" sx={{ p: 1 }}>
                      <Typography variant="subtitle2" fontWeight="bold">{attack.name}</Typography>
                      <Typography variant="body2" color="text.secondary">{attack.desc}</Typography>
                    </Card>
                  </Grid>
                ))}
              </Grid>

              <Typography variant="subtitle2" gutterBottom sx={{ mt: 2 }}>
                <TerminalIcon sx={{ verticalAlign: "middle", mr: 1 }} />
                Example Commands:
              </Typography>
              <CodeBlock title={`${protocol.name} Attack Commands`}>{protocol.commands}</CodeBlock>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Quick Reference: Which Attack for Which Protocol?</Typography>
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Scenario</strong></TableCell>
                <TableCell><strong>Attack</strong></TableCell>
                <TableCell><strong>Time Required</strong></TableCell>
                <TableCell><strong>Success Rate</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {[
                { scenario: "WEP Network", attack: "IV Attack (aircrack-ng)", time: "5-30 minutes", success: "100%" },
                { scenario: "WPA/WPA2 + Weak Password", attack: "Handshake + Dictionary", time: "Minutes to hours", success: "Depends on wordlist" },
                { scenario: "WPA/WPA2 + Strong Password", attack: "PMKID + GPU Cracking", time: "Days to never", success: "Low" },
                { scenario: "WPS Enabled", attack: "Pixie Dust", time: "Seconds", success: "~30% of routers" },
                { scenario: "WPS Enabled (no Pixie)", attack: "PIN Bruteforce", time: "4-10 hours", success: "High if no lockout" },
                { scenario: "WPA2-Enterprise", attack: "Evil Twin + hostapd-wpe", time: "Minutes (if user connects)", success: "Depends on user training" },
                { scenario: "WPA3-Personal", attack: "Dragonblood (if vulnerable)", time: "Hours", success: "Only specific implementations" },
              ].map((row, idx) => (
                <TableRow key={idx}>
                  <TableCell>{row.scenario}</TableCell>
                  <TableCell><Chip label={row.attack} size="small" variant="outlined" /></TableCell>
                  <TableCell>{row.time}</TableCell>
                  <TableCell>{row.success}</TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>
      </TabPanel>

      {/* Tab 2: Attack Types */}
      <TabPanel value={tabValue} index={2}>
        <Typography variant="h5" gutterBottom>Wireless Attack Types</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Attack Categories</AlertTitle>
          Wireless attacks can be categorized by their objective: <strong>reconnaissance</strong> (discovering targets), 
          <strong>access</strong> (cracking keys), <strong>interception</strong> (MITM), or <strong>disruption</strong> (DoS). 
          Most real-world assessments combine multiple attack types in sequence.
        </Alert>

        {attackTypes.map((category) => (
          <Accordion key={category.category} defaultExpanded>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                {category.icon}
                <Typography variant="h6">{category.category}</Typography>
                <Chip label={`${category.attacks.length} attacks`} size="small" sx={{ ml: 2 }} />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography paragraph color="text.secondary">{category.description}</Typography>
              <TableContainer component={Paper} variant="outlined">
                <Table size="small">
                  <TableHead>
                    <TableRow sx={{ bgcolor: "action.hover" }}>
                      <TableCell><strong>Attack</strong></TableCell>
                      <TableCell><strong>Description</strong></TableCell>
                      <TableCell><strong>Difficulty</strong></TableCell>
                      <TableCell><strong>Detectability</strong></TableCell>
                    </TableRow>
                  </TableHead>
                  <TableBody>
                    {category.attacks.map((attack) => (
                      <TableRow key={attack.name}>
                        <TableCell>
                          <Typography variant="subtitle2" fontWeight="bold" color="primary">
                            {attack.name}
                          </Typography>
                        </TableCell>
                        <TableCell>
                          <Typography variant="body2">{attack.description}</Typography>
                        </TableCell>
                        <TableCell>
                          <Chip 
                            label={attack.difficulty} 
                            size="small" 
                            color={attack.difficulty === "Easy" ? "success" : attack.difficulty === "Medium" ? "warning" : "error"}
                          />
                        </TableCell>
                        <TableCell>
                          <Chip 
                            label={attack.detectability} 
                            size="small" 
                            variant="outlined"
                            color={attack.detectability === "Undetectable" ? "success" : attack.detectability === "Low" || attack.detectability === "Very Low" ? "info" : attack.detectability === "Medium" ? "warning" : "error"}
                          />
                        </TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </TableContainer>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Common Attack Chains</Typography>
        <Grid container spacing={2}>
          {[
            {
              name: "WPA2-PSK Cracking",
              steps: ["1. Passive recon (airodump-ng)", "2. Deauth client", "3. Capture handshake", "4. Crack offline (hashcat)"],
              time: "Minutes to days",
            },
            {
              name: "Evil Twin + Credential Capture",
              steps: ["1. Clone target AP", "2. Deauth legitimate clients", "3. Clients connect to evil twin", "4. Capture credentials via portal"],
              time: "Minutes",
            },
            {
              name: "WPS Exploitation",
              steps: ["1. Scan for WPS (wash)", "2. Try Pixie Dust (-K 1)", "3. If fails, bruteforce PIN", "4. Recover PSK from WPS"],
              time: "Seconds to hours",
            },
            {
              name: "Enterprise Credential Theft",
              steps: ["1. Setup hostapd-wpe", "2. Clone corporate SSID", "3. User connects to rogue AP", "4. Capture and crack MSCHAPv2"],
              time: "Depends on user",
            },
          ].map((chain) => (
            <Grid item xs={12} md={6} key={chain.name}>
              <Card variant="outlined">
                <CardContent>
                  <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                    {chain.name}
                  </Typography>
                  <Stepper orientation="vertical" sx={{ mt: 1 }}>
                    {chain.steps.map((step, idx) => (
                      <Step key={idx} active completed={false}>
                        <StepLabel>{step}</StepLabel>
                      </Step>
                    ))}
                  </Stepper>
                  <Chip label={`Est. time: ${chain.time}`} size="small" sx={{ mt: 2 }} />
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Essential Commands Quick Reference</Typography>
        <CodeBlock title="Aircrack-ng Suite Basics">{`# Enable monitor mode
airmon-ng start wlan0

# Scan all networks
airodump-ng wlan0mon

# Target specific network (channel 6)
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon

# Deauthenticate client
aireplay-ng -0 5 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:66 wlan0mon

# Deauthenticate all clients on network
aireplay-ng -0 10 -a AA:BB:CC:DD:EE:FF wlan0mon

# Crack captured handshake
aircrack-ng -w /usr/share/wordlists/rockyou.txt capture-01.cap

# Check for WPS
wash -i wlan0mon

# Pixie Dust attack
reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -K 1 -vv`}</CodeBlock>
      </TabPanel>

      {/* Tab 3: Tools */}
      <TabPanel value={tabValue} index={3}>
        <Typography variant="h5" gutterBottom>Wireless Pentesting Tools</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Critical: Hardware Requirements</AlertTitle>
          <Typography paragraph>
            Most wireless attacks require an adapter that supports <strong>monitor mode</strong> and 
            <strong>packet injection</strong>. Your laptop's built-in WiFi will NOT work for these attacks.
          </Typography>
          <Typography variant="body2">
            <strong>Recommended chipsets:</strong> Atheros AR9271 (2.4GHz only), Ralink RT3070, 
            Realtek RTL8812AU (dual-band), MediaTek MT7612U (best modern option)
          </Typography>
        </Alert>

        {tools.map((category) => (
          <Accordion key={category.category} defaultExpanded>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                <Typography variant="h6">{category.category}</Typography>
                <Chip label={`${category.items.length} items`} size="small" sx={{ ml: 1 }} />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography paragraph color="text.secondary">{category.description}</Typography>
              <Grid container spacing={2}>
                {category.items.map((item) => (
                  <Grid item xs={12} sm={6} md={4} key={item.name}>
                    <Card variant="outlined" sx={{ height: "100%" }}>
                      <CardContent>
                        <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 1 }}>
                          <Typography variant="subtitle1" fontWeight="bold">{item.name}</Typography>
                          <Chip 
                            label={item.type} 
                            size="small" 
                            color={item.type === "Hardware" ? "secondary" : "primary"} 
                          />
                        </Box>
                        <Typography variant="body2" color="text.secondary" paragraph>{item.description}</Typography>
                        {(item as { chipset?: string }).chipset && (
                          <Chip label={(item as { chipset?: string }).chipset} size="small" variant="outlined" sx={{ mr: 1 }} />
                        )}
                        {(item as { bands?: string }).bands && (
                          <Chip label={(item as { bands?: string }).bands} size="small" variant="outlined" sx={{ mr: 1 }} />
                        )}
                        {(item as { platform?: string }).platform && (
                          <Chip label={(item as { platform?: string }).platform} size="small" variant="outlined" />
                        )}
                        {(item as { usage?: string }).usage && (
                          <Typography variant="caption" component="div" sx={{ mt: 1, fontFamily: "monospace", color: "text.secondary" }}>
                            {(item as { usage?: string }).usage}
                          </Typography>
                        )}
                      </CardContent>
                    </Card>
                  </Grid>
                ))}
              </Grid>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Setting Up Your Wireless Lab</Typography>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  <ComputerIcon sx={{ verticalAlign: "middle", mr: 1 }} />
                  Kali Linux Setup
                </Typography>
                <CodeBlock title="Driver Installation">{`# Update system
sudo apt update && sudo apt upgrade

# Install aircrack-ng suite
sudo apt install aircrack-ng

# Install additional tools
sudo apt install hcxdumptool hcxtools reaver bully

# Install hashcat for GPU cracking
sudo apt install hashcat

# Check adapter is recognized
iwconfig
airmon-ng`}</CodeBlock>
              </CardContent>
            </Card>
          </Grid>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  <WifiIcon sx={{ verticalAlign: "middle", mr: 1 }} />
                  Adapter Configuration
                </Typography>
                <CodeBlock title="Monitor Mode Setup">{`# Kill interfering processes
sudo airmon-ng check kill

# Start monitor mode
sudo airmon-ng start wlan0

# Verify monitor mode
iwconfig wlan0mon

# Change channel manually
sudo iwconfig wlan0mon channel 6

# Set TX power (if supported)
sudo iwconfig wlan0mon txpower 30

# Return to managed mode
sudo airmon-ng stop wlan0mon
sudo systemctl restart NetworkManager`}</CodeBlock>
              </CardContent>
            </Card>
          </Grid>
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Wordlists for Password Cracking</Typography>
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Wordlist</strong></TableCell>
                <TableCell><strong>Size</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Location</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {[
                { name: "rockyou.txt", size: "14M lines", desc: "Classic leaked passwords, good starting point", location: "/usr/share/wordlists/" },
                { name: "SecLists", size: "Various", desc: "Comprehensive collection of security lists", location: "github.com/danielmiessler/SecLists" },
                { name: "hashesorg2019", size: "12B+ hashes", desc: "Massive collection for hash lookups", location: "hashes.org (defunct, mirrors exist)" },
                { name: "weakpass.com", size: "Various", desc: "Curated wordlists optimized for WiFi", location: "weakpass.com" },
                { name: "Custom + Rules", size: "N/A", desc: "Generate variations with hashcat rules", location: "hashcat -r rules/best64.rule" },
              ].map((wl) => (
                <TableRow key={wl.name}>
                  <TableCell><Chip label={wl.name} size="small" variant="outlined" /></TableCell>
                  <TableCell>{wl.size}</TableCell>
                  <TableCell>{wl.desc}</TableCell>
                  <TableCell><Typography variant="caption" fontFamily="monospace">{wl.location}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>
      </TabPanel>

      {/* Tab 4: Bluetooth & RF */}
      <TabPanel value={tabValue} index={4}>
        <Typography variant="h5" gutterBottom>Bluetooth & Other RF Protocols</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Beyond WiFi</AlertTitle>
          Wireless pentesting extends beyond 802.11 WiFi to include Bluetooth Classic, Bluetooth Low Energy (BLE), 
          Zigbee, Z-Wave, and other radio frequency protocols. These are increasingly important with the 
          proliferation of IoT devices in homes and enterprises.
        </Alert>

        <Typography variant="h6" gutterBottom>
          <BluetoothIcon sx={{ verticalAlign: "middle", mr: 1 }} />
          Bluetooth Attack Landscape
        </Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Attack</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Severity</strong></TableCell>
                <TableCell><strong>Year</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {bluetoothAttacks.map((attack) => (
                <TableRow key={attack.name}>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold" color="primary">{attack.name}</Typography>
                  </TableCell>
                  <TableCell>{attack.description}</TableCell>
                  <TableCell>
                    <Chip 
                      label={attack.severity} 
                      size="small" 
                      color={attack.severity === "Critical" ? "error" : attack.severity === "High" ? "warning" : attack.severity === "Medium" ? "info" : "default"}
                    />
                  </TableCell>
                  <TableCell>{attack.year}</TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Typography variant="h6" gutterBottom>Bluetooth Testing Tools</Typography>
        <Grid container spacing={2} sx={{ mb: 3 }}>
          {bluetoothTools.map((tool) => (
            <Grid item xs={12} sm={6} md={4} key={tool.name}>
              <Card variant="outlined">
                <CardContent>
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "center", mb: 1 }}>
                    <Typography variant="subtitle1" fontWeight="bold">{tool.name}</Typography>
                    <Chip label={tool.platform} size="small" variant="outlined" />
                  </Box>
                  <Typography variant="body2" color="text.secondary">{tool.description}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Typography variant="h6" gutterBottom>
          <SettingsInputAntennaIcon sx={{ verticalAlign: "middle", mr: 1 }} />
          IoT RF Protocols
        </Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Protocol</strong></TableCell>
                <TableCell><strong>Frequency</strong></TableCell>
                <TableCell><strong>Common Use</strong></TableCell>
                <TableCell><strong>Security</strong></TableCell>
                <TableCell><strong>Known Vulnerabilities</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {rfProtocols.map((row) => (
                <TableRow key={row.protocol}>
                  <TableCell><Chip label={row.protocol} size="small" variant="outlined" /></TableCell>
                  <TableCell>{row.frequency}</TableCell>
                  <TableCell>{row.use}</TableCell>
                  <TableCell>{row.security}</TableCell>
                  <TableCell><Typography variant="body2" color="text.secondary">{row.vulnerabilities}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Software Defined Radio (SDR)</Typography>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  SDR Hardware
                </Typography>
                <List dense>
                  {[
                    { device: "RTL-SDR", price: "$25-35", range: "25-1700 MHz", use: "Receive only, great for learning" },
                    { device: "HackRF One", price: "$300", range: "1-6000 MHz", use: "TX/RX, half-duplex" },
                    { device: "YARD Stick One", price: "$100", range: "Sub-1GHz", use: "Designed for ISM bands" },
                    { device: "Ubertooth One", price: "$120", range: "2.4 GHz", use: "Bluetooth-specific" },
                    { device: "Flipper Zero", price: "$170", range: "Sub-GHz + RFID + NFC", use: "All-in-one pentest device" },
                  ].map((sdr) => (
                    <ListItem key={sdr.device}>
                      <ListItemText 
                        primary={<><strong>{sdr.device}</strong> ({sdr.price})</>}
                        secondary={`${sdr.range} - ${sdr.use}`}
                      />
                    </ListItem>
                  ))}
                </List>
              </CardContent>
            </Card>
          </Grid>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  Common RF Attacks
                </Typography>
                <List dense>
                  {[
                    { attack: "Replay Attack", desc: "Record and retransmit captured signals (garage doors, car fobs)" },
                    { attack: "Jamming", desc: "Overwhelm frequency to cause denial of service" },
                    { attack: "Signal Analysis", desc: "Reverse engineer proprietary protocols" },
                    { attack: "Rolling Code Attack", desc: "Exploit weak PRNG in rolling code systems" },
                    { attack: "RollJam", desc: "Jam + capture to steal rolling codes" },
                  ].map((attack) => (
                    <ListItem key={attack.attack}>
                      <ListItemIcon><WarningIcon color="warning" fontSize="small" /></ListItemIcon>
                      <ListItemText 
                        primary={attack.attack}
                        secondary={attack.desc}
                      />
                    </ListItem>
                  ))}
                </List>
              </CardContent>
            </Card>
          </Grid>
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>BLE Pentesting Commands</Typography>
        <CodeBlock title="Bluetooth Low Energy Enumeration">{`# Scan for BLE devices (hcitool)
sudo hcitool lescan

# Scan with bettercap
sudo bettercap
> ble.recon on
> ble.show

# Connect to device and enumerate services
gatttool -b AA:BB:CC:DD:EE:FF -I
> connect
> primary
> characteristics

# Read a characteristic
> char-read-hnd 0x0003

# Using bluetoothctl
bluetoothctl
> scan on
> info AA:BB:CC:DD:EE:FF
> connect AA:BB:CC:DD:EE:FF`}</CodeBlock>
      </TabPanel>

      {/* Tab 5: Enterprise */}
      <TabPanel value={tabValue} index={5}>
        <Typography variant="h5" gutterBottom>Enterprise Wireless Security</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Enterprise vs Personal WiFi</AlertTitle>
          Enterprise wireless (WPA2/WPA3-Enterprise) uses individual credentials instead of shared passwords. 
          This provides accountability, centralized management, and stronger security - but introduces new 
          attack surfaces around certificates and RADIUS authentication.
        </Alert>

        <Typography variant="h6" gutterBottom>Key Enterprise Components</Typography>
        <Grid container spacing={2} sx={{ mb: 3 }}>
          {enterpriseTopics.map((item) => (
            <Grid item xs={12} sm={6} md={3} key={item.topic}>
              <Card variant="outlined" sx={{ height: "100%", textAlign: "center" }}>
                <CardContent>
                  <Box sx={{ color: "primary.main", mb: 1 }}>{item.icon}</Box>
                  <Typography variant="subtitle1" fontWeight="bold">{item.topic}</Typography>
                  <Typography variant="body2" color="text.secondary">{item.description}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>EAP Authentication Methods</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Method</strong></TableCell>
                <TableCell><strong>Security</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Deployment</strong></TableCell>
                <TableCell><strong>Weakness</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {eapMethods.map((row) => (
                <TableRow key={row.method}>
                  <TableCell><Chip label={row.method} size="small" variant="outlined" /></TableCell>
                  <TableCell>
                    <Chip 
                      label={row.security} 
                      size="small" 
                      color={row.security === "Highest" || row.security === "High" ? "success" : "error"}
                    />
                  </TableCell>
                  <TableCell>{row.description}</TableCell>
                  <TableCell>
                    <Chip 
                      label={row.deployment} 
                      size="small" 
                      variant="outlined"
                      color={row.deployment === "Easy" ? "success" : row.deployment === "Medium" ? "warning" : "error"}
                    />
                  </TableCell>
                  <TableCell><Typography variant="body2" color="text.secondary">{row.vulnerability}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Typography variant="h6" gutterBottom>Enterprise Attack Vectors</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Attack</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Difficulty</strong></TableCell>
                <TableCell><strong>Impact</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {enterpriseAttacks.map((row) => (
                <TableRow key={row.attack}>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold" color="error">{row.attack}</Typography>
                  </TableCell>
                  <TableCell>{row.description}</TableCell>
                  <TableCell>
                    <Chip label={row.difficulty} size="small" color={row.difficulty === "Easy" ? "success" : row.difficulty === "Medium" ? "warning" : "error"} />
                  </TableCell>
                  <TableCell>
                    <Chip label={row.impact} size="small" variant="outlined" color={row.impact === "Critical" ? "error" : row.impact === "High" ? "warning" : "info"} />
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Enterprise Attack: hostapd-wpe</Typography>
        <Typography paragraph>
          The most common enterprise wireless attack uses <strong>hostapd-wpe</strong> (Wireless Pwnage Edition) 
          to create a rogue access point that impersonates the corporate network and captures user credentials.
        </Typography>
        <CodeBlock title="hostapd-wpe Setup">{`# Install hostapd-wpe
sudo apt install hostapd-wpe

# Edit configuration
sudo nano /etc/hostapd-wpe/hostapd-wpe.conf

# Key settings:
# interface=wlan0
# ssid=CorporateWiFi
# channel=6
# eap_user_file=/etc/hostapd-wpe/hostapd-wpe.eap_user

# Start the rogue AP
sudo hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf

# Captured credentials appear in hostapd-wpe.log
# Format: username:NETNTLM_CHALLENGE:NETNTLM_RESPONSE

# Crack MSCHAPv2 with asleap
asleap -C <challenge> -R <response> -W /usr/share/wordlists/rockyou.txt

# Or convert to hashcat format and use GPU
# hashcat -m 5500 hash.txt wordlist.txt`}</CodeBlock>

        <Alert severity="warning" sx={{ mt: 2 }}>
          <AlertTitle>Defense: Certificate Validation</AlertTitle>
          The primary defense against enterprise evil twin attacks is proper certificate validation on 
          client devices. If users are trained to "accept anyway" or devices don't validate the RADIUS 
          server certificate, this attack will succeed.
        </Alert>
      </TabPanel>

      {/* Tab 6: Defense */}
      <TabPanel value={tabValue} index={6}>
        <Typography variant="h5" gutterBottom>Wireless Defense & Hardening</Typography>
        
        <Alert severity="success" sx={{ mb: 3 }}>
          <AlertTitle>Defense in Depth</AlertTitle>
          Effective wireless security requires multiple layers: strong encryption, network segmentation, 
          continuous monitoring, and regular assessments. No single control is sufficient.
        </Alert>

        <Typography variant="h6" gutterBottom>Defense Strategies by Priority</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Priority</strong></TableCell>
                <TableCell><strong>Strategy</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Implementation</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {defenseStrategies.map((row) => (
                <TableRow key={row.strategy}>
                  <TableCell>
                    <Chip 
                      label={row.priority} 
                      size="small" 
                      color={row.priority === "Critical" ? "error" : row.priority === "High" ? "warning" : "info"}
                    />
                  </TableCell>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold">{row.strategy}</Typography>
                  </TableCell>
                  <TableCell>{row.description}</TableCell>
                  <TableCell>
                    <Typography variant="body2" color="text.secondary">{row.implementation}</Typography>
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Implementation Guide</Typography>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">WPA3 Migration</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary=" Audit current AP and client WPA3 support" /></ListItem>
                  <ListItem><ListItemText primary=" Enable WPA3-Transition mode initially" /></ListItem>
                  <ListItem><ListItemText primary=" Test with modern and legacy devices" /></ListItem>
                  <ListItem><ListItemText primary=" Disable WPA2 once all clients support WPA3" /></ListItem>
                  <ListItem><ListItemText primary=" Enable Protected Management Frames (PMF)" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">Network Segmentation</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary=" Create separate VLANs for IoT, Guest, Corporate" /></ListItem>
                  <ListItem><ListItemText primary=" Implement firewall rules between segments" /></ListItem>
                  <ListItem><ListItemText primary=" Use SSIDs mapped to appropriate VLANs" /></ListItem>
                  <ListItem><ListItemText primary=" Monitor inter-VLAN traffic for anomalies" /></ListItem>
                  <ListItem><ListItemText primary=" Isolate client devices from each other" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">Certificate Management</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary=" Deploy certificates via MDM/GPO" /></ListItem>
                  <ListItem><ListItemText primary=" Configure clients to validate server cert" /></ListItem>
                  <ListItem><ListItemText primary=" Use private CA with proper chain" /></ListItem>
                  <ListItem><ListItemText primary=" Set certificate expiration alerts" /></ListItem>
                  <ListItem><ListItemText primary=" Prevent users from bypassing validation" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
          </Grid>
          <Grid item xs={12} md={6}>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">WIDS/WIPS Deployment</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary=" Deploy dedicated sensors or use AP-based" /></ListItem>
                  <ListItem><ListItemText primary=" Configure rogue AP detection thresholds" /></ListItem>
                  <ListItem><ListItemText primary=" Enable deauth attack detection" /></ListItem>
                  <ListItem><ListItemText primary=" Alert on evil twin/SSID spoofing" /></ListItem>
                  <ListItem><ListItemText primary=" Integrate with SIEM for correlation" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">Strong Password Policy</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary=" Minimum 20+ character passphrase for PSK" /></ListItem>
                  <ListItem><ListItemText primary=" Rotate PSK quarterly (or use Enterprise)" /></ListItem>
                  <ListItem><ListItemText primary=" Never reuse passwords across networks" /></ListItem>
                  <ListItem><ListItemText primary=" Avoid dictionary words and patterns" /></ListItem>
                  <ListItem><ListItemText primary=" Consider SAE (WPA3) for forward secrecy" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion>
              <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                <Typography fontWeight="bold">Monitoring & Response</Typography>
              </AccordionSummary>
              <AccordionDetails>
                <List dense>
                  <ListItem><ListItemText primary=" Log all authentication attempts" /></ListItem>
                  <ListItem><ListItemText primary=" Alert on repeated auth failures" /></ListItem>
                  <ListItem><ListItemText primary=" Monitor for new/unexpected SSIDs" /></ListItem>
                  <ListItem><ListItemText primary=" Track unusual data volumes" /></ListItem>
                  <ListItem><ListItemText primary=" Establish IR playbook for wireless incidents" /></ListItem>
                </List>
              </AccordionDetails>
            </Accordion>
          </Grid>
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Best Practices by Environment</Typography>
        <Grid container spacing={2}>
          {[
            { env: "Home Networks", icon: <HomeIcon />, tips: ["Use WPA3 if supported", "Strong unique 20+ char password", "Disable WPS completely", "Regular firmware updates", "Change default admin creds"] },
            { env: "Small Business", icon: <BusinessIcon />, tips: ["Separate guest network (VLAN)", "Consider WPA2/3-Enterprise", "Enable AP client isolation", "Regular security audits", "Strong PSK rotation quarterly"] },
            { env: "Enterprise", icon: <RouterIcon />, tips: ["802.1X with EAP-TLS certificates", "Wireless IDS/IPS deployment", "NAC integration mandatory", "Regular penetration testing", "Zero-trust network architecture"] },
          ].map((item) => (
            <Grid item xs={12} md={4} key={item.env}>
              <Card sx={{ height: "100%" }}>
                <CardContent>
                  <Box sx={{ display: "flex", alignItems: "center", gap: 1, mb: 2 }}>
                    {item.icon}
                    <Typography variant="h6">{item.env}</Typography>
                  </Box>
                  <List dense>
                    {item.tips.map((tip) => (
                      <ListItem key={tip}>
                        <ListItemIcon><ShieldIcon fontSize="small" color="success" /></ListItemIcon>
                        <ListItemText primary={tip} />
                      </ListItem>
                    ))}
                  </List>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Quick Hardening Checklist</Typography>
        <Grid container spacing={2}>
          {[
            { item: "WPA3 or WPA2-Enterprise with AES", status: "Required" },
            { item: "Disable WPS completely", status: "Required" },
            { item: "Change default admin credentials", status: "Required" },
            { item: "Enable client isolation on guest networks", status: "Required" },
            { item: "Implement MAC filtering (layered defense)", status: "Recommended" },
            { item: "Regular firmware updates", status: "Required" },
            { item: "Disable unused management interfaces", status: "Required" },
            { item: "Deploy WIDS/WIPS sensors", status: "Recommended" },
          ].map((check) => (
            <Grid item xs={12} sm={6} md={3} key={check.item}>
              <Card variant="outlined">
                <CardContent sx={{ py: 1, "&:last-child": { pb: 1 } }}>
                  <Chip 
                    label={check.status} 
                    size="small" 
                    color={check.status === "Required" ? "error" : check.status === "Recommended" ? "warning" : "default"}
                    sx={{ mb: 1 }}
                  />
                  <Typography variant="body2">{check.item}</Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </TabPanel>

      {/* Tab 7: Methodology */}
      <TabPanel value={tabValue} index={7}>
        <Typography variant="h5" gutterBottom>Wireless Pentest Methodology</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Professional Wireless Assessments</AlertTitle>
          A structured methodology ensures comprehensive coverage, reproducible results, and professional 
          deliverables. Each phase builds on the previous, creating a thorough assessment of wireless security posture.
        </Alert>

        <Typography variant="h6" gutterBottom>Testing Phases</Typography>
        <Stepper orientation="vertical" sx={{ mb: 3 }}>
          {[
            { 
              phase: "1. Planning & Scoping", 
              tasks: ["Define scope and rules of engagement", "Identify target networks and physical locations", "Obtain written authorization and legal review", "Prepare equipment and verify functionality", "Establish communication channels with client"],
              time: "1-2 days",
              output: "Scope document, authorization letter"
            },
            { 
              phase: "2. Reconnaissance", 
              tasks: ["Passive scanning from multiple locations", "Identify SSIDs, BSSIDs, channels, vendors", "Map network topology and coverage areas", "Identify security protocols in use", "Note client devices and traffic patterns"],
              time: "1-2 days",
              output: "Network inventory, coverage map"
            },
            { 
              phase: "3. Vulnerability Analysis", 
              tasks: ["Identify weak protocols (WEP, WPS enabled)", "Check for misconfigurations and default settings", "Assess encryption strength and implementation", "Identify rogue/unauthorized APs", "Review enterprise auth configuration"],
              time: "1-2 days",
              output: "Vulnerability list, risk assessment"
            },
            { 
              phase: "4. Exploitation", 
              tasks: ["Attempt authorized attacks per scope", "Capture and crack handshakes", "Test evil twin scenarios (if authorized)", "Verify vulnerabilities are exploitable", "Document proof of concept for each finding"],
              time: "2-4 days",
              output: "Attack logs, screenshots, captures"
            },
            { 
              phase: "5. Post-Exploitation", 
              tasks: ["Assess network access gained", "Identify pivot points and lateral movement", "Document access level achieved", "Test client-side attacks if in scope", "Assess data exposure risk"],
              time: "1-2 days",
              output: "Access documentation, risk analysis"
            },
            { 
              phase: "6. Reporting", 
              tasks: ["Document all findings with evidence", "Assign risk ratings (CVSS or custom)", "Provide specific remediation steps", "Create executive summary for management", "Conduct findings walkthrough with client"],
              time: "2-3 days",
              output: "Final report, executive summary"
            },
          ].map((item, idx) => (
            <Step key={item.phase} active completed={false}>
              <StepLabel>
                <Typography variant="subtitle1" fontWeight="bold">{item.phase}</Typography>
              </StepLabel>
              <StepContent>
                <Box sx={{ pl: 2 }}>
                  <List dense>
                    {item.tasks.map((task) => (
                      <ListItem key={task} sx={{ py: 0 }}>
                        <ListItemIcon sx={{ minWidth: 24 }}><SpeedIcon fontSize="small" /></ListItemIcon>
                        <ListItemText primary={task} />
                      </ListItem>
                    ))}
                  </List>
                  <Box sx={{ display: "flex", gap: 2, mt: 1 }}>
                    <Chip label={`Time: ${item.time}`} size="small" variant="outlined" />
                    <Chip label={`Output: ${item.output}`} size="small" color="primary" variant="outlined" />
                  </Box>
                </Box>
              </StepContent>
            </Step>
          ))}
        </Stepper>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Certifications & Training</Typography>
        <TableContainer component={Paper} sx={{ mb: 3 }}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Certification</strong></TableCell>
                <TableCell><strong>Organization</strong></TableCell>
                <TableCell><strong>Focus</strong></TableCell>
                <TableCell><strong>Difficulty</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {certifications.map((row) => (
                <TableRow key={row.cert}>
                  <TableCell><Chip label={row.cert} size="small" color="primary" /></TableCell>
                  <TableCell>{row.org}</TableCell>
                  <TableCell><Chip label={row.focus} size="small" variant="outlined" /></TableCell>
                  <TableCell>
                    <Chip 
                      label={row.difficulty} 
                      size="small" 
                      color={row.difficulty === "Entry" ? "success" : row.difficulty === "Intermediate" ? "warning" : "error"}
                    />
                  </TableCell>
                  <TableCell>{row.description}</TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Legal Considerations</Typography>
        <Alert severity="error" sx={{ mb: 3 }}>
          <AlertTitle> Critical: Always Get Written Authorization</AlertTitle>
          <Typography paragraph>
            Wireless penetration testing without explicit authorization is a criminal offense in most jurisdictions. 
            Even with good intentions, you could face serious legal consequences.
          </Typography>
        </Alert>
        
        <Grid container spacing={2} sx={{ mb: 3 }}>
          {[
            { 
              title: "Computer Fraud Laws", 
              icon: <WarningIcon color="error" />,
              items: ["CFAA (US), Computer Misuse Act (UK)", "Unauthorized access is a federal crime", "Can include civil and criminal penalties", "Intent doesn't matter - access is the crime"]
            },
            { 
              title: "FCC Regulations (US)", 
              icon: <WarningIcon color="error" />,
              items: ["Intentional interference is illegal", "Deauth attacks may violate Part 15", "Jamming is a federal offense", "Heavy fines and equipment seizure possible"]
            },
            { 
              title: "Authorization Requirements", 
              icon: <CheckCircleIcon color="success" />,
              items: ["Get written scope document", "Specify allowed attack types", "Define physical boundaries", "Include indemnification clause"]
            },
            { 
              title: "Signal Boundaries", 
              icon: <WarningIcon color="warning" />,
              items: ["Wireless signals don't respect walls", "May affect neighboring businesses", "Consider off-hours testing", "Document signal reach limitations"]
            },
          ].map((section) => (
            <Grid item xs={12} sm={6} md={3} key={section.title}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Box sx={{ display: "flex", alignItems: "center", gap: 1, mb: 1 }}>
                    {section.icon}
                    <Typography variant="subtitle2" fontWeight="bold">{section.title}</Typography>
                  </Box>
                  <List dense>
                    {section.items.map((item) => (
                      <ListItem key={item} sx={{ py: 0 }}>
                        <ListItemText primary={<Typography variant="body2"> {item}</Typography>} />
                      </ListItem>
                    ))}
                  </List>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Building a Practice Lab</Typography>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  Minimum Lab Setup
                </Typography>
                <List dense>
                  {[
                    { item: "Old router (WEP/WPA capable)", purpose: "Target for cracking exercises" },
                    { item: "Monitor mode adapter", purpose: "Atheros AR9271 or similar ($15-25)" },
                    { item: "Kali Linux VM or bare metal", purpose: "Attack platform with tools pre-installed" },
                    { item: "Spare laptop/phone as client", purpose: "Generate traffic and test client attacks" },
                    { item: "Faraday bag (optional)", purpose: "Contain signals to prevent interference" },
                  ].map((item) => (
                    <ListItem key={item.item}>
                      <ListItemText 
                        primary={<strong>{item.item}</strong>}
                        secondary={item.purpose}
                      />
                    </ListItem>
                  ))}
                </List>
              </CardContent>
            </Card>
          </Grid>
          <Grid item xs={12} md={6}>
            <Card variant="outlined">
              <CardContent>
                <Typography variant="subtitle1" fontWeight="bold" color="primary" gutterBottom>
                  Practice Resources
                </Typography>
                <List dense>
                  {[
                    { resource: "WiFi Pineapple", desc: "Hardware lab platform with training mode" },
                    { resource: "Hack The Box", desc: "Some machines have wireless components" },
                    { resource: "PentesterLab", desc: "Web-based exercises including wireless" },
                    { resource: "WiFi Challenge Labs", desc: "Dedicated wireless CTF-style challenges" },
                    { resource: "Your own home network", desc: "Legal to test your own equipment" },
                  ].map((item) => (
                    <ListItem key={item.resource}>
                      <ListItemText 
                        primary={<strong>{item.resource}</strong>}
                        secondary={item.desc}
                      />
                    </ListItem>
                  ))}
                </List>
              </CardContent>
            </Card>
          </Grid>
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Report Template Sections</Typography>
        <Grid container spacing={2}>
          {[
            { section: "Executive Summary", items: ["High-level findings for management", "Business risk assessment", "Key recommendations prioritized"] },
            { section: "Scope & Methodology", items: ["Networks tested and locations", "Attack types performed", "Tools and techniques used"] },
            { section: "Findings Detail", items: ["Vulnerability description", "Proof of concept with screenshots", "CVSS or risk rating", "Specific remediation steps"] },
            { section: "Appendices", items: ["Full scan results", "Captured handshakes (sanitized)", "Timeline of testing", "Tool output logs"] },
          ].map((item) => (
            <Grid item xs={12} sm={6} md={3} key={item.section}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Typography variant="subtitle2" fontWeight="bold" color="primary" gutterBottom>
                    {item.section}
                  </Typography>
                  <List dense>
                    {item.items.map((i) => (
                      <ListItem key={i} sx={{ py: 0 }}>
                        <ListItemText primary={<Typography variant="body2"> {i}</Typography>} />
                      </ListItem>
                    ))}
                  </List>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </TabPanel>

      {/* Tab 8: Labs */}
      <TabPanel value={tabValue} index={8}>
        <Typography variant="h5" gutterBottom>Hands-On Lab Exercises</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Practice Makes Perfect</AlertTitle>
          These labs are designed for your own equipment or authorized test environments. 
          <strong> Never practice on networks you don't own or have explicit permission to test.</strong>
        </Alert>

        <Grid container spacing={2} sx={{ mb: 4 }}>
          {labExercises.map((lab, idx) => (
            <Grid item xs={12} md={6} key={lab.title}>
              <Accordion>
                <AccordionSummary expandIcon={<ExpandMoreIcon />}>
                  <Box sx={{ display: "flex", alignItems: "center", gap: 1, width: "100%" }}>
                    <Chip label={`Lab ${idx + 1}`} size="small" color="primary" />
                    <Typography fontWeight="bold" sx={{ flex: 1 }}>{lab.title}</Typography>
                    <Chip 
                      label={lab.level} 
                      size="small" 
                      color={lab.level === "Beginner" ? "success" : lab.level === "Intermediate" ? "warning" : "error"} 
                      sx={{ mr: 1 }}
                    />
                    <Chip label={lab.time} size="small" variant="outlined" />
                  </Box>
                </AccordionSummary>
                <AccordionDetails>
                  <Typography variant="body2" color="text.secondary" paragraph>
                    <strong>Objective:</strong> {lab.objective}
                  </Typography>
                  <Typography variant="body2" color="text.secondary" paragraph>
                    <strong>Setup:</strong> {lab.setup}
                  </Typography>
                  <Typography variant="subtitle2" gutterBottom>Required Tools:</Typography>
                  <Box sx={{ display: "flex", gap: 0.5, flexWrap: "wrap", mb: 2 }}>
                    {lab.tools.map(tool => (
                      <Chip key={tool} label={tool} size="small" variant="outlined" />
                    ))}
                  </Box>
                  <Typography variant="subtitle2" gutterBottom>Steps:</Typography>
                  <List dense>
                    {lab.steps.map((step, i) => (
                      <ListItem key={i}>
                        <ListItemIcon><Chip label={i + 1} size="small" /></ListItemIcon>
                        <ListItemText 
                          primary={<Typography variant="body2" sx={{ fontFamily: step.includes("airmon") || step.includes("aireplay") || step.includes("hashcat") ? "monospace" : "inherit" }}>{step}</Typography>} 
                        />
                      </ListItem>
                    ))}
                  </List>
                  <Alert severity="success" sx={{ mt: 2 }}>
                    <strong>Learning Outcome:</strong> {lab.learningOutcome}
                  </Alert>
                </AccordionDetails>
              </Accordion>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Advanced Attack Scenarios</Typography>
        <Typography paragraph color="text.secondary">
          These multi-step attack chains demonstrate real-world wireless penetration testing workflows.
        </Typography>

        {advancedAttackScenarios.map((scenario) => (
          <Accordion key={scenario.name}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1, width: "100%" }}>
                <BugReportIcon color="error" />
                <Typography fontWeight="bold" sx={{ flex: 1 }}>{scenario.name}</Typography>
                <Chip label={scenario.difficulty} size="small" color={scenario.difficulty === "Intermediate" ? "warning" : "error"} sx={{ mr: 1 }} />
                <Chip label={scenario.time} size="small" variant="outlined" />
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" color="text.secondary" paragraph>
                <strong>Prerequisites:</strong> {scenario.prerequisites.join(", ")}
              </Typography>
              
              <Typography variant="subtitle2" gutterBottom>Attack Chain:</Typography>
              <Stepper orientation="vertical" sx={{ mb: 2 }}>
                {scenario.steps.map((step) => (
                  <Step key={step.step} active completed={false}>
                    <StepLabel>
                      <Typography fontWeight="bold">{step.action}</Typography>
                    </StepLabel>
                    <StepContent>
                      <Typography variant="body2" color="text.secondary">{step.detail}</Typography>
                    </StepContent>
                  </Step>
                ))}
              </Stepper>

              <Grid container spacing={2}>
                <Grid item xs={12} md={6}>
                  <Alert severity="warning">
                    <strong>Detection:</strong> {scenario.detection}
                  </Alert>
                </Grid>
                <Grid item xs={12} md={6}>
                  <Alert severity="success">
                    <strong>Mitigation:</strong> {scenario.mitigation}
                  </Alert>
                </Grid>
              </Grid>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>WIDS/WIPS Evasion Techniques</Typography>
        <Alert severity="warning" sx={{ mb: 2 }}>
          Understanding evasion helps both attackers (for testing) and defenders (for improving detection).
        </Alert>
        
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Technique</strong></TableCell>
                <TableCell><strong>Description</strong></TableCell>
                <TableCell><strong>Effectiveness</strong></TableCell>
                <TableCell><strong>Counter-Detection</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {widsEvasionTechniques.map((tech) => (
                <TableRow key={tech.technique}>
                  <TableCell>
                    <Typography variant="subtitle2" fontWeight="bold" color="primary">{tech.technique}</Typography>
                  </TableCell>
                  <TableCell>
                    <Typography variant="body2">{tech.description}</Typography>
                    <Typography variant="caption" sx={{ fontFamily: "monospace", display: "block", mt: 0.5, color: "text.secondary" }}>{tech.command}</Typography>
                  </TableCell>
                  <TableCell>
                    <Chip 
                      label={tech.effectiveness} 
                      size="small" 
                      color={tech.effectiveness === "High" ? "error" : tech.effectiveness === "Medium" ? "warning" : "info"} 
                    />
                  </TableCell>
                  <TableCell><Typography variant="body2" color="text.secondary">{tech.detection}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Hashcat Optimization for WiFi Cracking</Typography>
        <TableContainer component={Paper}>
          <Table size="small">
            <TableHead>
              <TableRow sx={{ bgcolor: "action.hover" }}>
                <TableCell><strong>Optimization</strong></TableCell>
                <TableCell><strong>Impact</strong></TableCell>
                <TableCell><strong>Command Example</strong></TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {hashcatOptimization.map((opt) => (
                <TableRow key={opt.tip}>
                  <TableCell><Typography variant="subtitle2" fontWeight="bold">{opt.tip}</Typography></TableCell>
                  <TableCell><Chip label={opt.impact} size="small" color="success" variant="outlined" /></TableCell>
                  <TableCell><Typography variant="body2" sx={{ fontFamily: "monospace", fontSize: "0.75rem" }}>{opt.command}</Typography></TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </TableContainer>
      </TabPanel>

      {/* Tab 9: SIEM Detection */}
      <TabPanel value={tabValue} index={9}>
        <Typography variant="h5" gutterBottom>SIEM Detection Queries</Typography>
        
        <Alert severity="info" sx={{ mb: 3 }}>
          <AlertTitle>Blue Team Perspective</AlertTitle>
          These queries help defenders detect wireless attacks. Understanding detection helps pentesters 
          know what to avoid, and helps blue teams improve their monitoring.
        </Alert>

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1 }}>
          <StorageIcon /> Splunk Queries
        </Typography>
        {siemDetectionQueries.splunk.map((query) => (
          <Accordion key={query.name} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Typography fontWeight="bold">{query.name}</Typography>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" color="text.secondary" paragraph>{query.description}</Typography>
              <CodeBlock title="Splunk Query">{query.query}</CodeBlock>
            </AccordionDetails>
          </Accordion>
        ))}

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1, mt: 3 }}>
          <StorageIcon /> Microsoft Sentinel (KQL)
        </Typography>
        {siemDetectionQueries.sentinel.map((query) => (
          <Accordion key={query.name} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Typography fontWeight="bold">{query.name}</Typography>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" color="text.secondary" paragraph>{query.description}</Typography>
              <CodeBlock title="KQL Query">{query.query}</CodeBlock>
            </AccordionDetails>
          </Accordion>
        ))}

        <Typography variant="h6" gutterBottom sx={{ display: "flex", alignItems: "center", gap: 1, mt: 3 }}>
          <StorageIcon /> Elastic Security
        </Typography>
        {siemDetectionQueries.elastic.map((query) => (
          <Accordion key={query.name} sx={{ mb: 1 }}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Typography fontWeight="bold">{query.name}</Typography>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" color="text.secondary" paragraph>{query.description}</Typography>
              <CodeBlock title="Elastic DSL">{query.query}</CodeBlock>
            </AccordionDetails>
          </Accordion>
        ))}

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Real-World Case Studies</Typography>
        <Grid container spacing={2}>
          {caseStudies.map((study) => (
            <Grid item xs={12} md={6} key={study.title}>
              <Card variant="outlined" sx={{ height: "100%" }}>
                <CardContent>
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 1 }}>
                    <Typography variant="subtitle1" fontWeight="bold" color="primary">{study.title}</Typography>
                    <Chip label={study.type} size="small" color="error" />
                  </Box>
                  <Typography variant="body2" color="error" paragraph>
                    <strong>Impact:</strong> {study.impact}
                  </Typography>
                  <Typography variant="body2" paragraph>
                    <strong>Attack Vector:</strong> {study.attackVector}
                  </Typography>
                  <Typography variant="subtitle2" gutterBottom>Key Lessons:</Typography>
                  <List dense>
                    {study.lessons.map((lesson) => (
                      <ListItem key={lesson} sx={{ py: 0 }}>
                        <ListItemIcon><CheckCircleIcon fontSize="small" color="success" /></ListItemIcon>
                        <ListItemText primary={<Typography variant="body2">{lesson}</Typography>} />
                      </ListItem>
                    ))}
                  </List>
                  <Typography variant="caption" color="text.secondary">
                    Timeline: {study.timeline}
                  </Typography>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>

        <Divider sx={{ my: 3 }} />

        <Typography variant="h6" gutterBottom>Advanced Bluetooth Attacks (Detailed)</Typography>
        {advancedBluetoothAttacks.map((attack) => (
          <Accordion key={attack.name}>
            <AccordionSummary expandIcon={<ExpandMoreIcon />}>
              <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                <BluetoothIcon color="primary" />
                <Typography fontWeight="bold">{attack.name}</Typography>
              </Box>
            </AccordionSummary>
            <AccordionDetails>
              <Typography variant="body2" paragraph>{attack.description}</Typography>
              <Typography variant="subtitle2" gutterBottom>Attack Steps:</Typography>
              <List dense>
                {attack.steps.map((step, i) => (
                  <ListItem key={i}>
                    <ListItemIcon><Chip label={i + 1} size="small" /></ListItemIcon>
                    <ListItemText primary={step} />
                  </ListItem>
                ))}
              </List>
              <Box sx={{ display: "flex", gap: 1, flexWrap: "wrap", my: 2 }}>
                <Typography variant="subtitle2">Tools:</Typography>
                {attack.tools.map(tool => (
                  <Chip key={tool} label={tool} size="small" variant="outlined" />
                ))}
              </Box>
              <Alert severity="success">
                <strong>Defense:</strong> {attack.defense}
              </Alert>
            </AccordionDetails>
          </Accordion>
        ))}
      </TabPanel>
    </Box>
    </LearnPageLayout>
  );
};

export default WirelessPentestingPage;
